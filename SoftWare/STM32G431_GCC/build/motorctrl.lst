ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"motorctrl.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.sg_debug_clear,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	sg_debug_clear:
  26              	.LFB334:
  27              		.file 1 "../BLDCMotor/motorctrl.c"
   1:../BLDCMotor/motorctrl.c **** #include "./motorctrl.h"
   2:../BLDCMotor/motorctrl.c **** #include "debuglog.h"
   3:../BLDCMotor/motorctrl.c **** #include "motorctrl_common.h"
   4:../BLDCMotor/motorctrl.c **** 
   5:../BLDCMotor/motorctrl.c **** #include "board.h"
   6:../BLDCMotor/motorctrl.c **** 
   7:../BLDCMotor/motorctrl.c **** 
   8:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
   9:../BLDCMotor/motorctrl.c **** #endif
  10:../BLDCMotor/motorctrl.c **** #define Q15_PI_2                   (51471)
  11:../BLDCMotor/motorctrl.c **** #define Q15_2PI                    (205884)
  12:../BLDCMotor/motorctrl.c **** #define PI_2                       (1.570796f)
  13:../BLDCMotor/motorctrl.c **** #define MOTORCTRL_PERCI            (1)
  14:../BLDCMotor/motorctrl.c **** 
  15:../BLDCMotor/motorctrl.c **** enum{
  16:../BLDCMotor/motorctrl.c ****     MOTOR_INIT,
  17:../BLDCMotor/motorctrl.c ****     MOTOR_IDLE,
  18:../BLDCMotor/motorctrl.c ****     MOTOR_START, 
  19:../BLDCMotor/motorctrl.c ****     MOTOR_RUNING,
  20:../BLDCMotor/motorctrl.c ****     MOTOR_STOP,
  21:../BLDCMotor/motorctrl.c **** };
  22:../BLDCMotor/motorctrl.c **** 
  23:../BLDCMotor/motorctrl.c **** motordebug_t sg_motordebug = {0};
  24:../BLDCMotor/motorctrl.c **** typedef struct
  25:../BLDCMotor/motorctrl.c **** {
  26:../BLDCMotor/motorctrl.c ****     unsigned char state;
  27:../BLDCMotor/motorctrl.c ****     unsigned short cnt;
  28:../BLDCMotor/motorctrl.c **** }motorctrl_t;
  29:../BLDCMotor/motorctrl.c **** 
  30:../BLDCMotor/motorctrl.c **** static dq_t _currmentloop(abc_t i_abc,float ele_theta);
  31:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 2


  32:../BLDCMotor/motorctrl.c **** static void motor_enable(void);
  33:../BLDCMotor/motorctrl.c **** static void motor_disable(void);
  34:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp);
  35:../BLDCMotor/motorctrl.c **** static void sg_debug_clear(void)
  36:../BLDCMotor/motorctrl.c **** {
  28              		.loc 1 36 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  37:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_targe =0.0f;
  33              		.loc 1 37 5 view .LVU1
  34              		.loc 1 37 28 is_stmt 0 view .LVU2
  35 0000 024B     		ldr	r3, .L2
  36 0002 0022     		movs	r2, #0
  37 0004 5A64     		str	r2, [r3, #68]	@ float
  38:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_targe =0.0f;
  38              		.loc 1 38 5 is_stmt 1 view .LVU3
  39              		.loc 1 38 28 is_stmt 0 view .LVU4
  40 0006 9A64     		str	r2, [r3, #72]	@ float
  39:../BLDCMotor/motorctrl.c **** }
  41              		.loc 1 39 1 view .LVU5
  42 0008 7047     		bx	lr
  43              	.L3:
  44 000a 00BF     		.align	2
  45              	.L2:
  46 000c 00000000 		.word	.LANCHOR0
  47              		.cfi_endproc
  48              	.LFE334:
  50              		.section	.text.motor_enable_noirq,"ax",%progbits
  51              		.align	1
  52              		.syntax unified
  53              		.thumb
  54              		.thumb_func
  56              	motor_enable_noirq:
  57              	.LFB373:
  40:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab);
  41:../BLDCMotor/motorctrl.c **** motorctrl_t g_Motor1 = {
  42:../BLDCMotor/motorctrl.c ****     .state = MOTOR_INIT,
  43:../BLDCMotor/motorctrl.c ****     .cnt = 0,
  44:../BLDCMotor/motorctrl.c **** };
  45:../BLDCMotor/motorctrl.c **** static volatile float sg_MecThetaOffset = 0.0f;
  46:../BLDCMotor/motorctrl.c **** static lowfilter_t sg_elefilter[3];
  47:../BLDCMotor/motorctrl.c **** pid_cb_t test_d_pid = {0};
  48:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_d_pid;
  49:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_q_pid;
  50:../BLDCMotor/motorctrl.c **** static curloop_t sg_curloop_param;
  51:../BLDCMotor/motorctrl.c **** float pre_angle_test = 0.0f;
  52:../BLDCMotor/motorctrl.c **** float next_angle_test = 0.0f;
  53:../BLDCMotor/motorctrl.c **** float raw_angle = 0.0f;
  54:../BLDCMotor/motorctrl.c **** float test_ia = 0.0f;
  55:../BLDCMotor/motorctrl.c **** float test_ib = 0.0f;
  56:../BLDCMotor/motorctrl.c **** float test_ic = 0.0f;
  57:../BLDCMotor/motorctrl.c **** void motortctrl_process(void)
  58:../BLDCMotor/motorctrl.c **** {
  59:../BLDCMotor/motorctrl.c ****     char rec_buf[64];
  60:../BLDCMotor/motorctrl.c ****     char cnt = 0;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 3


  61:../BLDCMotor/motorctrl.c ****     // if (readline_fromPC(rec_buf,sizeof(rec_buf)))
  62:../BLDCMotor/motorctrl.c ****     // {
  63:../BLDCMotor/motorctrl.c ****     //     motorprotocol_pause(rec_buf);
  64:../BLDCMotor/motorctrl.c ****     // }
  65:../BLDCMotor/motorctrl.c ****     motorprotocol_process();
  66:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
  67:../BLDCMotor/motorctrl.c ****     {
  68:../BLDCMotor/motorctrl.c ****     case MOTOR_INIT:
  69:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
  70:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
  71:../BLDCMotor/motorctrl.c ****         foc_paraminit();
  72:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
  73:../BLDCMotor/motorctrl.c ****         motor_enable();
  74:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
  75:../BLDCMotor/motorctrl.c ****         break;
  76:../BLDCMotor/motorctrl.c **** 
  77:../BLDCMotor/motorctrl.c ****     case MOTOR_RUNING:
  78:../BLDCMotor/motorctrl.c ****         {
  79:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
  80:../BLDCMotor/motorctrl.c ****             {
  81:../BLDCMotor/motorctrl.c ****                 // g_Motor1.state = MOTOR_STOP;
  82:../BLDCMotor/motorctrl.c ****             }
  83:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 1)
  84:../BLDCMotor/motorctrl.c ****             {
  85:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_STOP;
  86:../BLDCMotor/motorctrl.c ****             }
  87:../BLDCMotor/motorctrl.c ****         }
  88:../BLDCMotor/motorctrl.c ****         break;
  89:../BLDCMotor/motorctrl.c **** 
  90:../BLDCMotor/motorctrl.c ****     case MOTOR_STOP:
  91:../BLDCMotor/motorctrl.c ****         motor_disable();
  92:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_IDLE;
  93:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
  94:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 3)
  95:../BLDCMotor/motorctrl.c ****             {
  96:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_INIT;
  97:../BLDCMotor/motorctrl.c ****             }        
  98:../BLDCMotor/motorctrl.c ****         break;
  99:../BLDCMotor/motorctrl.c ****     
 100:../BLDCMotor/motorctrl.c ****     default:
 101:../BLDCMotor/motorctrl.c ****         break;
 102:../BLDCMotor/motorctrl.c ****     }
 103:../BLDCMotor/motorctrl.c **** }
 104:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 105:../BLDCMotor/motorctrl.c **** unsigned int test_angletime = 0;
 106:../BLDCMotor/motorctrl.c **** float per_eleangle = 0.0f;
 107:../BLDCMotor/motorctrl.c **** void _50uscycle_process(unsigned int *abc_vale,float _elec_theta)
 108:../BLDCMotor/motorctrl.c **** {
 109:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 110:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;    
 111:../BLDCMotor/motorctrl.c ****     duty_t dut01,dut02;
 112:../BLDCMotor/motorctrl.c **** /*----------------‰∏âÁõ∏ÁîµÊµÅÂ§ÑÁêÜ------------------------------*/    
 113:../BLDCMotor/motorctrl.c ****     float Ia,Ib,Ic;
 114:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 115:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 116:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 117:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 4


 118:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 119:../BLDCMotor/motorctrl.c **** 
 120:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)A_VOLITETOCURRENT_FACTOR;
 121:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 122:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 123:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 124:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 125:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 126:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 127:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 128:../BLDCMotor/motorctrl.c **** 
 129:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 130:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ22toF(Q15_Mechtheta);
 131:../BLDCMotor/motorctrl.c ****     raw_angle = mech_theta;
 132:../BLDCMotor/motorctrl.c ****     mech_theta = (mech_theta + 0.0f);//0.12f);//sg_MecThetaOffset);
 133:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 134:../BLDCMotor/motorctrl.c ****     elec_theta += ANGLE_COMPENSATA;
 135:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 136:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 137:../BLDCMotor/motorctrl.c ****     #if 1
 138:../BLDCMotor/motorctrl.c ****         #if 0
 139:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 140:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 141:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta > 6.28f)
 142:../BLDCMotor/motorctrl.c ****             {
 143:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta = 0.0f;
 144:../BLDCMotor/motorctrl.c ****             }
 145:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 146:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 147:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 148:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 149:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.001f;                
 150:../BLDCMotor/motorctrl.c ****         #else
 151:../BLDCMotor/motorctrl.c ****         static unsigned short cnt = 0;
 152:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 153:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 154:../BLDCMotor/motorctrl.c **** 
 155:../BLDCMotor/motorctrl.c ****                         
 156:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta < 0.0f)
 157:../BLDCMotor/motorctrl.c ****             {
 158:../BLDCMotor/motorctrl.c ****                 cnt++;
 159:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 160:../BLDCMotor/motorctrl.c ****             }
 161:../BLDCMotor/motorctrl.c ****             if (cnt > MOTOR_PAIR*2)
 162:../BLDCMotor/motorctrl.c ****             {
 163:../BLDCMotor/motorctrl.c ****                 return;
 164:../BLDCMotor/motorctrl.c ****             }
 165:../BLDCMotor/motorctrl.c **** 
 166:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 167:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 168:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 169:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 170:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.001f;               
 171:../BLDCMotor/motorctrl.c ****         #endif 
 172:../BLDCMotor/motorctrl.c ****     #else
 173:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 174:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 5


 175:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 176:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta - PI/2.0F);
 177:../BLDCMotor/motorctrl.c ****         #else
 178:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta - PI/2.0F);
 179:../BLDCMotor/motorctrl.c ****         #endif
 180:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 181:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 182:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 183:../BLDCMotor/motorctrl.c ****     #endif
 184:../BLDCMotor/motorctrl.c **** 
 185:../BLDCMotor/motorctrl.c **** #endif
 186:../BLDCMotor/motorctrl.c **** 
 187:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 188:../BLDCMotor/motorctrl.c **** 
 189:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 190:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ22toF(Q15_Mechtheta);
 191:../BLDCMotor/motorctrl.c ****     raw_angle = mech_theta;
 192:../BLDCMotor/motorctrl.c ****     mech_theta = (mech_theta - sg_MecThetaOffset);
 193:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 194:../BLDCMotor/motorctrl.c ****     elec_theta += ANGLE_COMPENSATA;
 195:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 196:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 197:../BLDCMotor/motorctrl.c **** 
 198:../BLDCMotor/motorctrl.c ****     #if 0//Âº∫Êãñ       
 199:../BLDCMotor/motorctrl.c ****         #if 1
 200:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 201:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 202:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta > 6.28f)
 203:../BLDCMotor/motorctrl.c ****             {
 204:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta = 0.0f;
 205:../BLDCMotor/motorctrl.c ****             }
 206:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 207:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 208:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 209:../BLDCMotor/motorctrl.c ****             // motor_set_pwm(dut01);//ÊöÇÊó∂Â±èËîΩ ÁîµÊú∫‰∏çËΩ¨Âä®
 210:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.001f;                
 211:../BLDCMotor/motorctrl.c ****         #else
 212:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 213:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 214:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta < 0.0f)
 215:../BLDCMotor/motorctrl.c ****             {
 216:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 217:../BLDCMotor/motorctrl.c ****             }
 218:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 219:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 220:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 221:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 222:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.001f;               
 223:../BLDCMotor/motorctrl.c ****         #endif
 224:../BLDCMotor/motorctrl.c ****     #else //‰ΩøÁî®‰º†ÊÑüÂô®
 225:../BLDCMotor/motorctrl.c ****     {
 226:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,0.1f,_IQ15(0.0f),_IQ15(0.8f)};
 227:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 228:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 229:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta - PI/2.0F);
 230:../BLDCMotor/motorctrl.c ****         #endif
 231:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 6


 232:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 233:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 234:../BLDCMotor/motorctrl.c ****     }
 235:../BLDCMotor/motorctrl.c ****     #endif
 236:../BLDCMotor/motorctrl.c **** #endif
 237:../BLDCMotor/motorctrl.c **** 
 238:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 239:../BLDCMotor/motorctrl.c **** 
 240:../BLDCMotor/motorctrl.c ****   unsigned int nCycleUsed = 0;
 241:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
 242:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 243:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 244:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 245:../BLDCMotor/motorctrl.c ****     mech_theta += ANGLE_COMPENSATA;
 246:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 247:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 248:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 249:../BLDCMotor/motorctrl.c ****   }
 250:../BLDCMotor/motorctrl.c ****   test_angletime = nCycleUsed/170;
 251:../BLDCMotor/motorctrl.c **** 
 252:../BLDCMotor/motorctrl.c ****     #if 0//Âº∫Êãñ
 253:../BLDCMotor/motorctrl.c ****         {            
 254:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta);
 255:../BLDCMotor/motorctrl.c ****             #if 1 //Ê≠£ËΩ¨
 256:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.0f)};
 257:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 258:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta >= _2PI)
 259:../BLDCMotor/motorctrl.c ****             {
 260:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta -= _2PI;
 261:../BLDCMotor/motorctrl.c ****             }
 262:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 263:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta); 
 264:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 265:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 266:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.0031415926f;
 267:../BLDCMotor/motorctrl.c ****             #else //ÂèçËΩ¨
 268:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-1.0f,_IQ15(0.0f),_IQ15(0.0f)};
 269:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 270:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 271:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta <= 0.0f)
 272:../BLDCMotor/motorctrl.c ****             {
 273:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 274:../BLDCMotor/motorctrl.c ****             }
 275:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta); 
 276:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 277:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 278:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.0031415926f;
 279:../BLDCMotor/motorctrl.c ****             #endif
 280:../BLDCMotor/motorctrl.c ****         }
 281:../BLDCMotor/motorctrl.c ****     #else //‰ΩøÁî®‰º†ÊÑüÂô®
 282:../BLDCMotor/motorctrl.c ****     {
 283:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 284:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 285:../BLDCMotor/motorctrl.c ****         #if 1/*Èó≠ÁéØÊéßÂà∂*/
 286:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta);
 287:../BLDCMotor/motorctrl.c ****         #else
 288:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta - PI_2);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 7


 289:../BLDCMotor/motorctrl.c ****             udq.d = sg_motordebug.id_targe;
 290:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 291:../BLDCMotor/motorctrl.c ****         #endif
 292:../BLDCMotor/motorctrl.c ****         // elec_theta = _normalize_angle(elec_theta);
 293:../BLDCMotor/motorctrl.c ****         // uab = _2r_2s(udq, elec_theta);
 294:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, per_eleangle);
 295:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 296:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 297:../BLDCMotor/motorctrl.c ****         per_eleangle = elec_theta;
 298:../BLDCMotor/motorctrl.c ****     }
 299:../BLDCMotor/motorctrl.c ****     #endif
 300:../BLDCMotor/motorctrl.c **** #endif
 301:../BLDCMotor/motorctrl.c ****     return;
 302:../BLDCMotor/motorctrl.c **** }
 303:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab) {  
 304:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 305:../BLDCMotor/motorctrl.c ****     float voltage_magnitude = sqrt(raw_uab.alpha * raw_uab.alpha + raw_uab.beta * raw_uab.beta); //
 306:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 307:../BLDCMotor/motorctrl.c ****     if (voltage_magnitude > max_voltage) {  
 308:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 309:../BLDCMotor/motorctrl.c ****         float scale_factor = max_voltage / voltage_magnitude;  
 310:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 311:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 312:../BLDCMotor/motorctrl.c ****     } else {  
 313:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Âú®ÂÖÅËÆ∏ËåÉÂõ¥ÂÜÖÔºåÂàô‰∏çËøõË°å‰ªª‰ΩïÊîπÂèò  
 314:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha;  
 315:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 316:../BLDCMotor/motorctrl.c ****     }
 317:../BLDCMotor/motorctrl.c ****     return uab;
 318:../BLDCMotor/motorctrl.c **** }
 319:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 320:../BLDCMotor/motorctrl.c **** dq_t _currmentloop(abc_t i_abc,float ele_theta)
 321:../BLDCMotor/motorctrl.c **** {
 322:../BLDCMotor/motorctrl.c **** #if 1
 323:../BLDCMotor/motorctrl.c ****     alpbet_t i_alphbeta;
 324:../BLDCMotor/motorctrl.c ****     float _tempa,_tempb,_tempc;
 325:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 326:../BLDCMotor/motorctrl.c ****     _tempa = i_abc.a;
 327:../BLDCMotor/motorctrl.c ****     _tempb = i_abc.b;
 328:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 329:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 330:../BLDCMotor/motorctrl.c ****     /*bac*/
 331:../BLDCMotor/motorctrl.c ****     i_abc.a = _tempb;
 332:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempa;
 333:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempc;
 334:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 335:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 336:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 337:../BLDCMotor/motorctrl.c **** 
 338:../BLDCMotor/motorctrl.c ****     // cos(ele_theta)
 339:../BLDCMotor/motorctrl.c ****     // cosf(ele_theta - _2PI/3.0f)*
 340:../BLDCMotor/motorctrl.c **** #endif
 341:../BLDCMotor/motorctrl.c **** 
 342:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 343:../BLDCMotor/motorctrl.c ****     i_abc.a = _tempa;
 344:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempb;
 345:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempc;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 8


 346:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 347:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 348:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 349:../BLDCMotor/motorctrl.c **** #endif
 350:../BLDCMotor/motorctrl.c **** 
 351:../BLDCMotor/motorctrl.c ****     _3s_2s(i_abc,&i_alphbeta);   
 352:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 353:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 354:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 355:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 356:../BLDCMotor/motorctrl.c **** #if 1
 357:../BLDCMotor/motorctrl.c ****     float tar_id = 0.0f,tar_iq = 0.0f;
 358:../BLDCMotor/motorctrl.c ****     tar_id = sg_motordebug.id_targe;
 359:../BLDCMotor/motorctrl.c ****     tar_iq = sg_motordebug.iq_targe;
 360:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 361:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 362:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 363:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 364:../BLDCMotor/motorctrl.c **** #endif
 365:../BLDCMotor/motorctrl.c ****     return udq;
 366:../BLDCMotor/motorctrl.c **** #endif
 367:../BLDCMotor/motorctrl.c **** }
 368:../BLDCMotor/motorctrl.c **** 
 369:../BLDCMotor/motorctrl.c **** static void motor_enable(void)
 370:../BLDCMotor/motorctrl.c **** {
 371:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 372:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 373:../BLDCMotor/motorctrl.c **** #endif
 374:../BLDCMotor/motorctrl.c ****     /*pwm ‰ΩøËÉΩ*/
 375:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
 376:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
 377:../BLDCMotor/motorctrl.c ****     adc_start();
 378:../BLDCMotor/motorctrl.c **** }
 379:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 380:../BLDCMotor/motorctrl.c **** {
  58              		.loc 1 380 1 is_stmt 1 view -0
  59              		.cfi_startproc
  60              		@ args = 0, pretend = 0, frame = 0
  61              		@ frame_needed = 0, uses_anonymous_args = 0
  62 0000 08B5     		push	{r3, lr}
  63              	.LCFI0:
  64              		.cfi_def_cfa_offset 8
  65              		.cfi_offset 3, -8
  66              		.cfi_offset 14, -4
 381:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 382:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 383:../BLDCMotor/motorctrl.c **** #endif
 384:../BLDCMotor/motorctrl.c ****     /*pwm ‰ΩøËÉΩ*/
 385:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
  67              		.loc 1 385 5 view .LVU7
  68 0002 FFF7FEFF 		bl	tim_pwm_enable
  69              	.LVL0:
 386:../BLDCMotor/motorctrl.c **** }
  70              		.loc 1 386 1 is_stmt 0 view .LVU8
  71 0006 08BD     		pop	{r3, pc}
  72              		.cfi_endproc
  73              	.LFE373:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 9


  75              		.section	.text.motor_set_pwm,"ax",%progbits
  76              		.align	1
  77              		.syntax unified
  78              		.thumb
  79              		.thumb_func
  81              	motor_set_pwm:
  82              	.LFB375:
 387:../BLDCMotor/motorctrl.c **** static void motor_disable(void)
 388:../BLDCMotor/motorctrl.c **** {
 389:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 390:../BLDCMotor/motorctrl.c ****     gpio_setmotor_powerdown();
 391:../BLDCMotor/motorctrl.c **** #endif    
 392:../BLDCMotor/motorctrl.c ****     tim_pwm_disable();
 393:../BLDCMotor/motorctrl.c ****     adc_stop();
 394:../BLDCMotor/motorctrl.c **** }
 395:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 396:../BLDCMotor/motorctrl.c **** {
  83              		.loc 1 396 1 is_stmt 1 view -0
  84              		.cfi_startproc
  85              		@ args = 0, pretend = 0, frame = 16
  86              		@ frame_needed = 0, uses_anonymous_args = 0
  87 0000 00B5     		push	{lr}
  88              	.LCFI1:
  89              		.cfi_def_cfa_offset 4
  90              		.cfi_offset 14, -4
  91 0002 85B0     		sub	sp, sp, #20
  92              	.LCFI2:
  93              		.cfi_def_cfa_offset 24
  94 0004 8DED010A 		vstr.32	s0, [sp, #4]
  95 0008 CDED020A 		vstr.32	s1, [sp, #8]
  96 000c 8DED031A 		vstr.32	s2, [sp, #12]
 397:../BLDCMotor/motorctrl.c ****     tim_set_pwm(temp._a,temp._b,temp._c);
  97              		.loc 1 397 5 view .LVU10
  98 0010 FFF7FEFF 		bl	tim_set_pwm
  99              	.LVL1:
 398:../BLDCMotor/motorctrl.c **** }
 100              		.loc 1 398 1 is_stmt 0 view .LVU11
 101 0014 05B0     		add	sp, sp, #20
 102              	.LCFI3:
 103              		.cfi_def_cfa_offset 4
 104              		@ sp needed
 105 0016 5DF804FB 		ldr	pc, [sp], #4
 106              		.cfi_endproc
 107              	.LFE375:
 109              		.section	.text._get_angleoffset,"ax",%progbits
 110              		.align	1
 111              		.syntax unified
 112              		.thumb
 113              		.thumb_func
 115              	_get_angleoffset:
 116              	.LFB376:
 399:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void)
 400:../BLDCMotor/motorctrl.c **** {
 117              		.loc 1 400 1 is_stmt 1 view -0
 118              		.cfi_startproc
 119              		@ args = 0, pretend = 0, frame = 48
 120              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 10


 121 0000 30B5     		push	{r4, r5, lr}
 122              	.LCFI4:
 123              		.cfi_def_cfa_offset 12
 124              		.cfi_offset 4, -12
 125              		.cfi_offset 5, -8
 126              		.cfi_offset 14, -4
 127 0002 8FB0     		sub	sp, sp, #60
 128              	.LCFI5:
 129              		.cfi_def_cfa_offset 72
 401:../BLDCMotor/motorctrl.c ****     motor_enable_noirq();
 130              		.loc 1 401 5 view .LVU13
 131 0004 FFF7FEFF 		bl	motor_enable_noirq
 132              	.LVL2:
 402:../BLDCMotor/motorctrl.c ****     /*-----------ËÆæÁΩÆalpha/betaÂùêÊ†áÁ≥ª------------------*/
 403:../BLDCMotor/motorctrl.c ****     alpbet_t uab = {1.0f,0.0f};
 133              		.loc 1 403 5 view .LVU14
 134              		.loc 1 403 14 is_stmt 0 view .LVU15
 135 0008 0025     		movs	r5, #0
 136 000a 0A95     		str	r5, [sp, #40]
 137 000c 0B95     		str	r5, [sp, #44]
 138 000e 0C95     		str	r5, [sp, #48]
 139 0010 0D95     		str	r5, [sp, #52]
 140 0012 4FF07E52 		mov	r2, #1065353216
 141 0016 0A92     		str	r2, [sp, #40]	@ float
 404:../BLDCMotor/motorctrl.c ****     duty_t dut01;
 142              		.loc 1 404 5 is_stmt 1 view .LVU16
 405:../BLDCMotor/motorctrl.c ****     float theta;
 143              		.loc 1 405 5 view .LVU17
 406:../BLDCMotor/motorctrl.c **** 
 407:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32H723 
 408:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 409:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 410:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 411:../BLDCMotor/motorctrl.c ****         tim_encode_writecnt(0);
 412:../BLDCMotor/motorctrl.c ****         theta = 0.0f;
 413:../BLDCMotor/motorctrl.c ****         // motor_disable();
 414:../BLDCMotor/motorctrl.c ****         return theta;
 415:../BLDCMotor/motorctrl.c ****     #endif
 416:../BLDCMotor/motorctrl.c **** 
 417:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32G4_MCB
 418:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 419:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 420:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 421:../BLDCMotor/motorctrl.c ****         tim_encode_writecnt(4095);
 422:../BLDCMotor/motorctrl.c ****         theta = 0.0f;
 423:../BLDCMotor/motorctrl.c ****         motor_disable();
 424:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 425:../BLDCMotor/motorctrl.c ****         return theta;
 426:../BLDCMotor/motorctrl.c ****     #endif
 427:../BLDCMotor/motorctrl.c **** 
 428:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32G431
 429:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f};
 144              		.loc 1 429 9 view .LVU18
 145              		.loc 1 429 14 is_stmt 0 view .LVU19
 146 0018 03AB     		add	r3, sp, #12
 147 001a 0395     		str	r5, [sp, #12]
 148 001c 0495     		str	r5, [sp, #16]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 11


 149 001e 0595     		str	r5, [sp, #20]
 150 0020 0695     		str	r5, [sp, #24]
 151 0022 0492     		str	r2, [sp, #16]	@ float
 430:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq,-PI_2);
 152              		.loc 1 430 9 is_stmt 1 view .LVU20
 153              		.loc 1 430 15 is_stmt 0 view .LVU21
 154 0024 0095     		str	r5, [sp]
 155 0026 0ECB     		ldm	r3, {r1, r2, r3}
 156 0028 9FED180A 		vldr.32	s0, .L12
 157 002c 0AA8     		add	r0, sp, #40
 158 002e FFF7FEFF 		bl	_2r_2s
 159              	.LVL3:
 431:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 160              		.loc 1 431 9 is_stmt 1 view .LVU22
 161              		.loc 1 431 17 is_stmt 0 view .LVU23
 162 0032 DDED0B0A 		vldr.32	s1, [sp, #44]
 163 0036 9DED0A0A 		vldr.32	s0, [sp, #40]
 164 003a FFF7FEFF 		bl	_svpwm
 165              	.LVL4:
 166 003e 8DED070A 		vstr.32	s0, [sp, #28]
 167 0042 CDED080A 		vstr.32	s1, [sp, #32]
 168 0046 8DED091A 		vstr.32	s2, [sp, #36]
 432:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 169              		.loc 1 432 9 is_stmt 1 view .LVU24
 170 004a FFF7FEFF 		bl	motor_set_pwm
 171              	.LVL5:
 433:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 172              		.loc 1 433 9 view .LVU25
 173 004e 4FF4FA70 		mov	r0, #500
 174 0052 FFF7FEFF 		bl	HAL_Delay
 175              	.LVL6:
 434:../BLDCMotor/motorctrl.c ****         // motor_disable();
 435:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 176              		.loc 1 435 9 view .LVU26
 177 0056 4FF4FA70 		mov	r0, #500
 178 005a FFF7FEFF 		bl	HAL_Delay
 179              	.LVL7:
 436:../BLDCMotor/motorctrl.c ****         int32_t Q15_theta;
 180              		.loc 1 436 9 view .LVU27
 437:../BLDCMotor/motorctrl.c ****         int32_t Q_thetaSum = 0;
 181              		.loc 1 437 9 view .LVU28
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 182              		.loc 1 438 9 view .LVU29
 183              	.LBB2:
 184              		.loc 1 438 14 view .LVU30
 185              		.loc 1 438 22 is_stmt 0 view .LVU31
 186 005e 2C46     		mov	r4, r5
 187              		.loc 1 438 9 view .LVU32
 188 0060 07E0     		b	.L9
 189              	.LVL8:
 190              	.L10:
 439:../BLDCMotor/motorctrl.c ****         {
 440:../BLDCMotor/motorctrl.c ****             Q_thetaSum += ((int32_t*)(sensor_user_read(SENSOR_01,EN_SENSORDATA_COV)))[0];
 191              		.loc 1 440 13 is_stmt 1 discriminator 3 view .LVU33
 192              		.loc 1 440 39 is_stmt 0 discriminator 3 view .LVU34
 193 0062 0121     		movs	r1, #1
 194 0064 0020     		movs	r0, #0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 12


 195 0066 FFF7FEFF 		bl	sensor_user_read
 196              	.LVL9:
 197              		.loc 1 440 86 discriminator 3 view .LVU35
 198 006a 0368     		ldr	r3, [r0]
 199              		.loc 1 440 24 discriminator 3 view .LVU36
 200 006c 1D44     		add	r5, r5, r3
 201              	.LVL10:
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 202              		.loc 1 438 37 is_stmt 1 discriminator 3 view .LVU37
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 203              		.loc 1 438 38 is_stmt 0 discriminator 3 view .LVU38
 204 006e 0134     		adds	r4, r4, #1
 205              	.LVL11:
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 206              		.loc 1 438 38 discriminator 3 view .LVU39
 207 0070 E4B2     		uxtb	r4, r4
 208              	.LVL12:
 209              	.L9:
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 210              		.loc 1 438 29 is_stmt 1 discriminator 1 view .LVU40
 438:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 211              		.loc 1 438 9 is_stmt 0 discriminator 1 view .LVU41
 212 0072 092C     		cmp	r4, #9
 213 0074 F5D9     		bls	.L10
 214              	.LBE2:
 441:../BLDCMotor/motorctrl.c ****         }
 442:../BLDCMotor/motorctrl.c ****         Q15_theta = Q_thetaSum/10;        
 215              		.loc 1 442 9 is_stmt 1 view .LVU42
 216              		.loc 1 442 19 is_stmt 0 view .LVU43
 217 0076 0648     		ldr	r0, .L12+4
 218 0078 80FB0530 		smull	r3, r0, r0, r5
 219 007c ED17     		asrs	r5, r5, #31
 220              	.LVL13:
 443:../BLDCMotor/motorctrl.c ****         theta = _IQ20toF(Q15_theta);
 221              		.loc 1 443 9 is_stmt 1 view .LVU44
 222              		.loc 1 443 17 is_stmt 0 view .LVU45
 223 007e C5EBA000 		rsb	r0, r5, r0, asr #2
 224              	.LVL14:
 225              		.loc 1 443 17 view .LVU46
 226 0082 FFF7FEFF 		bl	_IQ20toF
 227              	.LVL15:
 444:../BLDCMotor/motorctrl.c ****         return theta;
 228              		.loc 1 444 9 is_stmt 1 view .LVU47
 445:../BLDCMotor/motorctrl.c ****     #endif
 446:../BLDCMotor/motorctrl.c **** }
 229              		.loc 1 446 1 is_stmt 0 view .LVU48
 230 0086 0FB0     		add	sp, sp, #60
 231              	.LCFI6:
 232              		.cfi_def_cfa_offset 12
 233              		@ sp needed
 234 0088 30BD     		pop	{r4, r5, pc}
 235              	.LVL16:
 236              	.L13:
 237              		.loc 1 446 1 view .LVU49
 238 008a 00BF     		.align	2
 239              	.L12:
 240 008c D80FC9BF 		.word	-1077342248
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 13


 241 0090 67666666 		.word	1717986919
 242              		.cfi_endproc
 243              	.LFE376:
 245              		.section	.text.motor_enable,"ax",%progbits
 246              		.align	1
 247              		.syntax unified
 248              		.thumb
 249              		.thumb_func
 251              	motor_enable:
 252              	.LFB372:
 370:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 253              		.loc 1 370 1 is_stmt 1 view -0
 254              		.cfi_startproc
 255              		@ args = 0, pretend = 0, frame = 0
 256              		@ frame_needed = 0, uses_anonymous_args = 0
 257 0000 08B5     		push	{r3, lr}
 258              	.LCFI7:
 259              		.cfi_def_cfa_offset 8
 260              		.cfi_offset 3, -8
 261              		.cfi_offset 14, -4
 375:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
 262              		.loc 1 375 5 view .LVU51
 263 0002 FFF7FEFF 		bl	tim_pwm_enable
 264              	.LVL17:
 376:../BLDCMotor/motorctrl.c ****     adc_start();
 265              		.loc 1 376 5 view .LVU52
 266 0006 FFF7FEFF 		bl	tim_tigger_adc
 267              	.LVL18:
 377:../BLDCMotor/motorctrl.c **** }
 268              		.loc 1 377 5 view .LVU53
 269 000a FFF7FEFF 		bl	adc_start
 270              	.LVL19:
 378:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 271              		.loc 1 378 1 is_stmt 0 view .LVU54
 272 000e 08BD     		pop	{r3, pc}
 273              		.cfi_endproc
 274              	.LFE372:
 276              		.section	.text.motor_disable,"ax",%progbits
 277              		.align	1
 278              		.syntax unified
 279              		.thumb
 280              		.thumb_func
 282              	motor_disable:
 283              	.LFB374:
 388:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 284              		.loc 1 388 1 is_stmt 1 view -0
 285              		.cfi_startproc
 286              		@ args = 0, pretend = 0, frame = 0
 287              		@ frame_needed = 0, uses_anonymous_args = 0
 288 0000 08B5     		push	{r3, lr}
 289              	.LCFI8:
 290              		.cfi_def_cfa_offset 8
 291              		.cfi_offset 3, -8
 292              		.cfi_offset 14, -4
 392:../BLDCMotor/motorctrl.c ****     adc_stop();
 293              		.loc 1 392 5 view .LVU56
 294 0002 FFF7FEFF 		bl	tim_pwm_disable
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 14


 295              	.LVL20:
 393:../BLDCMotor/motorctrl.c **** }
 296              		.loc 1 393 5 view .LVU57
 297 0006 FFF7FEFF 		bl	adc_stop
 298              	.LVL21:
 394:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 299              		.loc 1 394 1 is_stmt 0 view .LVU58
 300 000a 08BD     		pop	{r3, pc}
 301              		.cfi_endproc
 302              	.LFE374:
 304              		.section	.text._currmentloop,"ax",%progbits
 305              		.align	1
 306              		.syntax unified
 307              		.thumb
 308              		.thumb_func
 310              	_currmentloop:
 311              	.LVL22:
 312              	.LFB371:
 321:../BLDCMotor/motorctrl.c **** #if 1
 313              		.loc 1 321 1 is_stmt 1 view -0
 314              		.cfi_startproc
 315              		@ args = 28, pretend = 16, frame = 32
 316              		@ frame_needed = 0, uses_anonymous_args = 0
 321:../BLDCMotor/motorctrl.c **** #if 1
 317              		.loc 1 321 1 is_stmt 0 view .LVU60
 318 0000 84B0     		sub	sp, sp, #16
 319              	.LCFI9:
 320              		.cfi_def_cfa_offset 16
 321 0002 70B5     		push	{r4, r5, r6, lr}
 322              	.LCFI10:
 323              		.cfi_def_cfa_offset 32
 324              		.cfi_offset 4, -32
 325              		.cfi_offset 5, -28
 326              		.cfi_offset 6, -24
 327              		.cfi_offset 14, -20
 328 0004 2DED028B 		vpush.64	{d8}
 329              	.LCFI11:
 330              		.cfi_def_cfa_offset 40
 331              		.cfi_offset 80, -40
 332              		.cfi_offset 81, -36
 333 0008 8CB0     		sub	sp, sp, #48
 334              	.LCFI12:
 335              		.cfi_def_cfa_offset 88
 336 000a 0446     		mov	r4, r0
 337 000c 0DF14C0C 		add	ip, sp, #76
 338 0010 8CE80E00 		stm	ip, {r1, r2, r3}
 339 0014 B0EE408A 		vmov.f32	s16, s0
 323:../BLDCMotor/motorctrl.c ****     float _tempa,_tempb,_tempc;
 340              		.loc 1 323 5 is_stmt 1 view .LVU61
 324:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 341              		.loc 1 324 5 view .LVU62
 325:../BLDCMotor/motorctrl.c ****     _tempa = i_abc.a;
 342              		.loc 1 325 5 view .LVU63
 326:../BLDCMotor/motorctrl.c ****     _tempb = i_abc.b;
 343              		.loc 1 326 5 view .LVU64
 326:../BLDCMotor/motorctrl.c ****     _tempb = i_abc.b;
 344              		.loc 1 326 12 is_stmt 0 view .LVU65
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 15


 345 0018 139B     		ldr	r3, [sp, #76]	@ float
 346              	.LVL23:
 327:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 347              		.loc 1 327 5 is_stmt 1 view .LVU66
 327:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 348              		.loc 1 327 12 is_stmt 0 view .LVU67
 349 001a 149A     		ldr	r2, [sp, #80]	@ float
 350              	.LVL24:
 328:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 351              		.loc 1 328 5 is_stmt 1 view .LVU68
 331:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempa;
 352              		.loc 1 331 5 view .LVU69
 331:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempa;
 353              		.loc 1 331 13 is_stmt 0 view .LVU70
 354 001c 1392     		str	r2, [sp, #76]	@ float
 332:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempc;
 355              		.loc 1 332 5 is_stmt 1 view .LVU71
 332:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempc;
 356              		.loc 1 332 13 is_stmt 0 view .LVU72
 357 001e 1493     		str	r3, [sp, #80]	@ float
 333:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 358              		.loc 1 333 5 is_stmt 1 view .LVU73
 334:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 359              		.loc 1 334 5 view .LVU74
 334:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 360              		.loc 1 334 22 is_stmt 0 view .LVU75
 361 0020 214D     		ldr	r5, .L20
 362 0022 6A60     		str	r2, [r5, #4]	@ float
 335:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 363              		.loc 1 335 5 is_stmt 1 view .LVU76
 335:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 364              		.loc 1 335 22 is_stmt 0 view .LVU77
 365 0024 AB60     		str	r3, [r5, #8]	@ float
 336:../BLDCMotor/motorctrl.c **** 
 366              		.loc 1 336 5 is_stmt 1 view .LVU78
 336:../BLDCMotor/motorctrl.c **** 
 367              		.loc 1 336 22 is_stmt 0 view .LVU79
 368 0026 159B     		ldr	r3, [sp, #84]	@ float
 369              	.LVL25:
 336:../BLDCMotor/motorctrl.c **** 
 370              		.loc 1 336 22 view .LVU80
 371 0028 EB60     		str	r3, [r5, #12]	@ float
 351:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 372              		.loc 1 351 5 is_stmt 1 view .LVU81
 373 002a 08AE     		add	r6, sp, #32
 374 002c 0296     		str	r6, [sp, #8]
 375 002e 17AB     		add	r3, sp, #92
 376 0030 93E80300 		ldm	r3, {r0, r1}
 377              	.LVL26:
 351:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 378              		.loc 1 351 5 is_stmt 0 view .LVU82
 379 0034 8DE80300 		stm	sp, {r0, r1}
 380 0038 9CE80F00 		ldm	ip, {r0, r1, r2, r3}
 381              	.LVL27:
 351:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 382              		.loc 1 351 5 view .LVU83
 383 003c FFF7FEFF 		bl	_3s_2s
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 16


 384              	.LVL28:
 352:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 385              		.loc 1 352 5 is_stmt 1 view .LVU84
 386 0040 04AB     		add	r3, sp, #16
 387 0042 0093     		str	r3, [sp]
 388 0044 B0EE480A 		vmov.f32	s0, s16
 389 0048 96E80F00 		ldm	r6, {r0, r1, r2, r3}
 390 004c FFF7FEFF 		bl	_2s_2r
 391              	.LVL29:
 353:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 392              		.loc 1 353 5 view .LVU85
 353:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 393              		.loc 1 353 29 is_stmt 0 view .LVU86
 394 0050 DDED040A 		vldr.32	s1, [sp, #16]
 353:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 395              		.loc 1 353 22 view .LVU87
 396 0054 C5ED060A 		vstr.32	s1, [r5, #24]
 354:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 397              		.loc 1 354 5 is_stmt 1 view .LVU88
 354:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 398              		.loc 1 354 29 is_stmt 0 view .LVU89
 399 0058 059B     		ldr	r3, [sp, #20]	@ float
 354:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 400              		.loc 1 354 22 view .LVU90
 401 005a EB61     		str	r3, [r5, #28]	@ float
 355:../BLDCMotor/motorctrl.c **** #if 1
 402              		.loc 1 355 5 is_stmt 1 view .LVU91
 355:../BLDCMotor/motorctrl.c **** #if 1
 403              		.loc 1 355 10 is_stmt 0 view .LVU92
 404 005c 0023     		movs	r3, #0
 405 005e 2360     		str	r3, [r4]
 406 0060 6360     		str	r3, [r4, #4]
 407 0062 A360     		str	r3, [r4, #8]
 408 0064 E360     		str	r3, [r4, #12]
 357:../BLDCMotor/motorctrl.c ****     tar_id = sg_motordebug.id_targe;
 409              		.loc 1 357 5 is_stmt 1 view .LVU93
 410              	.LVL30:
 358:../BLDCMotor/motorctrl.c ****     tar_iq = sg_motordebug.iq_targe;
 411              		.loc 1 358 5 view .LVU94
 359:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 412              		.loc 1 359 5 view .LVU95
 359:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 413              		.loc 1 359 12 is_stmt 0 view .LVU96
 414 0066 95ED128A 		vldr.32	s16, [r5, #72]
 415              	.LVL31:
 360:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 416              		.loc 1 360 5 is_stmt 1 view .LVU97
 360:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 417              		.loc 1 360 13 is_stmt 0 view .LVU98
 418 006a 95ED110A 		vldr.32	s0, [r5, #68]
 419 006e 0F4B     		ldr	r3, .L20+4
 420 0070 1868     		ldr	r0, [r3]
 421 0072 FFF7FEFF 		bl	pid_contrl
 422              	.LVL32:
 360:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 423              		.loc 1 360 11 view .LVU99
 424 0076 84ED000A 		vstr.32	s0, [r4]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 17


 361:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 425              		.loc 1 361 5 is_stmt 1 view .LVU100
 361:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 426              		.loc 1 361 33 is_stmt 0 view .LVU101
 427 007a 049B     		ldr	r3, [sp, #16]	@ float
 361:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 428              		.loc 1 361 27 view .LVU102
 429 007c EB63     		str	r3, [r5, #60]	@ float
 362:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 430              		.loc 1 362 5 is_stmt 1 view .LVU103
 362:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 431              		.loc 1 362 12 is_stmt 0 view .LVU104
 432 007e DDED050A 		vldr.32	s1, [sp, #20]
 433 0082 B0EE480A 		vmov.f32	s0, s16
 434 0086 0A4B     		ldr	r3, .L20+8
 435 0088 1868     		ldr	r0, [r3]
 436 008a FFF7FEFF 		bl	pid_contrl
 437              	.LVL33:
 362:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 438              		.loc 1 362 11 view .LVU105
 439 008e 84ED010A 		vstr.32	s0, [r4, #4]
 363:../BLDCMotor/motorctrl.c **** #endif
 440              		.loc 1 363 5 is_stmt 1 view .LVU106
 363:../BLDCMotor/motorctrl.c **** #endif
 441              		.loc 1 363 33 is_stmt 0 view .LVU107
 442 0092 059B     		ldr	r3, [sp, #20]	@ float
 363:../BLDCMotor/motorctrl.c **** #endif
 443              		.loc 1 363 27 view .LVU108
 444 0094 2B65     		str	r3, [r5, #80]	@ float
 365:../BLDCMotor/motorctrl.c **** #endif
 445              		.loc 1 365 5 is_stmt 1 view .LVU109
 367:../BLDCMotor/motorctrl.c **** 
 446              		.loc 1 367 1 is_stmt 0 view .LVU110
 447 0096 2046     		mov	r0, r4
 448 0098 0CB0     		add	sp, sp, #48
 449              	.LCFI13:
 450              		.cfi_def_cfa_offset 40
 451              		@ sp needed
 452 009a BDEC028B 		vldm	sp!, {d8}
 453              	.LCFI14:
 454              		.cfi_restore 80
 455              		.cfi_restore 81
 456              		.cfi_def_cfa_offset 32
 457              	.LVL34:
 367:../BLDCMotor/motorctrl.c **** 
 458              		.loc 1 367 1 view .LVU111
 459 009e BDE87040 		pop	{r4, r5, r6, lr}
 460              	.LCFI15:
 461              		.cfi_restore 14
 462              		.cfi_restore 6
 463              		.cfi_restore 5
 464              		.cfi_restore 4
 465              		.cfi_def_cfa_offset 16
 466              	.LVL35:
 367:../BLDCMotor/motorctrl.c **** 
 467              		.loc 1 367 1 view .LVU112
 468 00a2 04B0     		add	sp, sp, #16
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 18


 469              	.LCFI16:
 470              		.cfi_def_cfa_offset 0
 471 00a4 7047     		bx	lr
 472              	.L21:
 473 00a6 00BF     		.align	2
 474              	.L20:
 475 00a8 00000000 		.word	.LANCHOR0
 476 00ac 00000000 		.word	.LANCHOR1
 477 00b0 00000000 		.word	.LANCHOR2
 478              		.cfi_endproc
 479              	.LFE371:
 481              		.global	__aeabi_f2d
 482              		.global	__aeabi_d2f
 483              		.section	.text._limit_voltagecircle,"ax",%progbits
 484              		.align	1
 485              		.global	_limit_voltagecircle
 486              		.syntax unified
 487              		.thumb
 488              		.thumb_func
 490              	_limit_voltagecircle:
 491              	.LVL36:
 492              	.LFB337:
 303:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 493              		.loc 1 303 49 is_stmt 1 view -0
 494              		.cfi_startproc
 495              		@ args = 20, pretend = 16, frame = 0
 496              		@ frame_needed = 0, uses_anonymous_args = 0
 303:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 497              		.loc 1 303 49 is_stmt 0 view .LVU114
 498 0000 84B0     		sub	sp, sp, #16
 499              	.LCFI17:
 500              		.cfi_def_cfa_offset 16
 501 0002 10B5     		push	{r4, lr}
 502              	.LCFI18:
 503              		.cfi_def_cfa_offset 24
 504              		.cfi_offset 4, -24
 505              		.cfi_offset 14, -20
 506 0004 2DED028B 		vpush.64	{d8}
 507              	.LCFI19:
 508              		.cfi_def_cfa_offset 32
 509              		.cfi_offset 80, -32
 510              		.cfi_offset 81, -28
 511 0008 0446     		mov	r4, r0
 512 000a 05A8     		add	r0, sp, #20
 513 000c 80E80E00 		stm	r0, {r1, r2, r3}
 304:../BLDCMotor/motorctrl.c ****     float voltage_magnitude = sqrt(raw_uab.alpha * raw_uab.alpha + raw_uab.beta * raw_uab.beta); //
 514              		.loc 1 304 5 is_stmt 1 view .LVU115
 515              	.LVL37:
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 516              		.loc 1 305 5 view .LVU116
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 517              		.loc 1 305 43 is_stmt 0 view .LVU117
 518 0010 DDED058A 		vldr.32	s17, [sp, #20]
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 519              		.loc 1 305 50 view .LVU118
 520 0014 28EEA87A 		vmul.f32	s14, s17, s17
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 19


 521              		.loc 1 305 75 view .LVU119
 522 0018 9DED068A 		vldr.32	s16, [sp, #24]
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 523              		.loc 1 305 81 view .LVU120
 524 001c 68EE087A 		vmul.f32	s15, s16, s16
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 525              		.loc 1 305 31 view .LVU121
 526 0020 77EE277A 		vadd.f32	s15, s14, s15
 527 0024 17EE900A 		vmov	r0, s15
 528              	.LVL38:
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 529              		.loc 1 305 31 view .LVU122
 530 0028 FFF7FEFF 		bl	__aeabi_f2d
 531              	.LVL39:
 532 002c 41EC100B 		vmov	d0, r0, r1
 533 0030 FFF7FEFF 		bl	sqrt
 534              	.LVL40:
 535 0034 51EC100B 		vmov	r0, r1, d0
 305:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 536              		.loc 1 305 11 view .LVU123
 537 0038 FFF7FEFF 		bl	__aeabi_d2f
 538              	.LVL41:
 539 003c 07EE900A 		vmov	s15, r0
 540              	.LVL42:
 306:../BLDCMotor/motorctrl.c ****     if (voltage_magnitude > max_voltage) {  
 541              		.loc 1 306 5 is_stmt 1 view .LVU124
 307:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 542              		.loc 1 307 5 view .LVU125
 307:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 543              		.loc 1 307 8 is_stmt 0 view .LVU126
 544 0040 B2EE0A7A 		vmov.f32	s14, #1.3e+1
 545 0044 F4EEC77A 		vcmpe.f32	s15, s14
 546 0048 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 547 004c 12DD     		ble	.L27
 548              	.LBB3:
 309:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 549              		.loc 1 309 9 is_stmt 1 view .LVU127
 309:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 550              		.loc 1 309 15 is_stmt 0 view .LVU128
 551 004e F0EE476A 		vmov.f32	s13, s14
 552 0052 86EEA77A 		vdiv.f32	s14, s13, s15
 553              	.LVL43:
 310:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 554              		.loc 1 310 9 is_stmt 1 view .LVU129
 310:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 555              		.loc 1 310 35 is_stmt 0 view .LVU130
 556 0056 68EE878A 		vmul.f32	s17, s17, s14
 310:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 557              		.loc 1 310 19 view .LVU131
 558 005a C4ED008A 		vstr.32	s17, [r4]
 311:../BLDCMotor/motorctrl.c ****     } else {  
 559              		.loc 1 311 9 is_stmt 1 view .LVU132
 311:../BLDCMotor/motorctrl.c ****     } else {  
 560              		.loc 1 311 33 is_stmt 0 view .LVU133
 561 005e 28EE078A 		vmul.f32	s16, s16, s14
 311:../BLDCMotor/motorctrl.c ****     } else {  
 562              		.loc 1 311 18 view .LVU134
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 20


 563 0062 84ED018A 		vstr.32	s16, [r4, #4]
 564              	.LVL44:
 565              	.L22:
 311:../BLDCMotor/motorctrl.c ****     } else {  
 566              		.loc 1 311 18 view .LVU135
 567              	.LBE3:
 318:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 568              		.loc 1 318 1 view .LVU136
 569 0066 2046     		mov	r0, r4
 570              	.LVL45:
 318:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 571              		.loc 1 318 1 view .LVU137
 572 0068 BDEC028B 		vldm	sp!, {d8}
 573              	.LCFI20:
 574              		.cfi_remember_state
 575              		.cfi_restore 80
 576              		.cfi_restore 81
 577              		.cfi_def_cfa_offset 24
 578 006c BDE81040 		pop	{r4, lr}
 579              	.LCFI21:
 580              		.cfi_restore 14
 581              		.cfi_restore 4
 582              		.cfi_def_cfa_offset 16
 583              	.LVL46:
 318:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 584              		.loc 1 318 1 view .LVU138
 585 0070 04B0     		add	sp, sp, #16
 586              	.LCFI22:
 587              		.cfi_def_cfa_offset 0
 588 0072 7047     		bx	lr
 589              	.LVL47:
 590              	.L27:
 591              	.LCFI23:
 592              		.cfi_restore_state
 314:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 593              		.loc 1 314 9 is_stmt 1 view .LVU139
 314:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 594              		.loc 1 314 19 is_stmt 0 view .LVU140
 595 0074 C4ED008A 		vstr.32	s17, [r4]
 315:../BLDCMotor/motorctrl.c ****     }
 596              		.loc 1 315 9 is_stmt 1 view .LVU141
 315:../BLDCMotor/motorctrl.c ****     }
 597              		.loc 1 315 18 is_stmt 0 view .LVU142
 598 0078 84ED018A 		vstr.32	s16, [r4, #4]
 317:../BLDCMotor/motorctrl.c **** }
 599              		.loc 1 317 5 is_stmt 1 view .LVU143
 317:../BLDCMotor/motorctrl.c **** }
 600              		.loc 1 317 12 is_stmt 0 view .LVU144
 601 007c F3E7     		b	.L22
 602              		.cfi_endproc
 603              	.LFE337:
 605              		.section	.text._50uscycle_process,"ax",%progbits
 606              		.align	1
 607              		.global	_50uscycle_process
 608              		.syntax unified
 609              		.thumb
 610              		.thumb_func
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 21


 612              	_50uscycle_process:
 613              	.LVL48:
 614              	.LFB336:
 108:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 615              		.loc 1 108 1 is_stmt 1 view -0
 616              		.cfi_startproc
 617              		@ args = 0, pretend = 0, frame = 88
 618              		@ frame_needed = 0, uses_anonymous_args = 0
 108:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 619              		.loc 1 108 1 is_stmt 0 view .LVU146
 620 0000 70B5     		push	{r4, r5, r6, lr}
 621              	.LCFI24:
 622              		.cfi_def_cfa_offset 16
 623              		.cfi_offset 4, -16
 624              		.cfi_offset 5, -12
 625              		.cfi_offset 6, -8
 626              		.cfi_offset 14, -4
 627 0002 2DED048B 		vpush.64	{d8, d9}
 628              	.LCFI25:
 629              		.cfi_def_cfa_offset 32
 630              		.cfi_offset 80, -32
 631              		.cfi_offset 81, -28
 632              		.cfi_offset 82, -24
 633              		.cfi_offset 83, -20
 634 0006 9AB0     		sub	sp, sp, #104
 635              	.LCFI26:
 636              		.cfi_def_cfa_offset 136
 109:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;    
 637              		.loc 1 109 5 is_stmt 1 view .LVU147
 110:../BLDCMotor/motorctrl.c ****     duty_t dut01,dut02;
 638              		.loc 1 110 5 view .LVU148
 111:../BLDCMotor/motorctrl.c **** /*----------------‰∏âÁõ∏ÁîµÊµÅÂ§ÑÁêÜ------------------------------*/    
 639              		.loc 1 111 5 view .LVU149
 113:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 640              		.loc 1 113 5 view .LVU150
 114:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 641              		.loc 1 114 5 view .LVU151
 115:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 642              		.loc 1 115 5 view .LVU152
 115:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 643              		.loc 1 115 18 is_stmt 0 view .LVU153
 644 0008 0268     		ldr	r2, [r0]
 115:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 645              		.loc 1 115 22 view .LVU154
 646 000a A2F64902 		subw	r2, r2, #2121
 647              	.LVL49:
 116:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 648              		.loc 1 116 5 is_stmt 1 view .LVU155
 116:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 649              		.loc 1 116 18 is_stmt 0 view .LVU156
 650 000e 4368     		ldr	r3, [r0, #4]
 116:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 651              		.loc 1 116 22 view .LVU157
 652 0010 A3F50563 		sub	r3, r3, #2128
 653 0014 08EE903A 		vmov	s17, r3	@ int
 654              	.LVL50:
 117:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 22


 655              		.loc 1 117 5 is_stmt 1 view .LVU158
 117:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 656              		.loc 1 117 18 is_stmt 0 view .LVU159
 657 0018 8368     		ldr	r3, [r0, #8]
 658              	.LVL51:
 117:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 659              		.loc 1 117 22 view .LVU160
 660 001a A3F66403 		subw	r3, r3, #2148
 661 001e 08EE103A 		vmov	s16, r3	@ int
 662              	.LVL52:
 118:../BLDCMotor/motorctrl.c **** 
 663              		.loc 1 118 5 is_stmt 1 view .LVU161
 118:../BLDCMotor/motorctrl.c **** 
 664              		.loc 1 118 24 is_stmt 0 view .LVU162
 665 0022 4E4B     		ldr	r3, .L33
 666              	.LVL53:
 118:../BLDCMotor/motorctrl.c **** 
 667              		.loc 1 118 24 view .LVU163
 668 0024 1A62     		str	r2, [r3, #32]
 120:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 669              		.loc 1 120 5 is_stmt 1 view .LVU164
 120:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 670              		.loc 1 120 10 is_stmt 0 view .LVU165
 671 0026 07EE902A 		vmov	s15, r2	@ int
 672 002a F8EEE77A 		vcvt.f32.s32	s15, s15
 673              	.LVL54:
 121:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 674              		.loc 1 121 5 is_stmt 1 view .LVU166
 121:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 675              		.loc 1 121 10 is_stmt 0 view .LVU167
 676 002e F8EEE88A 		vcvt.f32.s32	s17, s17
 677              	.LVL55:
 121:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 678              		.loc 1 121 8 view .LVU168
 679 0032 9FED4B7A 		vldr.32	s14, .L33+4
 680 0036 68EE878A 		vmul.f32	s17, s17, s14
 681              	.LVL56:
 122:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 682              		.loc 1 122 5 is_stmt 1 view .LVU169
 122:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 683              		.loc 1 122 10 is_stmt 0 view .LVU170
 684 003a B8EEC88A 		vcvt.f32.s32	s16, s16
 685              	.LVL57:
 122:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 686              		.loc 1 122 8 view .LVU171
 687 003e 9FED497A 		vldr.32	s14, .L33+8
 688 0042 28EE078A 		vmul.f32	s16, s16, s14
 689              	.LVL58:
 123:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 690              		.loc 1 123 5 is_stmt 1 view .LVU172
 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 691              		.loc 1 124 5 view .LVU173
 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 692              		.loc 1 124 15 is_stmt 0 view .LVU174
 693 0046 484C     		ldr	r4, .L33+12
 694 0048 9FED480A 		vldr.32	s0, .L33+16
 695              	.LVL59:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 23


 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 696              		.loc 1 124 15 view .LVU175
 697 004c 27EE800A 		vmul.f32	s0, s15, s0
 698              	.LVL60:
 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 699              		.loc 1 124 15 view .LVU176
 700 0050 2046     		mov	r0, r4
 701              	.LVL61:
 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 702              		.loc 1 124 15 view .LVU177
 703 0052 FFF7FEFF 		bl	lowfilter_cale
 704              	.LVL62:
 124:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 705              		.loc 1 124 13 view .LVU178
 706 0056 8DED110A 		vstr.32	s0, [sp, #68]
 125:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 707              		.loc 1 125 5 is_stmt 1 view .LVU179
 125:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 708              		.loc 1 125 15 is_stmt 0 view .LVU180
 709 005a B0EE680A 		vmov.f32	s0, s17
 710 005e 04F10800 		add	r0, r4, #8
 711 0062 FFF7FEFF 		bl	lowfilter_cale
 712              	.LVL63:
 125:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 713              		.loc 1 125 13 view .LVU181
 714 0066 8DED120A 		vstr.32	s0, [sp, #72]
 126:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 715              		.loc 1 126 5 is_stmt 1 view .LVU182
 126:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 716              		.loc 1 126 15 is_stmt 0 view .LVU183
 717 006a B0EE480A 		vmov.f32	s0, s16
 718 006e 04F11000 		add	r0, r4, #16
 719 0072 FFF7FEFF 		bl	lowfilter_cale
 720              	.LVL64:
 126:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 721              		.loc 1 126 13 view .LVU184
 722 0076 8DED130A 		vstr.32	s0, [sp, #76]
 240:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
 723              		.loc 1 240 3 is_stmt 1 view .LVU185
 724              	.LVL65:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 725              		.loc 1 241 3 view .LVU186
 726              	.LBB4:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 727              		.loc 1 241 3 view .LVU187
 728 007a FFF7FEFF 		bl	get_system_ticks
 729              	.LVL66:
 730 007e 0546     		mov	r5, r0
 731 0080 0C46     		mov	r4, r1
 732              	.LVL67:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 733              		.loc 1 241 3 is_stmt 0 view .LVU188
 734 0082 0022     		movs	r2, #0
 735              	.LBE4:
 240:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
 736              		.loc 1 240 16 view .LVU189
 737 0084 1346     		mov	r3, r2
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 24


 738              	.LVL68:
 739              	.L31:
 740              	.LBB7:
 741              	.LBB5:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 742              		.loc 1 241 3 is_stmt 1 discriminator 5 view .LVU190
 743              	.LBE5:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 744              		.loc 1 241 3 discriminator 5 view .LVU191
 745 0086 02F10806 		add	r6, r2, #8
 746              	.LVL69:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 747              		.loc 1 241 3 is_stmt 0 discriminator 5 view .LVU192
 748 008a 2ABB     		cbnz	r2, .L30
 242:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 749              		.loc 1 242 5 is_stmt 1 view .LVU193
 242:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 750              		.loc 1 242 32 is_stmt 0 view .LVU194
 751 008c 0121     		movs	r1, #1
 752 008e 0020     		movs	r0, #0
 753 0090 FFF7FEFF 		bl	sensor_user_read
 754              	.LVL70:
 243:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 755              		.loc 1 243 5 is_stmt 1 view .LVU195
 243:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 756              		.loc 1 243 18 is_stmt 0 view .LVU196
 757 0094 0068     		ldr	r0, [r0]
 758              	.LVL71:
 243:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 759              		.loc 1 243 18 view .LVU197
 760 0096 FFF7FEFF 		bl	_IQ20toF
 761              	.LVL72:
 244:../BLDCMotor/motorctrl.c ****     mech_theta += ANGLE_COMPENSATA;
 762              		.loc 1 244 5 is_stmt 1 view .LVU198
 763 009a 354B     		ldr	r3, .L33+20
 764 009c D3ED007A 		vldr.32	s15, [r3]
 244:../BLDCMotor/motorctrl.c ****     mech_theta += ANGLE_COMPENSATA;
 765              		.loc 1 244 16 is_stmt 0 view .LVU199
 766 00a0 30EE670A 		vsub.f32	s0, s0, s15
 767              	.LVL73:
 245:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 768              		.loc 1 245 5 is_stmt 1 view .LVU200
 245:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 769              		.loc 1 245 16 is_stmt 0 view .LVU201
 770 00a4 DFED337A 		vldr.32	s15, .L33+24
 771 00a8 30EE270A 		vadd.f32	s0, s0, s15
 772              	.LVL74:
 246:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 773              		.loc 1 246 5 is_stmt 1 view .LVU202
 247:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 774              		.loc 1 247 5 view .LVU203
 247:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 775              		.loc 1 247 18 is_stmt 0 view .LVU204
 776 00ac 30EE000A 		vadd.f32	s0, s0, s0
 777              	.LVL75:
 247:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 778              		.loc 1 247 18 view .LVU205
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 25


 779 00b0 FFF7FEFF 		bl	_normalize_angle
 780              	.LVL76:
 247:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 781              		.loc 1 247 18 view .LVU206
 782 00b4 B0EE409A 		vmov.f32	s18, s0
 783              	.LVL77:
 248:../BLDCMotor/motorctrl.c ****   }
 784              		.loc 1 248 5 is_stmt 1 view .LVU207
 248:../BLDCMotor/motorctrl.c ****   }
 785              		.loc 1 248 29 is_stmt 0 view .LVU208
 786 00b8 284B     		ldr	r3, .L33
 787 00ba 83ED1B0A 		vstr.32	s0, [r3, #108]
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 788              		.loc 1 241 3 is_stmt 1 view .LVU209
 789              	.LBB6:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 790              		.loc 1 241 3 view .LVU210
 791 00be FFF7FEFF 		bl	get_system_ticks
 792              	.LVL78:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 793              		.loc 1 241 3 is_stmt 0 view .LVU211
 794 00c2 401B     		subs	r0, r0, r5
 795 00c4 61EB0404 		sbc	r4, r1, r4
 796 00c8 2B4B     		ldr	r3, .L33+28
 797 00ca 1B68     		ldr	r3, [r3]
 798 00cc C51A     		subs	r5, r0, r3
 799 00ce 64EBE374 		sbc	r4, r4, r3, asr #31
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 800              		.loc 1 241 3 is_stmt 1 view .LVU212
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 801              		.loc 1 241 3 view .LVU213
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 802              		.loc 1 241 3 view .LVU214
 803 00d2 2B46     		mov	r3, r5
 804              	.LVL79:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 805              		.loc 1 241 3 is_stmt 0 view .LVU215
 806              	.LBE6:
 807 00d4 3246     		mov	r2, r6
 808 00d6 D6E7     		b	.L31
 809              	.L30:
 241:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 810              		.loc 1 241 3 view .LVU216
 811              	.LBE7:
 250:../BLDCMotor/motorctrl.c **** 
 812              		.loc 1 250 3 is_stmt 1 view .LVU217
 250:../BLDCMotor/motorctrl.c **** 
 813              		.loc 1 250 30 is_stmt 0 view .LVU218
 814 00d8 284A     		ldr	r2, .L33+32
 815 00da A2FB0323 		umull	r2, r3, r2, r3
 816              	.LVL80:
 250:../BLDCMotor/motorctrl.c **** 
 817              		.loc 1 250 30 view .LVU219
 818 00de DB09     		lsrs	r3, r3, #7
 250:../BLDCMotor/motorctrl.c **** 
 819              		.loc 1 250 18 view .LVU220
 820 00e0 274A     		ldr	r2, .L33+36
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 26


 821 00e2 1360     		str	r3, [r2]
 822              	.LBB8:
 283:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 823              		.loc 1 283 9 is_stmt 1 view .LVU221
 283:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 824              		.loc 1 283 14 is_stmt 0 view .LVU222
 825 00e4 274B     		ldr	r3, .L33+40
 826 00e6 09AD     		add	r5, sp, #36
 827 00e8 0FCB     		ldm	r3, {r0, r1, r2, r3}
 828 00ea 85E80F00 		stm	r5, {r0, r1, r2, r3}
 284:../BLDCMotor/motorctrl.c ****         #if 1/*Èó≠ÁéØÊéßÂà∂*/
 829              		.loc 1 284 9 is_stmt 1 view .LVU223
 286:../BLDCMotor/motorctrl.c ****         #else
 830              		.loc 1 286 13 view .LVU224
 286:../BLDCMotor/motorctrl.c ****         #else
 831              		.loc 1 286 19 is_stmt 0 view .LVU225
 832 00ee 14AB     		add	r3, sp, #80
 833 00f0 93E80700 		ldm	r3, {r0, r1, r2}
 834 00f4 8DE80700 		stm	sp, {r0, r1, r2}
 835 00f8 11AB     		add	r3, sp, #68
 836 00fa 0ECB     		ldm	r3, {r1, r2, r3}
 837 00fc B0EE490A 		vmov.f32	s0, s18
 838 0100 2846     		mov	r0, r5
 839 0102 FFF7FEFF 		bl	_currmentloop
 840              	.LVL81:
 294:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 841              		.loc 1 294 9 is_stmt 1 view .LVU226
 294:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 842              		.loc 1 294 15 is_stmt 0 view .LVU227
 843 0106 0DAC     		add	r4, sp, #52
 844 0108 1F4E     		ldr	r6, .L33+44
 845              	.LVL82:
 294:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 846              		.loc 1 294 15 view .LVU228
 847 010a 0C9B     		ldr	r3, [sp, #48]
 848 010c 0093     		str	r3, [sp]
 849 010e 95E80E00 		ldm	r5, {r1, r2, r3}
 850 0112 96ED000A 		vldr.32	s0, [r6]
 851 0116 2046     		mov	r0, r4
 852 0118 FFF7FEFF 		bl	_2r_2s
 853              	.LVL83:
 295:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 854              		.loc 1 295 9 is_stmt 1 view .LVU229
 295:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 855              		.loc 1 295 15 is_stmt 0 view .LVU230
 856 011c 04AD     		add	r5, sp, #16
 857 011e 109B     		ldr	r3, [sp, #64]
 858 0120 0093     		str	r3, [sp]
 859 0122 94E80E00 		ldm	r4, {r1, r2, r3}
 860 0126 2846     		mov	r0, r5
 861 0128 FFF7FEFF 		bl	_limit_voltagecircle
 862              	.LVL84:
 863 012c 95E80F00 		ldm	r5, {r0, r1, r2, r3}
 864 0130 84E80F00 		stm	r4, {r0, r1, r2, r3}
 296:../BLDCMotor/motorctrl.c ****         per_eleangle = elec_theta;
 865              		.loc 1 296 9 is_stmt 1 view .LVU231
 866 0134 DDED0E0A 		vldr.32	s1, [sp, #56]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 27


 867 0138 9DED0D0A 		vldr.32	s0, [sp, #52]
 868 013c FFF7FEFF 		bl	_svpwm
 869              	.LVL85:
 870 0140 8DED170A 		vstr.32	s0, [sp, #92]
 871 0144 CDED180A 		vstr.32	s1, [sp, #96]
 872 0148 8DED191A 		vstr.32	s2, [sp, #100]
 873 014c FFF7FEFF 		bl	motor_set_pwm
 874              	.LVL86:
 297:../BLDCMotor/motorctrl.c ****     }
 875              		.loc 1 297 9 view .LVU232
 297:../BLDCMotor/motorctrl.c ****     }
 876              		.loc 1 297 22 is_stmt 0 view .LVU233
 877 0150 86ED009A 		vstr.32	s18, [r6]
 878              	.LBE8:
 301:../BLDCMotor/motorctrl.c **** }
 879              		.loc 1 301 5 is_stmt 1 view .LVU234
 302:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab) {  
 880              		.loc 1 302 1 is_stmt 0 view .LVU235
 881 0154 1AB0     		add	sp, sp, #104
 882              	.LCFI27:
 883              		.cfi_def_cfa_offset 32
 884              		@ sp needed
 885 0156 BDEC048B 		vldm	sp!, {d8-d9}
 886              	.LCFI28:
 887              		.cfi_restore 82
 888              		.cfi_restore 83
 889              		.cfi_restore 80
 890              		.cfi_restore 81
 891              		.cfi_def_cfa_offset 16
 892              	.LVL87:
 302:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab) {  
 893              		.loc 1 302 1 view .LVU236
 894 015a 70BD     		pop	{r4, r5, r6, pc}
 895              	.L34:
 302:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab) {  
 896              		.loc 1 302 1 view .LVU237
 897              		.align	2
 898              	.L33:
 899 015c 00000000 		.word	.LANCHOR0
 900 0160 713D0A3F 		.word	1057635697
 901 0164 FFAFB23E 		.word	1051897855
 902 0168 00000000 		.word	.LANCHOR3
 903 016c 52B89E3E 		.word	1050589266
 904 0170 00000000 		.word	.LANCHOR4
 905 0174 00000000 		.word	0
 906 0178 00000000 		.word	g_nOffset
 907 017c C1C0C0C0 		.word	-1061109567
 908 0180 00000000 		.word	.LANCHOR5
 909 0184 00000000 		.word	.LANCHOR6
 910 0188 00000000 		.word	.LANCHOR7
 911              		.cfi_endproc
 912              	.LFE336:
 914              		.section	.text.foc_paraminit,"ax",%progbits
 915              		.align	1
 916              		.global	foc_paraminit
 917              		.syntax unified
 918              		.thumb
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 28


 919              		.thumb_func
 921              	foc_paraminit:
 922              	.LFB377:
 447:../BLDCMotor/motorctrl.c **** 
 448:../BLDCMotor/motorctrl.c **** void foc_paraminit(void)
 449:../BLDCMotor/motorctrl.c **** {
 923              		.loc 1 449 1 is_stmt 1 view -0
 924              		.cfi_startproc
 925              		@ args = 0, pretend = 0, frame = 0
 926              		@ frame_needed = 0, uses_anonymous_args = 0
 927 0000 38B5     		push	{r3, r4, r5, lr}
 928              	.LCFI29:
 929              		.cfi_def_cfa_offset 16
 930              		.cfi_offset 3, -16
 931              		.cfi_offset 4, -12
 932              		.cfi_offset 5, -8
 933              		.cfi_offset 14, -4
 934 0002 2DED028B 		vpush.64	{d8}
 935              	.LCFI30:
 936              		.cfi_def_cfa_offset 24
 937              		.cfi_offset 80, -24
 938              		.cfi_offset 81, -20
 450:../BLDCMotor/motorctrl.c ****     sgp_curloop_d_pid = &(sg_curloop_param.d_pid);
 939              		.loc 1 450 5 view .LVU239
 940              		.loc 1 450 23 is_stmt 0 view .LVU240
 941 0006 1D48     		ldr	r0, .L37
 942 0008 1D4B     		ldr	r3, .L37+4
 943 000a 1860     		str	r0, [r3]
 451:../BLDCMotor/motorctrl.c ****     sgp_curloop_q_pid = &sg_curloop_param.q_pid;
 944              		.loc 1 451 5 is_stmt 1 view .LVU241
 945              		.loc 1 451 23 is_stmt 0 view .LVU242
 946 000c 1D4D     		ldr	r5, .L37+8
 947 000e 00F11C03 		add	r3, r0, #28
 948 0012 2B60     		str	r3, [r5]
 452:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_d_pid,sg_motordebug.pid_d_kp,sg_motordebug.pid_d_ki,0.001f,D_MAX_VAL,D_MIN
 949              		.loc 1 452 5 is_stmt 1 view .LVU243
 950 0014 9FED1C8A 		vldr.32	s16, .L37+12
 951 0018 1C4C     		ldr	r4, .L37+16
 952 001a BAEE0A2A 		vmov.f32	s4, #-1.3e+1
 953 001e F2EE0A1A 		vmov.f32	s3, #1.3e+1
 954 0022 B0EE481A 		vmov.f32	s2, s16
 955 0026 D4ED1A0A 		vldr.32	s1, [r4, #104]
 956 002a 94ED190A 		vldr.32	s0, [r4, #100]
 957 002e FFF7FEFF 		bl	pid_init
 958              	.LVL88:
 453:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_q_pid,sg_motordebug.pid_d_kp,sg_motordebug.pid_d_ki,0.001f,D_MAX_VAL,D_MIN
 959              		.loc 1 453 5 view .LVU244
 960 0032 BAEE0A2A 		vmov.f32	s4, #-1.3e+1
 961 0036 F2EE0A1A 		vmov.f32	s3, #1.3e+1
 962 003a B0EE481A 		vmov.f32	s2, s16
 963 003e D4ED1A0A 		vldr.32	s1, [r4, #104]
 964 0042 94ED190A 		vldr.32	s0, [r4, #100]
 965 0046 2868     		ldr	r0, [r5]
 966 0048 FFF7FEFF 		bl	pid_init
 967              	.LVL89:
 454:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[0],80);
 968              		.loc 1 454 5 view .LVU245
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 29


 969 004c 9FED108A 		vldr.32	s16, .L37+20
 970 0050 104C     		ldr	r4, .L37+24
 971 0052 B0EE480A 		vmov.f32	s0, s16
 972 0056 2046     		mov	r0, r4
 973 0058 FFF7FEFF 		bl	lowfilter_init
 974              	.LVL90:
 455:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[1],80);
 975              		.loc 1 455 5 view .LVU246
 976 005c B0EE480A 		vmov.f32	s0, s16
 977 0060 04F10800 		add	r0, r4, #8
 978 0064 FFF7FEFF 		bl	lowfilter_init
 979              	.LVL91:
 456:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[2],80);
 980              		.loc 1 456 5 view .LVU247
 981 0068 B0EE480A 		vmov.f32	s0, s16
 982 006c 04F11000 		add	r0, r4, #16
 983 0070 FFF7FEFF 		bl	lowfilter_init
 984              	.LVL92:
 457:../BLDCMotor/motorctrl.c **** }
 985              		.loc 1 457 1 is_stmt 0 view .LVU248
 986 0074 BDEC028B 		vldm	sp!, {d8}
 987              	.LCFI31:
 988              		.cfi_restore 80
 989              		.cfi_restore 81
 990              		.cfi_def_cfa_offset 16
 991 0078 38BD     		pop	{r3, r4, r5, pc}
 992              	.L38:
 993 007a 00BF     		.align	2
 994              	.L37:
 995 007c 00000000 		.word	.LANCHOR8
 996 0080 00000000 		.word	.LANCHOR1
 997 0084 00000000 		.word	.LANCHOR2
 998 0088 6F12833A 		.word	981668463
 999 008c 00000000 		.word	.LANCHOR0
 1000 0090 0000A042 		.word	1117782016
 1001 0094 00000000 		.word	.LANCHOR3
 1002              		.cfi_endproc
 1003              	.LFE377:
 1005              		.section	.text.motortctrl_process,"ax",%progbits
 1006              		.align	1
 1007              		.global	motortctrl_process
 1008              		.syntax unified
 1009              		.thumb
 1010              		.thumb_func
 1012              	motortctrl_process:
 1013              	.LFB335:
  58:../BLDCMotor/motorctrl.c ****     char rec_buf[64];
 1014              		.loc 1 58 1 is_stmt 1 view -0
 1015              		.cfi_startproc
 1016              		@ args = 0, pretend = 0, frame = 0
 1017              		@ frame_needed = 0, uses_anonymous_args = 0
 1018 0000 08B5     		push	{r3, lr}
 1019              	.LCFI32:
 1020              		.cfi_def_cfa_offset 8
 1021              		.cfi_offset 3, -8
 1022              		.cfi_offset 14, -4
  59:../BLDCMotor/motorctrl.c ****     char cnt = 0;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 30


 1023              		.loc 1 59 5 view .LVU250
  60:../BLDCMotor/motorctrl.c ****     // if (readline_fromPC(rec_buf,sizeof(rec_buf)))
 1024              		.loc 1 60 5 view .LVU251
 1025              	.LVL93:
  65:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
 1026              		.loc 1 65 5 view .LVU252
 1027 0002 FFF7FEFF 		bl	motorprotocol_process
 1028              	.LVL94:
  66:../BLDCMotor/motorctrl.c ****     {
 1029              		.loc 1 66 5 view .LVU253
  66:../BLDCMotor/motorctrl.c ****     {
 1030              		.loc 1 66 21 is_stmt 0 view .LVU254
 1031 0006 1A4B     		ldr	r3, .L48
 1032 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  66:../BLDCMotor/motorctrl.c ****     {
 1033              		.loc 1 66 5 view .LVU255
 1034 000a 042B     		cmp	r3, #4
 1035 000c 2BD8     		bhi	.L39
 1036 000e DFE803F0 		tbb	[pc, r3]
 1037              	.L42:
 1038 0012 03       		.byte	(.L45-.L42)/2
 1039 0013 26       		.byte	(.L44-.L42)/2
 1040 0014 2A       		.byte	(.L39-.L42)/2
 1041 0015 15       		.byte	(.L43-.L42)/2
 1042 0016 21       		.byte	(.L41-.L42)/2
 1043 0017 00       		.p2align 1
 1044              	.L45:
  69:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1045              		.loc 1 69 9 is_stmt 1 view .LVU256
  69:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1046              		.loc 1 69 29 is_stmt 0 view .LVU257
 1047 0018 FFF7FEFF 		bl	_get_angleoffset
 1048              	.LVL95:
  69:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1049              		.loc 1 69 27 view .LVU258
 1050 001c 154B     		ldr	r3, .L48+4
 1051 001e 83ED000A 		vstr.32	s0, [r3]
  70:../BLDCMotor/motorctrl.c ****         foc_paraminit();
 1052              		.loc 1 70 9 is_stmt 1 view .LVU259
 1053 0022 FFF7FEFF 		bl	sg_debug_clear
 1054              	.LVL96:
  71:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
 1055              		.loc 1 71 9 view .LVU260
 1056 0026 FFF7FEFF 		bl	foc_paraminit
 1057              	.LVL97:
  72:../BLDCMotor/motorctrl.c ****         motor_enable();
 1058              		.loc 1 72 9 view .LVU261
 1059 002a 1420     		movs	r0, #20
 1060 002c FFF7FEFF 		bl	HAL_Delay
 1061              	.LVL98:
  73:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
 1062              		.loc 1 73 9 view .LVU262
 1063 0030 FFF7FEFF 		bl	motor_enable
 1064              	.LVL99:
  74:../BLDCMotor/motorctrl.c ****         break;
 1065              		.loc 1 74 9 view .LVU263
  74:../BLDCMotor/motorctrl.c ****         break;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 31


 1066              		.loc 1 74 24 is_stmt 0 view .LVU264
 1067 0034 0E4B     		ldr	r3, .L48
 1068 0036 0322     		movs	r2, #3
 1069 0038 1A70     		strb	r2, [r3]
  75:../BLDCMotor/motorctrl.c **** 
 1070              		.loc 1 75 9 is_stmt 1 view .LVU265
 1071 003a 14E0     		b	.L39
 1072              	.L43:
  79:../BLDCMotor/motorctrl.c ****             {
 1073              		.loc 1 79 13 view .LVU266
  79:../BLDCMotor/motorctrl.c ****             {
 1074              		.loc 1 79 29 is_stmt 0 view .LVU267
 1075 003c 0C4A     		ldr	r2, .L48
 1076 003e 5388     		ldrh	r3, [r2, #2]
  79:../BLDCMotor/motorctrl.c ****             {
 1077              		.loc 1 79 19 view .LVU268
 1078 0040 0133     		adds	r3, r3, #1
  79:../BLDCMotor/motorctrl.c ****             {
 1079              		.loc 1 79 16 view .LVU269
 1080 0042 5380     		strh	r3, [r2, #2]	@ movhi
  82:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 1)
 1081              		.loc 1 82 13 is_stmt 1 view .LVU270
  83:../BLDCMotor/motorctrl.c ****             {
 1082              		.loc 1 83 13 view .LVU271
  83:../BLDCMotor/motorctrl.c ****             {
 1083              		.loc 1 83 30 is_stmt 0 view .LVU272
 1084 0044 0C4B     		ldr	r3, .L48+8
 1085 0046 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  83:../BLDCMotor/motorctrl.c ****             {
 1086              		.loc 1 83 16 view .LVU273
 1087 0048 012B     		cmp	r3, #1
 1088 004a 0CD1     		bne	.L39
  85:../BLDCMotor/motorctrl.c ****             }
 1089              		.loc 1 85 17 is_stmt 1 view .LVU274
  85:../BLDCMotor/motorctrl.c ****             }
 1090              		.loc 1 85 32 is_stmt 0 view .LVU275
 1091 004c 1346     		mov	r3, r2
 1092 004e 0422     		movs	r2, #4
 1093 0050 1A70     		strb	r2, [r3]
 1094 0052 08E0     		b	.L39
 1095              	.L41:
  91:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_IDLE;
 1096              		.loc 1 91 9 is_stmt 1 view .LVU276
 1097 0054 FFF7FEFF 		bl	motor_disable
 1098              	.LVL100:
  92:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
 1099              		.loc 1 92 9 view .LVU277
  92:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
 1100              		.loc 1 92 24 is_stmt 0 view .LVU278
 1101 0058 054B     		ldr	r3, .L48
 1102 005a 0122     		movs	r2, #1
 1103 005c 1A70     		strb	r2, [r3]
 1104              	.L44:
  94:../BLDCMotor/motorctrl.c ****             {
 1105              		.loc 1 94 13 is_stmt 1 view .LVU279
  94:../BLDCMotor/motorctrl.c ****             {
 1106              		.loc 1 94 30 is_stmt 0 view .LVU280
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 32


 1107 005e 064B     		ldr	r3, .L48+8
 1108 0060 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  94:../BLDCMotor/motorctrl.c ****             {
 1109              		.loc 1 94 16 view .LVU281
 1110 0062 032B     		cmp	r3, #3
 1111 0064 00D0     		beq	.L47
 1112              	.L39:
 103:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 1113              		.loc 1 103 1 view .LVU282
 1114 0066 08BD     		pop	{r3, pc}
 1115              	.L47:
  96:../BLDCMotor/motorctrl.c ****             }        
 1116              		.loc 1 96 17 is_stmt 1 view .LVU283
  96:../BLDCMotor/motorctrl.c ****             }        
 1117              		.loc 1 96 32 is_stmt 0 view .LVU284
 1118 0068 014B     		ldr	r3, .L48
 1119 006a 0022     		movs	r2, #0
 1120 006c 1A70     		strb	r2, [r3]
 103:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 1121              		.loc 1 103 1 view .LVU285
 1122 006e FAE7     		b	.L39
 1123              	.L49:
 1124              		.align	2
 1125              	.L48:
 1126 0070 00000000 		.word	.LANCHOR9
 1127 0074 00000000 		.word	.LANCHOR4
 1128 0078 00000000 		.word	.LANCHOR0
 1129              		.cfi_endproc
 1130              	.LFE335:
 1132              		.global	per_eleangle
 1133              		.global	test_angletime
 1134              		.global	test_ic
 1135              		.global	test_ib
 1136              		.global	test_ia
 1137              		.global	raw_angle
 1138              		.global	next_angle_test
 1139              		.global	pre_angle_test
 1140              		.global	test_d_pid
 1141              		.global	g_Motor1
 1142              		.global	sg_motordebug
 1143              		.section	.rodata
 1144              		.align	2
 1145              		.set	.LANCHOR6,. + 0
 1146              	.LC0:
 1147 0000 00000000 		.word	0
 1148 0004 0000803F 		.word	1065353216
 1149 0008 00000000 		.word	0
 1150 000c 66660000 		.word	26214
 1151              		.section	.bss.g_Motor1,"aw",%nobits
 1152              		.align	2
 1153              		.set	.LANCHOR9,. + 0
 1156              	g_Motor1:
 1157 0000 00000000 		.space	4
 1158              		.section	.bss.next_angle_test,"aw",%nobits
 1159              		.align	2
 1162              	next_angle_test:
 1163 0000 00000000 		.space	4
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 33


 1164              		.section	.bss.per_eleangle,"aw",%nobits
 1165              		.align	2
 1166              		.set	.LANCHOR7,. + 0
 1169              	per_eleangle:
 1170 0000 00000000 		.space	4
 1171              		.section	.bss.pre_angle_test,"aw",%nobits
 1172              		.align	2
 1175              	pre_angle_test:
 1176 0000 00000000 		.space	4
 1177              		.section	.bss.raw_angle,"aw",%nobits
 1178              		.align	2
 1181              	raw_angle:
 1182 0000 00000000 		.space	4
 1183              		.section	.bss.sg_MecThetaOffset,"aw",%nobits
 1184              		.align	2
 1185              		.set	.LANCHOR4,. + 0
 1188              	sg_MecThetaOffset:
 1189 0000 00000000 		.space	4
 1190              		.section	.bss.sg_curloop_param,"aw",%nobits
 1191              		.align	2
 1192              		.set	.LANCHOR8,. + 0
 1195              	sg_curloop_param:
 1196 0000 00000000 		.space	56
 1196      00000000 
 1196      00000000 
 1196      00000000 
 1196      00000000 
 1197              		.section	.bss.sg_elefilter,"aw",%nobits
 1198              		.align	2
 1199              		.set	.LANCHOR3,. + 0
 1202              	sg_elefilter:
 1203 0000 00000000 		.space	24
 1203      00000000 
 1203      00000000 
 1203      00000000 
 1203      00000000 
 1204              		.section	.bss.sg_motordebug,"aw",%nobits
 1205              		.align	2
 1206              		.set	.LANCHOR0,. + 0
 1209              	sg_motordebug:
 1210 0000 00000000 		.space	124
 1210      00000000 
 1210      00000000 
 1210      00000000 
 1210      00000000 
 1211              		.section	.bss.sgp_curloop_d_pid,"aw",%nobits
 1212              		.align	2
 1213              		.set	.LANCHOR1,. + 0
 1216              	sgp_curloop_d_pid:
 1217 0000 00000000 		.space	4
 1218              		.section	.bss.sgp_curloop_q_pid,"aw",%nobits
 1219              		.align	2
 1220              		.set	.LANCHOR2,. + 0
 1223              	sgp_curloop_q_pid:
 1224 0000 00000000 		.space	4
 1225              		.section	.bss.test_angletime,"aw",%nobits
 1226              		.align	2
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 34


 1227              		.set	.LANCHOR5,. + 0
 1230              	test_angletime:
 1231 0000 00000000 		.space	4
 1232              		.section	.bss.test_d_pid,"aw",%nobits
 1233              		.align	2
 1236              	test_d_pid:
 1237 0000 00000000 		.space	28
 1237      00000000 
 1237      00000000 
 1237      00000000 
 1237      00000000 
 1238              		.section	.bss.test_ia,"aw",%nobits
 1239              		.align	2
 1242              	test_ia:
 1243 0000 00000000 		.space	4
 1244              		.section	.bss.test_ib,"aw",%nobits
 1245              		.align	2
 1248              	test_ib:
 1249 0000 00000000 		.space	4
 1250              		.section	.bss.test_ic,"aw",%nobits
 1251              		.align	2
 1254              	test_ic:
 1255 0000 00000000 		.space	4
 1256              		.text
 1257              	.Letext0:
 1258              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 1259              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 1260              		.file 4 "../Common/method/pid.h"
 1261              		.file 5 "../Common/method/filter.h"
 1262              		.file 6 "../Common/IQMath/ti/IQmathLib.h"
 1263              		.file 7 "../BLDCMotor/motorctrl_common.h"
 1264              		.file 8 "../Common/Perf_counter/perf_counter.h"
 1265              		.file 9 "./Board/board.h"
 1266              		.file 10 "../Sensor/sensor.h"
 1267              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1268              		.file 12 "Inc/tim.h"
 1269              		.file 13 "Inc/adc.h"
 1270              		.file 14 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\math.h"
 1271              		.file 15 "../BLDCMotor/./motorctrl.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 35


DEFINED SYMBOLS
                            *ABS*:00000000 motorctrl.c
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:20     .text.sg_debug_clear:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:25     .text.sg_debug_clear:00000000 sg_debug_clear
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:46     .text.sg_debug_clear:0000000c $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:51     .text.motor_enable_noirq:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:56     .text.motor_enable_noirq:00000000 motor_enable_noirq
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:76     .text.motor_set_pwm:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:81     .text.motor_set_pwm:00000000 motor_set_pwm
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:110    .text._get_angleoffset:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:115    .text._get_angleoffset:00000000 _get_angleoffset
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:240    .text._get_angleoffset:0000008c $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:246    .text.motor_enable:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:251    .text.motor_enable:00000000 motor_enable
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:277    .text.motor_disable:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:282    .text.motor_disable:00000000 motor_disable
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:305    .text._currmentloop:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:310    .text._currmentloop:00000000 _currmentloop
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:475    .text._currmentloop:000000a8 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:484    .text._limit_voltagecircle:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:490    .text._limit_voltagecircle:00000000 _limit_voltagecircle
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:606    .text._50uscycle_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:612    .text._50uscycle_process:00000000 _50uscycle_process
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:899    .text._50uscycle_process:0000015c $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:915    .text.foc_paraminit:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:921    .text.foc_paraminit:00000000 foc_paraminit
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:995    .text.foc_paraminit:0000007c $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1006   .text.motortctrl_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1012   .text.motortctrl_process:00000000 motortctrl_process
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1038   .text.motortctrl_process:00000012 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1126   .text.motortctrl_process:00000070 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1169   .bss.per_eleangle:00000000 per_eleangle
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1230   .bss.test_angletime:00000000 test_angletime
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1254   .bss.test_ic:00000000 test_ic
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1248   .bss.test_ib:00000000 test_ib
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1242   .bss.test_ia:00000000 test_ia
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1181   .bss.raw_angle:00000000 raw_angle
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1162   .bss.next_angle_test:00000000 next_angle_test
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1175   .bss.pre_angle_test:00000000 pre_angle_test
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1236   .bss.test_d_pid:00000000 test_d_pid
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1156   .bss.g_Motor1:00000000 g_Motor1
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1209   .bss.sg_motordebug:00000000 sg_motordebug
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1144   .rodata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1152   .bss.g_Motor1:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1159   .bss.next_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1165   .bss.per_eleangle:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1172   .bss.pre_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1178   .bss.raw_angle:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1184   .bss.sg_MecThetaOffset:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1188   .bss.sg_MecThetaOffset:00000000 sg_MecThetaOffset
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1191   .bss.sg_curloop_param:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1195   .bss.sg_curloop_param:00000000 sg_curloop_param
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1198   .bss.sg_elefilter:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1202   .bss.sg_elefilter:00000000 sg_elefilter
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1205   .bss.sg_motordebug:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1212   .bss.sgp_curloop_d_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1216   .bss.sgp_curloop_d_pid:00000000 sgp_curloop_d_pid
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s 			page 36


C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1219   .bss.sgp_curloop_q_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1223   .bss.sgp_curloop_q_pid:00000000 sgp_curloop_q_pid
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1226   .bss.test_angletime:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1233   .bss.test_d_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1239   .bss.test_ia:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1245   .bss.test_ib:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1251   .bss.test_ic:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1043   .text.motortctrl_process:00000017 $d
C:\Users\57308\AppData\Local\Temp\ccDw6wKW.s:1043   .text.motortctrl_process:00000018 $t

UNDEFINED SYMBOLS
tim_pwm_enable
tim_set_pwm
_2r_2s
_svpwm
HAL_Delay
sensor_user_read
_IQ20toF
tim_tigger_adc
adc_start
tim_pwm_disable
adc_stop
_3s_2s
_2s_2r
pid_contrl
__aeabi_f2d
__aeabi_d2f
sqrt
lowfilter_cale
get_system_ticks
_normalize_angle
g_nOffset
pid_init
lowfilter_init
motorprotocol_process
