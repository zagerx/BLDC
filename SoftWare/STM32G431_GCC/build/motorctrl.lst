ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"motorctrl.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.motor_enable_noirq,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	motor_enable_noirq:
  26              	.LFB334:
  27              		.file 1 "../BLDCMotor/motorctrl.c"
   1:../BLDCMotor/motorctrl.c **** #include "./motorctrl.h"
   2:../BLDCMotor/motorctrl.c **** #include "debuglog.h"
   3:../BLDCMotor/motorctrl.c **** #include "motorctrl_common.h"
   4:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
   5:../BLDCMotor/motorctrl.c **** #include "mt6816.h"
   6:../BLDCMotor/motorctrl.c **** #endif
   7:../BLDCMotor/motorctrl.c **** #define Q15_PI_2                   (51471)
   8:../BLDCMotor/motorctrl.c **** #define Q15_2PI                    (205884)
   9:../BLDCMotor/motorctrl.c **** #define PI_2                       (1.570796f)
  10:../BLDCMotor/motorctrl.c **** #define MOTORCTRL_PERCI            (1)
  11:../BLDCMotor/motorctrl.c **** 
  12:../BLDCMotor/motorctrl.c **** enum{
  13:../BLDCMotor/motorctrl.c ****     MOTOR_INIT,
  14:../BLDCMotor/motorctrl.c ****     MOTOR_IDLE,
  15:../BLDCMotor/motorctrl.c ****     MOTOR_START, 
  16:../BLDCMotor/motorctrl.c ****     MOTOR_RUNING,
  17:../BLDCMotor/motorctrl.c ****     MOTOR_STOP,
  18:../BLDCMotor/motorctrl.c **** };
  19:../BLDCMotor/motorctrl.c **** typedef struct
  20:../BLDCMotor/motorctrl.c **** {
  21:../BLDCMotor/motorctrl.c ****     float ia;
  22:../BLDCMotor/motorctrl.c ****     float ib;
  23:../BLDCMotor/motorctrl.c ****     float ic;
  24:../BLDCMotor/motorctrl.c ****     float ialpha;
  25:../BLDCMotor/motorctrl.c ****     float ibeta;
  26:../BLDCMotor/motorctrl.c ****     float id;
  27:../BLDCMotor/motorctrl.c ****     float iq;
  28:../BLDCMotor/motorctrl.c **** 
  29:../BLDCMotor/motorctrl.c ****     int32_t Q_ia;
  30:../BLDCMotor/motorctrl.c ****     int32_t Q_ib;
  31:../BLDCMotor/motorctrl.c ****     int32_t Q_ic;
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 2


  32:../BLDCMotor/motorctrl.c ****     int32_t Q_ialpha;
  33:../BLDCMotor/motorctrl.c ****     int32_t Q_ibeta;
  34:../BLDCMotor/motorctrl.c ****     int32_t Q_id;
  35:../BLDCMotor/motorctrl.c ****     int32_t Q_iq;
  36:../BLDCMotor/motorctrl.c **** 
  37:../BLDCMotor/motorctrl.c ****     float id_real;
  38:../BLDCMotor/motorctrl.c ****     float iq_targe;
  39:../BLDCMotor/motorctrl.c ****     float iq_real;
  40:../BLDCMotor/motorctrl.c **** 
  41:../BLDCMotor/motorctrl.c ****     float pid_Q_out;
  42:../BLDCMotor/motorctrl.c ****     float pid_D_out;
  43:../BLDCMotor/motorctrl.c ****     float ele_angle;
  44:../BLDCMotor/motorctrl.c ****     float self_ele_theta;
  45:../BLDCMotor/motorctrl.c ****     int32_t Q_ele_angle;
  46:../BLDCMotor/motorctrl.c ****     int32_t Q15_mec_angle;
  47:../BLDCMotor/motorctrl.c **** }motordebug_t;
  48:../BLDCMotor/motorctrl.c **** motordebug_t sg_motordebug = {0};
  49:../BLDCMotor/motorctrl.c **** typedef struct
  50:../BLDCMotor/motorctrl.c **** {
  51:../BLDCMotor/motorctrl.c ****     unsigned char state;
  52:../BLDCMotor/motorctrl.c ****     unsigned short cnt;
  53:../BLDCMotor/motorctrl.c **** }motorctrl_t;
  54:../BLDCMotor/motorctrl.c **** 
  55:../BLDCMotor/motorctrl.c **** static dq_t _currmentloop(abc_t i_abc,float ele_theta);
  56:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void);
  57:../BLDCMotor/motorctrl.c **** static void motor_enable(void);
  58:../BLDCMotor/motorctrl.c **** static void motor_disable(void);
  59:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp);
  60:../BLDCMotor/motorctrl.c **** 
  61:../BLDCMotor/motorctrl.c **** motorctrl_t g_Motor1 = {
  62:../BLDCMotor/motorctrl.c ****     .state = MOTOR_INIT,
  63:../BLDCMotor/motorctrl.c ****     .cnt = 0,
  64:../BLDCMotor/motorctrl.c **** };
  65:../BLDCMotor/motorctrl.c **** static volatile float sg_MecThetaOffset = 0.0f;
  66:../BLDCMotor/motorctrl.c **** static lowfilter_t sg_elefilter[3];
  67:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_d_pid;
  68:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_q_pid;
  69:../BLDCMotor/motorctrl.c **** static curloop_t sg_curloop_param;
  70:../BLDCMotor/motorctrl.c **** float pre_angle_test = 0.0f;
  71:../BLDCMotor/motorctrl.c **** float next_angle_test = 0.0f;
  72:../BLDCMotor/motorctrl.c **** float raw_angle = 0.0f;
  73:../BLDCMotor/motorctrl.c **** float test_ia = 0.0f;
  74:../BLDCMotor/motorctrl.c **** float test_ib = 0.0f;
  75:../BLDCMotor/motorctrl.c **** float test_ic = 0.0f;
  76:../BLDCMotor/motorctrl.c **** extern float RTT_test_Id;
  77:../BLDCMotor/motorctrl.c **** void motortctrl_process(void)
  78:../BLDCMotor/motorctrl.c **** {
  79:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
  80:../BLDCMotor/motorctrl.c ****     {
  81:../BLDCMotor/motorctrl.c ****     case MOTOR_INIT:
  82:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
  83:../BLDCMotor/motorctrl.c ****         foc_paraminit();
  84:../BLDCMotor/motorctrl.c ****         USER_DEBUG_NORMAL("motor init\r\n");
  85:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
  86:../BLDCMotor/motorctrl.c ****         motor_enable();
  87:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
  88:../BLDCMotor/motorctrl.c ****         break;
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 3


  89:../BLDCMotor/motorctrl.c **** 
  90:../BLDCMotor/motorctrl.c ****     case MOTOR_RUNING:
  91:../BLDCMotor/motorctrl.c ****         {
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
  93:../BLDCMotor/motorctrl.c ****             {
  94:../BLDCMotor/motorctrl.c ****                 // USER_DEBUG_NORMAL("motor 1s\r\n");
  95:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_STOP;
  96:../BLDCMotor/motorctrl.c ****             }
  97:../BLDCMotor/motorctrl.c ****         }
  98:../BLDCMotor/motorctrl.c ****         break;
  99:../BLDCMotor/motorctrl.c **** 
 100:../BLDCMotor/motorctrl.c ****     case MOTOR_STOP:
 101:../BLDCMotor/motorctrl.c ****         motor_disable();
 102:../BLDCMotor/motorctrl.c ****         break;
 103:../BLDCMotor/motorctrl.c ****     default:
 104:../BLDCMotor/motorctrl.c ****         break;
 105:../BLDCMotor/motorctrl.c ****     }
 106:../BLDCMotor/motorctrl.c **** }
 107:../BLDCMotor/motorctrl.c **** /*------------周期性被调用----------------*/
 108:../BLDCMotor/motorctrl.c **** unsigned int test_val = 0;
 109:../BLDCMotor/motorctrl.c **** float cur_angle = 0.0f;
 110:../BLDCMotor/motorctrl.c **** float test_angle = 0.0f;
 111:../BLDCMotor/motorctrl.c **** void _50uscycle_process(unsigned int *abc_vale,float _elec_theta)
 112:../BLDCMotor/motorctrl.c **** {
 113:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431    
 114:../BLDCMotor/motorctrl.c ****     // static unsigned int cnt = 0;
 115:../BLDCMotor/motorctrl.c ****     // if (cnt++%3000)
 116:../BLDCMotor/motorctrl.c ****     // {
 117:../BLDCMotor/motorctrl.c ****     //     return;
 118:../BLDCMotor/motorctrl.c ****     // }
 119:../BLDCMotor/motorctrl.c **** #endif
 120:../BLDCMotor/motorctrl.c ****     test_val = 20;
 121:../BLDCMotor/motorctrl.c **** 
 122:../BLDCMotor/motorctrl.c ****     duty_t dut01,dut02;
 123:../BLDCMotor/motorctrl.c **** /*----------------三相电流处理------------------------------*/    
 124:../BLDCMotor/motorctrl.c ****     float Ia,Ib,Ic;
 125:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 126:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 127:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 128:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 129:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 130:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ib = b1;
 131:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ic = c1;    
 132:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)A_VOLITETOCURRENT_FACTOR;
 133:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 134:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 135:../BLDCMotor/motorctrl.c **** #if 1
 136:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 137:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 138:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 139:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 140:../BLDCMotor/motorctrl.c **** #else
 141:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 142:../BLDCMotor/motorctrl.c ****     i_abc.a = Ia;
 143:../BLDCMotor/motorctrl.c ****     i_abc.b = Ib;
 144:../BLDCMotor/motorctrl.c ****     i_abc.c = Ic;
 145:../BLDCMotor/motorctrl.c **** #endif
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 4


 146:../BLDCMotor/motorctrl.c **** 
 147:../BLDCMotor/motorctrl.c **** /*---------------------获取当前转子角度-------------------------*/
 148:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 149:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 150:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;
 151:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 152:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ15toF(Q15_Mechtheta);
 153:../BLDCMotor/motorctrl.c ****     raw_angle = mech_theta;
 154:../BLDCMotor/motorctrl.c ****     mech_theta = (mech_theta - sg_MecThetaOffset);
 155:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 156:../BLDCMotor/motorctrl.c ****     elec_theta += ANGLE_COMPENSATA;
 157:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 158:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 159:../BLDCMotor/motorctrl.c ****     // _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 160:../BLDCMotor/motorctrl.c ****     // _currmentloop(elec_theta);
 161:../BLDCMotor/motorctrl.c **** #endif
 162:../BLDCMotor/motorctrl.c **** 
 163:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 164:../BLDCMotor/motorctrl.c **** #if 0
 165:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 166:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;
 167:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 168:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ15toF(Q15_Mechtheta);
 169:../BLDCMotor/motorctrl.c ****     // test_angle = mech_theta;
 170:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 171:../BLDCMotor/motorctrl.c ****     test_angle = mech_theta;
 172:../BLDCMotor/motorctrl.c **** 
 173:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR  - 0.4f;
 174:../BLDCMotor/motorctrl.c ****     // elec_theta -= sg_MecThetaOffset;
 175:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 176:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 177:../BLDCMotor/motorctrl.c **** 
 178:../BLDCMotor/motorctrl.c ****     // _currmentloop(i_abc,elec_theta);
 179:../BLDCMotor/motorctrl.c ****     /*方法1*/
 180:../BLDCMotor/motorctrl.c ****     // mech_theta = mech_theta + _2PI - sg_MecThetaOffset;
 181:../BLDCMotor/motorctrl.c ****     // elec_theta = mech_theta * 2 - sg_MecThetaOffset/4.0f;
 182:../BLDCMotor/motorctrl.c ****     // elec_theta = _IQ15toF(_IQ15(elec_theta) % (Q15_2PI));
 183:../BLDCMotor/motorctrl.c ****     // sg_motordebug.ele_angle = elec_theta;
 184:../BLDCMotor/motorctrl.c **** 
 185:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 186:../BLDCMotor/motorctrl.c ****     alpbet_t uab,uab_q15;
 187:../BLDCMotor/motorctrl.c ****     if (sg_motordebug.self_ele_theta >= _2PI)
 188:../BLDCMotor/motorctrl.c ****     {
 189:../BLDCMotor/motorctrl.c ****         sg_motordebug.self_ele_theta -= _2PI;
 190:../BLDCMotor/motorctrl.c ****     }
 191:../BLDCMotor/motorctrl.c **** 
 192:../BLDCMotor/motorctrl.c ****     uab = _2r_2s(udq, sg_motordebug.self_ele_theta);cur_angle = sg_motordebug.self_ele_theta;
 193:../BLDCMotor/motorctrl.c ****     dut01 = _svpwm(uab.alpha,uab.beta);
 194:../BLDCMotor/motorctrl.c ****     motor_set_pwm(dut01);
 195:../BLDCMotor/motorctrl.c ****     sg_motordebug.self_ele_theta += 1.570796326f;
 196:../BLDCMotor/motorctrl.c **** #endif
 197:../BLDCMotor/motorctrl.c **** #endif
 198:../BLDCMotor/motorctrl.c **** /*--------------------------------------------------------------
 199:../BLDCMotor/motorctrl.c **** 开环控制
 200:../BLDCMotor/motorctrl.c **** 100us调用匹配参数  
 201:../BLDCMotor/motorctrl.c ****     42BLDC  theta += 0.004f;  uq = 1.0f
 202:../BLDCMotor/motorctrl.c ****     yateng  theta += 0.004f;  uq = 1.0f
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 5


 203:../BLDCMotor/motorctrl.c ****     qita    theta += 0.004f;  uq = 1.0f
 204:../BLDCMotor/motorctrl.c **** --------------------------------------------------------------*/
 205:../BLDCMotor/motorctrl.c ****     #if 1//强拖
 206:../BLDCMotor/motorctrl.c ****         {            
 207:../BLDCMotor/motorctrl.c ****             #ifdef BOARD_STM32H723
 208:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 209:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 210:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta > 6.28f)
 211:../BLDCMotor/motorctrl.c ****             {
 212:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta = 0.0f;
 213:../BLDCMotor/motorctrl.c ****             }
 214:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 215:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 216:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);            
 217:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += 0.001f;
 218:../BLDCMotor/motorctrl.c ****             #endif
 219:../BLDCMotor/motorctrl.c ****             #ifdef BOARD_STM32G431
 220:../BLDCMotor/motorctrl.c ****                 float elec_theta,mech_theta;
 221:../BLDCMotor/motorctrl.c ****                 int32_t Q15_Mechtheta;
 222:../BLDCMotor/motorctrl.c ****                 Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 223:../BLDCMotor/motorctrl.c ****                 mech_theta = _IQ15toF(Q15_Mechtheta);
 224:../BLDCMotor/motorctrl.c ****                 mech_theta += sg_MecThetaOffset/2.0f;
 225:../BLDCMotor/motorctrl.c ****                 elec_theta = mech_theta * MOTOR_PAIR;
 226:../BLDCMotor/motorctrl.c ****                 test_angle = elec_theta;
 227:../BLDCMotor/motorctrl.c ****                 elec_theta = fmod(elec_theta, _2PI);
 228:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta);
 229:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta+3.0f);
 230:../BLDCMotor/motorctrl.c ****                 sg_motordebug.ele_angle = elec_theta;
 231:../BLDCMotor/motorctrl.c ****                 /*方法1*/
 232:../BLDCMotor/motorctrl.c ****                 // mech_theta = mech_theta + _2PI - sg_MecThetaOffset;
 233:../BLDCMotor/motorctrl.c ****                 // elec_theta = mech_theta * 2 - sg_MecThetaOffset/4.0f;
 234:../BLDCMotor/motorctrl.c ****                 // elec_theta = _IQ15toF(_IQ15(elec_theta) % (Q15_2PI));
 235:../BLDCMotor/motorctrl.c ****                 // sg_motordebug.ele_angle = elec_theta;
 236:../BLDCMotor/motorctrl.c **** 
 237:../BLDCMotor/motorctrl.c ****                 dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 238:../BLDCMotor/motorctrl.c ****                 alpbet_t uab,uab_q15;
 239:../BLDCMotor/motorctrl.c ****                 if (sg_motordebug.self_ele_theta >= _2PI)
 240:../BLDCMotor/motorctrl.c ****                 {
 241:../BLDCMotor/motorctrl.c ****                     sg_motordebug.self_ele_theta -= _2PI;
 242:../BLDCMotor/motorctrl.c ****                 }
 243:../BLDCMotor/motorctrl.c **** 
 244:../BLDCMotor/motorctrl.c ****                 uab = _2r_2s(udq, elec_theta);  cur_angle = sg_motordebug.self_ele_theta;
 245:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 246:../BLDCMotor/motorctrl.c ****                 motor_set_pwm(dut01);
 247:../BLDCMotor/motorctrl.c ****                 _currmentloop(i_abc,elec_theta);
 248:../BLDCMotor/motorctrl.c ****                 // sg_motordebug.self_ele_theta += 1.570796326f;
 249:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += 0.001570796326f;
 250:../BLDCMotor/motorctrl.c **** 
 251:../BLDCMotor/motorctrl.c ****             #endif
 252:../BLDCMotor/motorctrl.c ****         }
 253:../BLDCMotor/motorctrl.c ****     #else //使用传感器
 254:../BLDCMotor/motorctrl.c ****     {
 255:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 256:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 257:../BLDCMotor/motorctrl.c ****         #if 1/*闭环控制*/
 258:../BLDCMotor/motorctrl.c ****             // udq = _currmentloop(i_abc,elec_theta);
 259:../BLDCMotor/motorctrl.c ****         #endif
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 6


 260:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 261:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 262:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 263:../BLDCMotor/motorctrl.c ****     }
 264:../BLDCMotor/motorctrl.c ****     #endif
 265:../BLDCMotor/motorctrl.c **** 
 266:../BLDCMotor/motorctrl.c ****     return;
 267:../BLDCMotor/motorctrl.c **** }
 268:../BLDCMotor/motorctrl.c **** void _limit_voltagecircle(uint32_t u_ref,uint32_t elec_theta)
 269:../BLDCMotor/motorctrl.c **** {
 270:../BLDCMotor/motorctrl.c ****     uint32_t u_alpha,u_beta;
 271:../BLDCMotor/motorctrl.c ****     u_alpha = u_ref * cosf(elec_theta);
 272:../BLDCMotor/motorctrl.c ****     u_beta = u_ref * sinf(elec_theta);
 273:../BLDCMotor/motorctrl.c **** }
 274:../BLDCMotor/motorctrl.c **** dq_t _currmentloop(abc_t i_abc,float ele_theta)
 275:../BLDCMotor/motorctrl.c **** {
 276:../BLDCMotor/motorctrl.c **** #if 0
 277:../BLDCMotor/motorctrl.c ****     /*--------------对电流进行反Clark变化-----------------------*/
 278:../BLDCMotor/motorctrl.c ****     alpbet_t i_alphbeta;
 279:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 280:../BLDCMotor/motorctrl.c ****     // i_abc.a = cosf(ele_theta);
 281:../BLDCMotor/motorctrl.c ****     // i_abc.b = cosf(ele_theta - _2PI/3.0f);
 282:../BLDCMotor/motorctrl.c ****     // i_abc.c = cosf(ele_theta + _2PI/3.0f);
 283:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 284:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 285:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 286:../BLDCMotor/motorctrl.c ****     i_abc.Q_a = _IQ15(i_abc.a);
 287:../BLDCMotor/motorctrl.c ****     i_abc.Q_b = _IQ15(i_abc.b);
 288:../BLDCMotor/motorctrl.c ****     i_abc.Q_c = _IQ15(i_abc.c);
 289:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = i_abc.Q_a;
 290:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ib = i_abc.Q_b;
 291:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ic = i_abc.Q_c;
 292:../BLDCMotor/motorctrl.c **** 
 293:../BLDCMotor/motorctrl.c ****     _3s_2s_Q(i_abc,&i_alphbeta);
 294:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ialpha = i_alphbeta.Q_alpha;
 295:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ibeta = i_alphbeta.Q_beta;
 296:../BLDCMotor/motorctrl.c **** 
 297:../BLDCMotor/motorctrl.c ****     /*-------------对电流进行反Park变换------------------------*/
 298:../BLDCMotor/motorctrl.c ****     _2s_2r_Q(i_alphbeta,(uint32_t)_IQ15((ele_theta - PI/2.0f)),&i_dq);
 299:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_id = (i_dq.Q_d);
 300:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_iq = (i_dq.Q_q);
 301:../BLDCMotor/motorctrl.c **** #else
 302:../BLDCMotor/motorctrl.c ****     alpbet_t i_alphbeta;
 303:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 304:../BLDCMotor/motorctrl.c ****     test_ia = cosf(ele_theta);
 305:../BLDCMotor/motorctrl.c ****     test_ib = cosf(ele_theta - _2PI/3.0f);
 306:../BLDCMotor/motorctrl.c ****     test_ic = cosf(ele_theta + _2PI/3.0f);
 307:../BLDCMotor/motorctrl.c **** 
 308:../BLDCMotor/motorctrl.c ****     // i_abc.a = test_ib;
 309:../BLDCMotor/motorctrl.c ****     // i_abc.b = test_ic;
 310:../BLDCMotor/motorctrl.c ****     // i_abc.c = test_ia;
 311:../BLDCMotor/motorctrl.c **** 
 312:../BLDCMotor/motorctrl.c ****     // i_abc.a = test_ia;
 313:../BLDCMotor/motorctrl.c ****     // i_abc.b = test_ib;
 314:../BLDCMotor/motorctrl.c ****     // i_abc.c = test_ic;
 315:../BLDCMotor/motorctrl.c **** 
 316:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 7


 317:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 318:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 319:../BLDCMotor/motorctrl.c **** 
 320:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 321:../BLDCMotor/motorctrl.c ****     i_abc.b = sg_motordebug.ic;
 322:../BLDCMotor/motorctrl.c ****     i_abc.c = sg_motordebug.ib;
 323:../BLDCMotor/motorctrl.c **** #endif    
 324:../BLDCMotor/motorctrl.c ****     _3s_2s(i_abc,&i_alphbeta);
 325:../BLDCMotor/motorctrl.c ****     sg_motordebug.ialpha = i_alphbeta.alpha;
 326:../BLDCMotor/motorctrl.c ****     sg_motordebug.ibeta = i_alphbeta.beta;    
 327:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta) - PI_2),&i_dq);
 328:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 329:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 330:../BLDCMotor/motorctrl.c **** 
 331:../BLDCMotor/motorctrl.c **** #if 1
 332:../BLDCMotor/motorctrl.c ****     dq_t udq;
 333:../BLDCMotor/motorctrl.c ****     udq.d =pid_contrl(sgp_curloop_d_pid,RTT_test_Id,i_dq.d);
 334:../BLDCMotor/motorctrl.c ****     udq.q = 0.9f;
 335:../BLDCMotor/motorctrl.c **** #endif
 336:../BLDCMotor/motorctrl.c ****     return udq;
 337:../BLDCMotor/motorctrl.c **** #endif
 338:../BLDCMotor/motorctrl.c **** }
 339:../BLDCMotor/motorctrl.c **** 
 340:../BLDCMotor/motorctrl.c **** static void motor_enable(void)
 341:../BLDCMotor/motorctrl.c **** {
 342:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 343:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 344:../BLDCMotor/motorctrl.c **** #endif
 345:../BLDCMotor/motorctrl.c ****     /*pwm 使能*/
 346:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
 347:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
 348:../BLDCMotor/motorctrl.c ****     adc_start();
 349:../BLDCMotor/motorctrl.c **** }
 350:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 351:../BLDCMotor/motorctrl.c **** {
  28              		.loc 1 351 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
 352:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 353:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 354:../BLDCMotor/motorctrl.c **** #endif    
 355:../BLDCMotor/motorctrl.c ****     /*pwm 使能*/
 356:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
  37              		.loc 1 356 5 view .LVU1
  38 0002 FFF7FEFF 		bl	tim_pwm_enable
  39              	.LVL0:
 357:../BLDCMotor/motorctrl.c **** }
  40              		.loc 1 357 1 is_stmt 0 view .LVU2
  41 0006 08BD     		pop	{r3, pc}
  42              		.cfi_endproc
  43              	.LFE334:
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 8


  45              		.section	.text.motor_set_pwm,"ax",%progbits
  46              		.align	1
  47              		.syntax unified
  48              		.thumb
  49              		.thumb_func
  51              	motor_set_pwm:
  52              	.LFB336:
 358:../BLDCMotor/motorctrl.c **** static void motor_disable(void)
 359:../BLDCMotor/motorctrl.c **** {
 360:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 361:../BLDCMotor/motorctrl.c ****     gpio_setmotor_powerdown();
 362:../BLDCMotor/motorctrl.c **** #endif    
 363:../BLDCMotor/motorctrl.c ****     tim_pwm_disable();
 364:../BLDCMotor/motorctrl.c ****     adc_stop();
 365:../BLDCMotor/motorctrl.c **** }
 366:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 367:../BLDCMotor/motorctrl.c **** {
  53              		.loc 1 367 1 is_stmt 1 view -0
  54              		.cfi_startproc
  55              		@ args = 0, pretend = 0, frame = 16
  56              		@ frame_needed = 0, uses_anonymous_args = 0
  57 0000 00B5     		push	{lr}
  58              	.LCFI1:
  59              		.cfi_def_cfa_offset 4
  60              		.cfi_offset 14, -4
  61 0002 85B0     		sub	sp, sp, #20
  62              	.LCFI2:
  63              		.cfi_def_cfa_offset 24
  64 0004 8DED010A 		vstr.32	s0, [sp, #4]
  65 0008 CDED020A 		vstr.32	s1, [sp, #8]
  66 000c 8DED031A 		vstr.32	s2, [sp, #12]
 368:../BLDCMotor/motorctrl.c ****     tim_set_pwm(temp._a,temp._b,temp._c);
  67              		.loc 1 368 5 view .LVU4
  68 0010 FFF7FEFF 		bl	tim_set_pwm
  69              	.LVL1:
 369:../BLDCMotor/motorctrl.c **** }
  70              		.loc 1 369 1 is_stmt 0 view .LVU5
  71 0014 05B0     		add	sp, sp, #20
  72              	.LCFI3:
  73              		.cfi_def_cfa_offset 4
  74              		@ sp needed
  75 0016 5DF804FB 		ldr	pc, [sp], #4
  76              		.cfi_endproc
  77              	.LFE336:
  79              		.section	.text.motor_enable,"ax",%progbits
  80              		.align	1
  81              		.syntax unified
  82              		.thumb
  83              		.thumb_func
  85              	motor_enable:
  86              	.LFB333:
 341:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
  87              		.loc 1 341 1 is_stmt 1 view -0
  88              		.cfi_startproc
  89              		@ args = 0, pretend = 0, frame = 0
  90              		@ frame_needed = 0, uses_anonymous_args = 0
  91 0000 08B5     		push	{r3, lr}
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 9


  92              	.LCFI4:
  93              		.cfi_def_cfa_offset 8
  94              		.cfi_offset 3, -8
  95              		.cfi_offset 14, -4
 346:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
  96              		.loc 1 346 5 view .LVU7
  97 0002 FFF7FEFF 		bl	tim_pwm_enable
  98              	.LVL2:
 347:../BLDCMotor/motorctrl.c ****     adc_start();
  99              		.loc 1 347 5 view .LVU8
 100 0006 FFF7FEFF 		bl	tim_tigger_adc
 101              	.LVL3:
 348:../BLDCMotor/motorctrl.c **** }
 102              		.loc 1 348 5 view .LVU9
 103 000a FFF7FEFF 		bl	adc_start
 104              	.LVL4:
 349:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 105              		.loc 1 349 1 is_stmt 0 view .LVU10
 106 000e 08BD     		pop	{r3, pc}
 107              		.cfi_endproc
 108              	.LFE333:
 110              		.section	.text.motor_disable,"ax",%progbits
 111              		.align	1
 112              		.syntax unified
 113              		.thumb
 114              		.thumb_func
 116              	motor_disable:
 117              	.LFB335:
 359:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 118              		.loc 1 359 1 is_stmt 1 view -0
 119              		.cfi_startproc
 120              		@ args = 0, pretend = 0, frame = 0
 121              		@ frame_needed = 0, uses_anonymous_args = 0
 122 0000 08B5     		push	{r3, lr}
 123              	.LCFI5:
 124              		.cfi_def_cfa_offset 8
 125              		.cfi_offset 3, -8
 126              		.cfi_offset 14, -4
 363:../BLDCMotor/motorctrl.c ****     adc_stop();
 127              		.loc 1 363 5 view .LVU12
 128 0002 FFF7FEFF 		bl	tim_pwm_disable
 129              	.LVL5:
 364:../BLDCMotor/motorctrl.c **** }
 130              		.loc 1 364 5 view .LVU13
 131 0006 FFF7FEFF 		bl	adc_stop
 132              	.LVL6:
 365:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 133              		.loc 1 365 1 is_stmt 0 view .LVU14
 134 000a 08BD     		pop	{r3, pc}
 135              		.cfi_endproc
 136              	.LFE335:
 138              		.section	.text._get_angleoffset,"ax",%progbits
 139              		.align	1
 140              		.syntax unified
 141              		.thumb
 142              		.thumb_func
 144              	_get_angleoffset:
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 10


 145              	.LFB337:
 370:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void)
 371:../BLDCMotor/motorctrl.c **** {
 146              		.loc 1 371 1 is_stmt 1 view -0
 147              		.cfi_startproc
 148              		@ args = 0, pretend = 0, frame = 32
 149              		@ frame_needed = 0, uses_anonymous_args = 0
 150 0000 30B5     		push	{r4, r5, lr}
 151              	.LCFI6:
 152              		.cfi_def_cfa_offset 12
 153              		.cfi_offset 4, -12
 154              		.cfi_offset 5, -8
 155              		.cfi_offset 14, -4
 156 0002 89B0     		sub	sp, sp, #36
 157              	.LCFI7:
 158              		.cfi_def_cfa_offset 48
 372:../BLDCMotor/motorctrl.c ****     motor_enable_noirq();
 159              		.loc 1 372 5 view .LVU16
 160 0004 FFF7FEFF 		bl	motor_enable_noirq
 161              	.LVL7:
 373:../BLDCMotor/motorctrl.c ****     /*-----------设置alpha/beta坐标系------------------*/
 374:../BLDCMotor/motorctrl.c ****     alpbet_t uab = {1.0f,0.0f};
 162              		.loc 1 374 5 view .LVU17
 163              		.loc 1 374 14 is_stmt 0 view .LVU18
 164 0008 0025     		movs	r5, #0
 165 000a 0495     		str	r5, [sp, #16]
 166 000c 0595     		str	r5, [sp, #20]
 167 000e 0695     		str	r5, [sp, #24]
 168 0010 0795     		str	r5, [sp, #28]
 169 0012 B7EE000A 		vmov.f32	s0, #1.0e+0
 170 0016 8DED040A 		vstr.32	s0, [sp, #16]
 375:../BLDCMotor/motorctrl.c ****     duty_t dut01;
 171              		.loc 1 375 5 is_stmt 1 view .LVU19
 376:../BLDCMotor/motorctrl.c ****     float theta;
 172              		.loc 1 376 5 view .LVU20
 377:../BLDCMotor/motorctrl.c **** 
 378:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32H723
 379:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 380:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 381:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 382:../BLDCMotor/motorctrl.c ****         tim_encode_writecnt(0);
 383:../BLDCMotor/motorctrl.c ****         theta = 0.0f;
 384:../BLDCMotor/motorctrl.c ****         motor_disable();
 385:../BLDCMotor/motorctrl.c ****         return theta;
 386:../BLDCMotor/motorctrl.c ****     #endif
 387:../BLDCMotor/motorctrl.c **** 
 388:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32G431
 389:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 173              		.loc 1 389 9 view .LVU21
 174              		.loc 1 389 17 is_stmt 0 view .LVU22
 175 001a DFED140A 		vldr.32	s1, .L13
 176 001e FFF7FEFF 		bl	_svpwm
 177              	.LVL8:
 178 0022 8DED010A 		vstr.32	s0, [sp, #4]
 179 0026 CDED020A 		vstr.32	s1, [sp, #8]
 180 002a 8DED031A 		vstr.32	s2, [sp, #12]
 390:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 11


 181              		.loc 1 390 9 is_stmt 1 view .LVU23
 182 002e FFF7FEFF 		bl	motor_set_pwm
 183              	.LVL9:
 391:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 184              		.loc 1 391 9 view .LVU24
 185 0032 4FF4FA70 		mov	r0, #500
 186 0036 FFF7FEFF 		bl	HAL_Delay
 187              	.LVL10:
 392:../BLDCMotor/motorctrl.c ****         motor_disable();
 188              		.loc 1 392 9 view .LVU25
 189 003a FFF7FEFF 		bl	motor_disable
 190              	.LVL11:
 393:../BLDCMotor/motorctrl.c ****         int32_t Q15_theta;
 191              		.loc 1 393 9 view .LVU26
 394:../BLDCMotor/motorctrl.c ****         int32_t Q_thetaSum = 0;
 192              		.loc 1 394 9 view .LVU27
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 193              		.loc 1 395 9 view .LVU28
 194              	.LBB2:
 195              		.loc 1 395 14 view .LVU29
 196              		.loc 1 395 22 is_stmt 0 view .LVU30
 197 003e 2C46     		mov	r4, r5
 198              		.loc 1 395 9 view .LVU31
 199 0040 07E0     		b	.L10
 200              	.LVL12:
 201              	.L11:
 396:../BLDCMotor/motorctrl.c ****         {
 397:../BLDCMotor/motorctrl.c ****             Q_thetaSum += ((int32_t*)(sensor_user_read(SENSOR_01,EN_SENSORDATA_COV)))[0];
 202              		.loc 1 397 13 is_stmt 1 discriminator 3 view .LVU32
 203              		.loc 1 397 39 is_stmt 0 discriminator 3 view .LVU33
 204 0042 0121     		movs	r1, #1
 205 0044 0020     		movs	r0, #0
 206 0046 FFF7FEFF 		bl	sensor_user_read
 207              	.LVL13:
 208              		.loc 1 397 86 discriminator 3 view .LVU34
 209 004a 0368     		ldr	r3, [r0]
 210              		.loc 1 397 24 discriminator 3 view .LVU35
 211 004c 1D44     		add	r5, r5, r3
 212              	.LVL14:
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 213              		.loc 1 395 37 is_stmt 1 discriminator 3 view .LVU36
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 214              		.loc 1 395 38 is_stmt 0 discriminator 3 view .LVU37
 215 004e 0134     		adds	r4, r4, #1
 216              	.LVL15:
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 217              		.loc 1 395 38 discriminator 3 view .LVU38
 218 0050 E4B2     		uxtb	r4, r4
 219              	.LVL16:
 220              	.L10:
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 221              		.loc 1 395 29 is_stmt 1 discriminator 1 view .LVU39
 395:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 222              		.loc 1 395 9 is_stmt 0 discriminator 1 view .LVU40
 223 0052 092C     		cmp	r4, #9
 224 0054 F5D9     		bls	.L11
 225              	.LBE2:
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 12


 398:../BLDCMotor/motorctrl.c ****         }
 399:../BLDCMotor/motorctrl.c ****         Q15_theta = Q_thetaSum/10;        
 226              		.loc 1 399 9 is_stmt 1 view .LVU41
 227              		.loc 1 399 19 is_stmt 0 view .LVU42
 228 0056 0648     		ldr	r0, .L13+4
 229 0058 80FB0530 		smull	r3, r0, r0, r5
 230 005c ED17     		asrs	r5, r5, #31
 231              	.LVL17:
 400:../BLDCMotor/motorctrl.c ****         theta = _IQ15toF(Q15_theta);
 232              		.loc 1 400 9 is_stmt 1 view .LVU43
 233              		.loc 1 400 17 is_stmt 0 view .LVU44
 234 005e C5EBA000 		rsb	r0, r5, r0, asr #2
 235              	.LVL18:
 236              		.loc 1 400 17 view .LVU45
 237 0062 FFF7FEFF 		bl	_IQ15toF
 238              	.LVL19:
 401:../BLDCMotor/motorctrl.c ****         return theta;
 239              		.loc 1 401 9 is_stmt 1 view .LVU46
 402:../BLDCMotor/motorctrl.c ****     #endif
 403:../BLDCMotor/motorctrl.c **** }
 240              		.loc 1 403 1 is_stmt 0 view .LVU47
 241 0066 09B0     		add	sp, sp, #36
 242              	.LCFI8:
 243              		.cfi_def_cfa_offset 12
 244              		@ sp needed
 245 0068 30BD     		pop	{r4, r5, pc}
 246              	.LVL20:
 247              	.L14:
 248              		.loc 1 403 1 view .LVU48
 249 006a 00BF     		.align	2
 250              	.L13:
 251 006c 00000000 		.word	0
 252 0070 67666666 		.word	1717986919
 253              		.cfi_endproc
 254              	.LFE337:
 256              		.section	.text._currmentloop,"ax",%progbits
 257              		.align	1
 258              		.syntax unified
 259              		.thumb
 260              		.thumb_func
 262              	_currmentloop:
 263              	.LVL21:
 264              	.LFB332:
 275:../BLDCMotor/motorctrl.c **** #if 0
 265              		.loc 1 275 1 is_stmt 1 view -0
 266              		.cfi_startproc
 267              		@ args = 28, pretend = 16, frame = 32
 268              		@ frame_needed = 0, uses_anonymous_args = 0
 275:../BLDCMotor/motorctrl.c **** #if 0
 269              		.loc 1 275 1 is_stmt 0 view .LVU50
 270 0000 84B0     		sub	sp, sp, #16
 271              	.LCFI9:
 272              		.cfi_def_cfa_offset 16
 273 0002 F0B5     		push	{r4, r5, r6, r7, lr}
 274              	.LCFI10:
 275              		.cfi_def_cfa_offset 36
 276              		.cfi_offset 4, -36
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 13


 277              		.cfi_offset 5, -32
 278              		.cfi_offset 6, -28
 279              		.cfi_offset 7, -24
 280              		.cfi_offset 14, -20
 281 0004 2DED028B 		vpush.64	{d8}
 282              	.LCFI11:
 283              		.cfi_def_cfa_offset 44
 284              		.cfi_offset 80, -44
 285              		.cfi_offset 81, -40
 286 0008 8DB0     		sub	sp, sp, #52
 287              	.LCFI12:
 288              		.cfi_def_cfa_offset 96
 289 000a 0646     		mov	r6, r0
 290 000c 15AD     		add	r5, sp, #84
 291 000e 85E80E00 		stm	r5, {r1, r2, r3}
 292 0012 B0EE408A 		vmov.f32	s16, s0
 302:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 293              		.loc 1 302 5 is_stmt 1 view .LVU51
 303:../BLDCMotor/motorctrl.c ****     test_ia = cosf(ele_theta);
 294              		.loc 1 303 5 view .LVU52
 304:../BLDCMotor/motorctrl.c ****     test_ib = cosf(ele_theta - _2PI/3.0f);
 295              		.loc 1 304 5 view .LVU53
 304:../BLDCMotor/motorctrl.c ****     test_ib = cosf(ele_theta - _2PI/3.0f);
 296              		.loc 1 304 15 is_stmt 0 view .LVU54
 297 0016 FFF7FEFF 		bl	cosf
 298              	.LVL22:
 304:../BLDCMotor/motorctrl.c ****     test_ib = cosf(ele_theta - _2PI/3.0f);
 299              		.loc 1 304 13 view .LVU55
 300 001a 274B     		ldr	r3, .L17
 301 001c 83ED000A 		vstr.32	s0, [r3]
 305:../BLDCMotor/motorctrl.c ****     test_ic = cosf(ele_theta + _2PI/3.0f);
 302              		.loc 1 305 5 is_stmt 1 view .LVU56
 305:../BLDCMotor/motorctrl.c ****     test_ic = cosf(ele_theta + _2PI/3.0f);
 303              		.loc 1 305 15 is_stmt 0 view .LVU57
 304 0020 DFED268A 		vldr.32	s17, .L17+4
 305 0024 38EE680A 		vsub.f32	s0, s16, s17
 306 0028 FFF7FEFF 		bl	cosf
 307              	.LVL23:
 305:../BLDCMotor/motorctrl.c ****     test_ic = cosf(ele_theta + _2PI/3.0f);
 308              		.loc 1 305 13 view .LVU58
 309 002c 244B     		ldr	r3, .L17+8
 310 002e 83ED000A 		vstr.32	s0, [r3]
 306:../BLDCMotor/motorctrl.c **** 
 311              		.loc 1 306 5 is_stmt 1 view .LVU59
 306:../BLDCMotor/motorctrl.c **** 
 312              		.loc 1 306 15 is_stmt 0 view .LVU60
 313 0032 38EE280A 		vadd.f32	s0, s16, s17
 314 0036 FFF7FEFF 		bl	cosf
 315              	.LVL24:
 306:../BLDCMotor/motorctrl.c **** 
 316              		.loc 1 306 13 view .LVU61
 317 003a 224B     		ldr	r3, .L17+12
 318 003c 83ED000A 		vstr.32	s0, [r3]
 316:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 319              		.loc 1 316 5 is_stmt 1 view .LVU62
 316:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 320              		.loc 1 316 22 is_stmt 0 view .LVU63
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 14


 321 0040 214C     		ldr	r4, .L17+16
 322 0042 159B     		ldr	r3, [sp, #84]	@ float
 323 0044 2360     		str	r3, [r4]	@ float
 317:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 324              		.loc 1 317 5 is_stmt 1 view .LVU64
 317:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 325              		.loc 1 317 29 is_stmt 0 view .LVU65
 326 0046 169B     		ldr	r3, [sp, #88]	@ float
 317:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 327              		.loc 1 317 22 view .LVU66
 328 0048 6360     		str	r3, [r4, #4]	@ float
 318:../BLDCMotor/motorctrl.c **** 
 329              		.loc 1 318 5 is_stmt 1 view .LVU67
 318:../BLDCMotor/motorctrl.c **** 
 330              		.loc 1 318 29 is_stmt 0 view .LVU68
 331 004a 179A     		ldr	r2, [sp, #92]	@ float
 318:../BLDCMotor/motorctrl.c **** 
 332              		.loc 1 318 22 view .LVU69
 333 004c A260     		str	r2, [r4, #8]	@ float
 321:../BLDCMotor/motorctrl.c ****     i_abc.c = sg_motordebug.ib;
 334              		.loc 1 321 5 is_stmt 1 view .LVU70
 321:../BLDCMotor/motorctrl.c ****     i_abc.c = sg_motordebug.ib;
 335              		.loc 1 321 13 is_stmt 0 view .LVU71
 336 004e 1692     		str	r2, [sp, #88]	@ float
 322:../BLDCMotor/motorctrl.c **** #endif    
 337              		.loc 1 322 5 is_stmt 1 view .LVU72
 322:../BLDCMotor/motorctrl.c **** #endif    
 338              		.loc 1 322 13 is_stmt 0 view .LVU73
 339 0050 1793     		str	r3, [sp, #92]	@ float
 324:../BLDCMotor/motorctrl.c ****     sg_motordebug.ialpha = i_alphbeta.alpha;
 340              		.loc 1 324 5 is_stmt 1 view .LVU74
 341 0052 08AF     		add	r7, sp, #32
 342 0054 0297     		str	r7, [sp, #8]
 343 0056 19AB     		add	r3, sp, #100
 344 0058 93E80300 		ldm	r3, {r0, r1}
 345 005c 8DE80300 		stm	sp, {r0, r1}
 346 0060 95E80F00 		ldm	r5, {r0, r1, r2, r3}
 347 0064 FFF7FEFF 		bl	_3s_2s
 348              	.LVL25:
 325:../BLDCMotor/motorctrl.c ****     sg_motordebug.ibeta = i_alphbeta.beta;    
 349              		.loc 1 325 5 view .LVU75
 325:../BLDCMotor/motorctrl.c ****     sg_motordebug.ibeta = i_alphbeta.beta;    
 350              		.loc 1 325 38 is_stmt 0 view .LVU76
 351 0068 089B     		ldr	r3, [sp, #32]	@ float
 325:../BLDCMotor/motorctrl.c ****     sg_motordebug.ibeta = i_alphbeta.beta;    
 352              		.loc 1 325 26 view .LVU77
 353 006a E360     		str	r3, [r4, #12]	@ float
 326:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta) - PI_2),&i_dq);
 354              		.loc 1 326 5 is_stmt 1 view .LVU78
 326:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta) - PI_2),&i_dq);
 355              		.loc 1 326 37 is_stmt 0 view .LVU79
 356 006c 099B     		ldr	r3, [sp, #36]	@ float
 326:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta) - PI_2),&i_dq);
 357              		.loc 1 326 25 view .LVU80
 358 006e 2361     		str	r3, [r4, #16]	@ float
 327:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 359              		.loc 1 327 5 is_stmt 1 view .LVU81
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 15


 360 0070 04AB     		add	r3, sp, #16
 361 0072 0093     		str	r3, [sp]
 362 0074 9FED150A 		vldr.32	s0, .L17+20
 363 0078 38EE400A 		vsub.f32	s0, s16, s0
 364 007c 97E80F00 		ldm	r7, {r0, r1, r2, r3}
 365 0080 FFF7FEFF 		bl	_2s_2r
 366              	.LVL26:
 328:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 367              		.loc 1 328 5 view .LVU82
 328:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 368              		.loc 1 328 29 is_stmt 0 view .LVU83
 369 0084 DDED040A 		vldr.32	s1, [sp, #16]
 328:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 370              		.loc 1 328 22 view .LVU84
 371 0088 C4ED050A 		vstr.32	s1, [r4, #20]
 329:../BLDCMotor/motorctrl.c **** 
 372              		.loc 1 329 5 is_stmt 1 view .LVU85
 329:../BLDCMotor/motorctrl.c **** 
 373              		.loc 1 329 29 is_stmt 0 view .LVU86
 374 008c 059B     		ldr	r3, [sp, #20]	@ float
 329:../BLDCMotor/motorctrl.c **** 
 375              		.loc 1 329 22 view .LVU87
 376 008e A361     		str	r3, [r4, #24]	@ float
 332:../BLDCMotor/motorctrl.c ****     udq.d =pid_contrl(sgp_curloop_d_pid,RTT_test_Id,i_dq.d);
 377              		.loc 1 332 5 is_stmt 1 view .LVU88
 333:../BLDCMotor/motorctrl.c ****     udq.q = 0.9f;
 378              		.loc 1 333 5 view .LVU89
 333:../BLDCMotor/motorctrl.c ****     udq.q = 0.9f;
 379              		.loc 1 333 12 is_stmt 0 view .LVU90
 380 0090 0F4B     		ldr	r3, .L17+24
 381 0092 93ED000A 		vldr.32	s0, [r3]
 382 0096 0F4B     		ldr	r3, .L17+28
 383 0098 1868     		ldr	r0, [r3]
 384 009a FFF7FEFF 		bl	pid_contrl
 385              	.LVL27:
 333:../BLDCMotor/motorctrl.c ****     udq.q = 0.9f;
 386              		.loc 1 333 11 view .LVU91
 387 009e 86ED000A 		vstr.32	s0, [r6]
 334:../BLDCMotor/motorctrl.c **** #endif
 388              		.loc 1 334 5 is_stmt 1 view .LVU92
 334:../BLDCMotor/motorctrl.c **** #endif
 389              		.loc 1 334 11 is_stmt 0 view .LVU93
 390 00a2 0D4B     		ldr	r3, .L17+32
 391 00a4 7360     		str	r3, [r6, #4]	@ float
 336:../BLDCMotor/motorctrl.c **** #endif
 392              		.loc 1 336 5 is_stmt 1 view .LVU94
 338:../BLDCMotor/motorctrl.c **** 
 393              		.loc 1 338 1 is_stmt 0 view .LVU95
 394 00a6 3046     		mov	r0, r6
 395 00a8 0DB0     		add	sp, sp, #52
 396              	.LCFI13:
 397              		.cfi_def_cfa_offset 44
 398              		@ sp needed
 399 00aa BDEC028B 		vldm	sp!, {d8}
 400              	.LCFI14:
 401              		.cfi_restore 80
 402              		.cfi_restore 81
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 16


 403              		.cfi_def_cfa_offset 36
 404              	.LVL28:
 338:../BLDCMotor/motorctrl.c **** 
 405              		.loc 1 338 1 view .LVU96
 406 00ae BDE8F040 		pop	{r4, r5, r6, r7, lr}
 407              	.LCFI15:
 408              		.cfi_restore 14
 409              		.cfi_restore 7
 410              		.cfi_restore 6
 411              		.cfi_restore 5
 412              		.cfi_restore 4
 413              		.cfi_def_cfa_offset 16
 414              	.LVL29:
 338:../BLDCMotor/motorctrl.c **** 
 415              		.loc 1 338 1 view .LVU97
 416 00b2 04B0     		add	sp, sp, #16
 417              	.LCFI16:
 418              		.cfi_def_cfa_offset 0
 419 00b4 7047     		bx	lr
 420              	.L18:
 421 00b6 00BF     		.align	2
 422              	.L17:
 423 00b8 00000000 		.word	.LANCHOR0
 424 00bc 910A0640 		.word	1074137745
 425 00c0 00000000 		.word	.LANCHOR1
 426 00c4 00000000 		.word	.LANCHOR2
 427 00c8 00000000 		.word	.LANCHOR3
 428 00cc D80FC93F 		.word	1070141400
 429 00d0 00000000 		.word	RTT_test_Id
 430 00d4 00000000 		.word	.LANCHOR4
 431 00d8 6666663F 		.word	1063675494
 432              		.cfi_endproc
 433              	.LFE332:
 435              		.global	__aeabi_f2d
 436              		.global	__aeabi_d2f
 437              		.section	.text._50uscycle_process,"ax",%progbits
 438              		.align	1
 439              		.global	_50uscycle_process
 440              		.syntax unified
 441              		.thumb
 442              		.thumb_func
 444              	_50uscycle_process:
 445              	.LVL30:
 446              	.LFB330:
 112:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431    
 447              		.loc 1 112 1 is_stmt 1 view -0
 448              		.cfi_startproc
 449              		@ args = 0, pretend = 0, frame = 88
 450              		@ frame_needed = 0, uses_anonymous_args = 0
 112:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431    
 451              		.loc 1 112 1 is_stmt 0 view .LVU99
 452 0000 30B5     		push	{r4, r5, lr}
 453              	.LCFI17:
 454              		.cfi_def_cfa_offset 12
 455              		.cfi_offset 4, -12
 456              		.cfi_offset 5, -8
 457              		.cfi_offset 14, -4
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 17


 458 0002 2DED028B 		vpush.64	{d8}
 459              	.LCFI18:
 460              		.cfi_def_cfa_offset 20
 461              		.cfi_offset 80, -20
 462              		.cfi_offset 81, -16
 463 0006 9BB0     		sub	sp, sp, #108
 464              	.LCFI19:
 465              		.cfi_def_cfa_offset 128
 120:../BLDCMotor/motorctrl.c **** 
 466              		.loc 1 120 5 is_stmt 1 view .LVU100
 120:../BLDCMotor/motorctrl.c **** 
 467              		.loc 1 120 14 is_stmt 0 view .LVU101
 468 0008 574B     		ldr	r3, .L24+8
 469 000a 1422     		movs	r2, #20
 470 000c 1A60     		str	r2, [r3]
 122:../BLDCMotor/motorctrl.c **** /*----------------三相电流处理------------------------------*/    
 471              		.loc 1 122 5 is_stmt 1 view .LVU102
 124:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 472              		.loc 1 124 5 view .LVU103
 125:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 473              		.loc 1 125 5 view .LVU104
 126:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 474              		.loc 1 126 5 view .LVU105
 126:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 475              		.loc 1 126 18 is_stmt 0 view .LVU106
 476 000e 0168     		ldr	r1, [r0]
 126:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 477              		.loc 1 126 22 view .LVU107
 478 0010 A1F63401 		subw	r1, r1, #2100
 479              	.LVL31:
 127:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 480              		.loc 1 127 5 is_stmt 1 view .LVU108
 127:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 481              		.loc 1 127 18 is_stmt 0 view .LVU109
 482 0014 4268     		ldr	r2, [r0, #4]
 127:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 483              		.loc 1 127 22 view .LVU110
 484 0016 A2F66602 		subw	r2, r2, #2150
 485              	.LVL32:
 128:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 486              		.loc 1 128 5 is_stmt 1 view .LVU111
 128:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 487              		.loc 1 128 18 is_stmt 0 view .LVU112
 488 001a 8368     		ldr	r3, [r0, #8]
 128:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 489              		.loc 1 128 22 view .LVU113
 490 001c A3F66603 		subw	r3, r3, #2150
 491              	.LVL33:
 129:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ib = b1;
 492              		.loc 1 129 5 is_stmt 1 view .LVU114
 129:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ib = b1;
 493              		.loc 1 129 24 is_stmt 0 view .LVU115
 494 0020 524C     		ldr	r4, .L24+12
 495 0022 E161     		str	r1, [r4, #28]
 130:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ic = c1;    
 496              		.loc 1 130 5 is_stmt 1 view .LVU116
 130:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ic = c1;    
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 18


 497              		.loc 1 130 24 is_stmt 0 view .LVU117
 498 0024 2262     		str	r2, [r4, #32]
 131:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)A_VOLITETOCURRENT_FACTOR;
 499              		.loc 1 131 5 is_stmt 1 view .LVU118
 131:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)A_VOLITETOCURRENT_FACTOR;
 500              		.loc 1 131 24 is_stmt 0 view .LVU119
 501 0026 6362     		str	r3, [r4, #36]
 132:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 502              		.loc 1 132 5 is_stmt 1 view .LVU120
 132:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 503              		.loc 1 132 10 is_stmt 0 view .LVU121
 504 0028 07EE901A 		vmov	s15, r1	@ int
 505 002c B8EEE70A 		vcvt.f32.s32	s0, s15
 506              	.LVL34:
 133:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 507              		.loc 1 133 5 is_stmt 1 view .LVU122
 133:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 508              		.loc 1 133 10 is_stmt 0 view .LVU123
 509 0030 07EE902A 		vmov	s15, r2	@ int
 510 0034 F8EEE78A 		vcvt.f32.s32	s17, s15
 133:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 511              		.loc 1 133 8 view .LVU124
 512 0038 DFED4D7A 		vldr.32	s15, .L24+16
 513 003c 68EEA78A 		vmul.f32	s17, s17, s15
 514              	.LVL35:
 134:../BLDCMotor/motorctrl.c **** #if 1
 515              		.loc 1 134 5 is_stmt 1 view .LVU125
 134:../BLDCMotor/motorctrl.c **** #if 1
 516              		.loc 1 134 10 is_stmt 0 view .LVU126
 517 0040 07EE903A 		vmov	s15, r3	@ int
 518 0044 B8EEE78A 		vcvt.f32.s32	s16, s15
 134:../BLDCMotor/motorctrl.c **** #if 1
 519              		.loc 1 134 8 view .LVU127
 520 0048 DFED4A7A 		vldr.32	s15, .L24+20
 521 004c 28EE278A 		vmul.f32	s16, s16, s15
 522              	.LVL36:
 136:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 523              		.loc 1 136 5 is_stmt 1 view .LVU128
 137:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 524              		.loc 1 137 5 view .LVU129
 137:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 525              		.loc 1 137 15 is_stmt 0 view .LVU130
 526 0050 494D     		ldr	r5, .L24+24
 527 0052 DFED4A7A 		vldr.32	s15, .L24+28
 528 0056 20EE270A 		vmul.f32	s0, s0, s15
 529              	.LVL37:
 137:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 530              		.loc 1 137 15 view .LVU131
 531 005a 2846     		mov	r0, r5
 532              	.LVL38:
 137:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 533              		.loc 1 137 15 view .LVU132
 534 005c FFF7FEFF 		bl	lowfilter_cale
 535              	.LVL39:
 137:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 536              		.loc 1 137 13 view .LVU133
 537 0060 8DED110A 		vstr.32	s0, [sp, #68]
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 19


 138:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 538              		.loc 1 138 5 is_stmt 1 view .LVU134
 138:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 539              		.loc 1 138 15 is_stmt 0 view .LVU135
 540 0064 B0EE680A 		vmov.f32	s0, s17
 541 0068 05F10800 		add	r0, r5, #8
 542 006c FFF7FEFF 		bl	lowfilter_cale
 543              	.LVL40:
 138:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 544              		.loc 1 138 13 view .LVU136
 545 0070 8DED120A 		vstr.32	s0, [sp, #72]
 139:../BLDCMotor/motorctrl.c **** #else
 546              		.loc 1 139 5 is_stmt 1 view .LVU137
 139:../BLDCMotor/motorctrl.c **** #else
 547              		.loc 1 139 15 is_stmt 0 view .LVU138
 548 0074 B0EE480A 		vmov.f32	s0, s16
 549 0078 05F11000 		add	r0, r5, #16
 550 007c FFF7FEFF 		bl	lowfilter_cale
 551              	.LVL41:
 139:../BLDCMotor/motorctrl.c **** #else
 552              		.loc 1 139 13 view .LVU139
 553 0080 8DED130A 		vstr.32	s0, [sp, #76]
 554              	.LBB3:
 220:../BLDCMotor/motorctrl.c ****                 int32_t Q15_Mechtheta;
 555              		.loc 1 220 17 is_stmt 1 view .LVU140
 221:../BLDCMotor/motorctrl.c ****                 Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 556              		.loc 1 221 17 view .LVU141
 222:../BLDCMotor/motorctrl.c ****                 mech_theta = _IQ15toF(Q15_Mechtheta);
 557              		.loc 1 222 17 view .LVU142
 222:../BLDCMotor/motorctrl.c ****                 mech_theta = _IQ15toF(Q15_Mechtheta);
 558              		.loc 1 222 44 is_stmt 0 view .LVU143
 559 0084 0121     		movs	r1, #1
 560 0086 0020     		movs	r0, #0
 561 0088 FFF7FEFF 		bl	sensor_user_read
 562              	.LVL42:
 223:../BLDCMotor/motorctrl.c ****                 mech_theta += sg_MecThetaOffset/2.0f;
 563              		.loc 1 223 17 is_stmt 1 view .LVU144
 223:../BLDCMotor/motorctrl.c ****                 mech_theta += sg_MecThetaOffset/2.0f;
 564              		.loc 1 223 30 is_stmt 0 view .LVU145
 565 008c 0068     		ldr	r0, [r0]
 566              	.LVL43:
 223:../BLDCMotor/motorctrl.c ****                 mech_theta += sg_MecThetaOffset/2.0f;
 567              		.loc 1 223 30 view .LVU146
 568 008e FFF7FEFF 		bl	_IQ15toF
 569              	.LVL44:
 224:../BLDCMotor/motorctrl.c ****                 elec_theta = mech_theta * MOTOR_PAIR;
 570              		.loc 1 224 17 is_stmt 1 view .LVU147
 224:../BLDCMotor/motorctrl.c ****                 elec_theta = mech_theta * MOTOR_PAIR;
 571              		.loc 1 224 48 is_stmt 0 view .LVU148
 572 0092 3B4B     		ldr	r3, .L24+32
 573 0094 D3ED007A 		vldr.32	s15, [r3]
 574 0098 B6EE007A 		vmov.f32	s14, #5.0e-1
 575 009c 67EE877A 		vmul.f32	s15, s15, s14
 224:../BLDCMotor/motorctrl.c ****                 elec_theta = mech_theta * MOTOR_PAIR;
 576              		.loc 1 224 28 view .LVU149
 577 00a0 30EE270A 		vadd.f32	s0, s0, s15
 578              	.LVL45:
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 20


 225:../BLDCMotor/motorctrl.c ****                 test_angle = elec_theta;
 579              		.loc 1 225 17 is_stmt 1 view .LVU150
 225:../BLDCMotor/motorctrl.c ****                 test_angle = elec_theta;
 580              		.loc 1 225 28 is_stmt 0 view .LVU151
 581 00a4 30EE000A 		vadd.f32	s0, s0, s0
 582              	.LVL46:
 226:../BLDCMotor/motorctrl.c ****                 elec_theta = fmod(elec_theta, _2PI);
 583              		.loc 1 226 17 is_stmt 1 view .LVU152
 226:../BLDCMotor/motorctrl.c ****                 elec_theta = fmod(elec_theta, _2PI);
 584              		.loc 1 226 28 is_stmt 0 view .LVU153
 585 00a8 364B     		ldr	r3, .L24+36
 586 00aa 83ED000A 		vstr.32	s0, [r3]
 227:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta);
 587              		.loc 1 227 17 is_stmt 1 view .LVU154
 227:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta);
 588              		.loc 1 227 30 is_stmt 0 view .LVU155
 589 00ae 10EE100A 		vmov	r0, s0
 590 00b2 FFF7FEFF 		bl	__aeabi_f2d
 591              	.LVL47:
 227:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta);
 592              		.loc 1 227 30 view .LVU156
 593 00b6 9FED2A1B 		vldr.64	d1, .L24
 594 00ba 41EC100B 		vmov	d0, r0, r1
 595 00be FFF7FEFF 		bl	fmod
 596              	.LVL48:
 597 00c2 51EC100B 		vmov	r0, r1, d0
 227:../BLDCMotor/motorctrl.c ****                 // elec_theta = _normalize_angle(elec_theta);
 598              		.loc 1 227 28 view .LVU157
 599 00c6 FFF7FEFF 		bl	__aeabi_d2f
 600              	.LVL49:
 601 00ca 08EE100A 		vmov	s16, r0
 602              	.LVL50:
 230:../BLDCMotor/motorctrl.c ****                 /*方法1*/
 603              		.loc 1 230 17 is_stmt 1 view .LVU158
 230:../BLDCMotor/motorctrl.c ****                 /*方法1*/
 604              		.loc 1 230 41 is_stmt 0 view .LVU159
 605 00ce E064     		str	r0, [r4, #76]	@ float
 237:../BLDCMotor/motorctrl.c ****                 alpbet_t uab,uab_q15;
 606              		.loc 1 237 17 is_stmt 1 view .LVU160
 237:../BLDCMotor/motorctrl.c ****                 alpbet_t uab,uab_q15;
 607              		.loc 1 237 22 is_stmt 0 view .LVU161
 608 00d0 2D4B     		ldr	r3, .L24+40
 609 00d2 0DF1240C 		add	ip, sp, #36
 610 00d6 0FCB     		ldm	r3, {r0, r1, r2, r3}
 611              	.LVL51:
 237:../BLDCMotor/motorctrl.c ****                 alpbet_t uab,uab_q15;
 612              		.loc 1 237 22 view .LVU162
 613 00d8 8CE80F00 		stm	ip, {r0, r1, r2, r3}
 238:../BLDCMotor/motorctrl.c ****                 if (sg_motordebug.self_ele_theta >= _2PI)
 614              		.loc 1 238 17 is_stmt 1 view .LVU163
 239:../BLDCMotor/motorctrl.c ****                 {
 615              		.loc 1 239 17 view .LVU164
 239:../BLDCMotor/motorctrl.c ****                 {
 616              		.loc 1 239 34 is_stmt 0 view .LVU165
 617 00dc D4ED147A 		vldr.32	s15, [r4, #80]
 239:../BLDCMotor/motorctrl.c ****                 {
 618              		.loc 1 239 20 view .LVU166
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 21


 619 00e0 9FED2A7A 		vldr.32	s14, .L24+44
 620 00e4 F4EEC77A 		vcmpe.f32	s15, s14
 621 00e8 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 622 00ec 03DB     		blt	.L20
 241:../BLDCMotor/motorctrl.c ****                 }
 623              		.loc 1 241 21 is_stmt 1 view .LVU167
 241:../BLDCMotor/motorctrl.c ****                 }
 624              		.loc 1 241 50 is_stmt 0 view .LVU168
 625 00ee 77EEC77A 		vsub.f32	s15, s15, s14
 626 00f2 C4ED147A 		vstr.32	s15, [r4, #80]
 627              	.L20:
 244:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 628              		.loc 1 244 17 is_stmt 1 view .LVU169
 244:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 629              		.loc 1 244 23 is_stmt 0 view .LVU170
 630 00f6 0C9B     		ldr	r3, [sp, #48]
 631 00f8 0093     		str	r3, [sp]
 632 00fa 09AB     		add	r3, sp, #36
 633 00fc 0ECB     		ldm	r3, {r1, r2, r3}
 634 00fe B0EE480A 		vmov.f32	s0, s16
 635 0102 0DA8     		add	r0, sp, #52
 636 0104 FFF7FEFF 		bl	_2r_2s
 637              	.LVL52:
 244:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 638              		.loc 1 244 49 is_stmt 1 view .LVU171
 244:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 639              		.loc 1 244 74 is_stmt 0 view .LVU172
 640 0108 184C     		ldr	r4, .L24+12
 641 010a 226D     		ldr	r2, [r4, #80]	@ float
 244:../BLDCMotor/motorctrl.c ****                 dut01 = _svpwm(uab.alpha,uab.beta);
 642              		.loc 1 244 59 view .LVU173
 643 010c 204B     		ldr	r3, .L24+48
 644 010e 1A60     		str	r2, [r3]	@ float
 245:../BLDCMotor/motorctrl.c ****                 motor_set_pwm(dut01);
 645              		.loc 1 245 17 is_stmt 1 view .LVU174
 245:../BLDCMotor/motorctrl.c ****                 motor_set_pwm(dut01);
 646              		.loc 1 245 25 is_stmt 0 view .LVU175
 647 0110 DDED0E0A 		vldr.32	s1, [sp, #56]
 648 0114 9DED0D0A 		vldr.32	s0, [sp, #52]
 649 0118 FFF7FEFF 		bl	_svpwm
 650              	.LVL53:
 651 011c 8DED170A 		vstr.32	s0, [sp, #92]
 652 0120 CDED180A 		vstr.32	s1, [sp, #96]
 653 0124 8DED191A 		vstr.32	s2, [sp, #100]
 246:../BLDCMotor/motorctrl.c ****                 _currmentloop(i_abc,elec_theta);
 654              		.loc 1 246 17 is_stmt 1 view .LVU176
 655 0128 FFF7FEFF 		bl	motor_set_pwm
 656              	.LVL54:
 247:../BLDCMotor/motorctrl.c ****                 // sg_motordebug.self_ele_theta += 1.570796326f;
 657              		.loc 1 247 17 view .LVU177
 658 012c 14AB     		add	r3, sp, #80
 659 012e 93E80700 		ldm	r3, {r0, r1, r2}
 660 0132 8DE80700 		stm	sp, {r0, r1, r2}
 661 0136 11AB     		add	r3, sp, #68
 662 0138 0ECB     		ldm	r3, {r1, r2, r3}
 663 013a B0EE480A 		vmov.f32	s0, s16
 664 013e 04A8     		add	r0, sp, #16
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 22


 665 0140 FFF7FEFF 		bl	_currmentloop
 666              	.LVL55:
 249:../BLDCMotor/motorctrl.c **** 
 667              		.loc 1 249 17 view .LVU178
 249:../BLDCMotor/motorctrl.c **** 
 668              		.loc 1 249 46 is_stmt 0 view .LVU179
 669 0144 D4ED147A 		vldr.32	s15, [r4, #80]
 670 0148 9FED127A 		vldr.32	s14, .L24+52
 671 014c 77EE877A 		vadd.f32	s15, s15, s14
 672 0150 C4ED147A 		vstr.32	s15, [r4, #80]
 673              	.LBE3:
 266:../BLDCMotor/motorctrl.c **** }
 674              		.loc 1 266 5 is_stmt 1 view .LVU180
 267:../BLDCMotor/motorctrl.c **** void _limit_voltagecircle(uint32_t u_ref,uint32_t elec_theta)
 675              		.loc 1 267 1 is_stmt 0 view .LVU181
 676 0154 1BB0     		add	sp, sp, #108
 677              	.LCFI20:
 678              		.cfi_def_cfa_offset 20
 679              		@ sp needed
 680 0156 BDEC028B 		vldm	sp!, {d8}
 681              	.LCFI21:
 682              		.cfi_restore 80
 683              		.cfi_restore 81
 684              		.cfi_def_cfa_offset 12
 685              	.LVL56:
 267:../BLDCMotor/motorctrl.c **** void _limit_voltagecircle(uint32_t u_ref,uint32_t elec_theta)
 686              		.loc 1 267 1 view .LVU182
 687 015a 30BD     		pop	{r4, r5, pc}
 688              	.L25:
 689 015c AFF30080 		.align	3
 690              	.L24:
 691 0160 00000040 		.word	1073741824
 692 0164 FB211940 		.word	1075388923
 693 0168 00000000 		.word	.LANCHOR5
 694 016c 00000000 		.word	.LANCHOR3
 695 0170 4260653B 		.word	996499522
 696 0174 6F12033B 		.word	990057071
 697 0178 00000000 		.word	.LANCHOR6
 698 017c A69BC43A 		.word	985963430
 699 0180 00000000 		.word	.LANCHOR7
 700 0184 00000000 		.word	.LANCHOR8
 701 0188 00000000 		.word	.LANCHOR9
 702 018c DA0FC940 		.word	1086918618
 703 0190 00000000 		.word	.LANCHOR10
 704 0194 2EE3CD3A 		.word	986571566
 705              		.cfi_endproc
 706              	.LFE330:
 708              		.section	.text._limit_voltagecircle,"ax",%progbits
 709              		.align	1
 710              		.global	_limit_voltagecircle
 711              		.syntax unified
 712              		.thumb
 713              		.thumb_func
 715              	_limit_voltagecircle:
 716              	.LVL57:
 717              	.LFB331:
 269:../BLDCMotor/motorctrl.c ****     uint32_t u_alpha,u_beta;
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 23


 718              		.loc 1 269 1 is_stmt 1 view -0
 719              		.cfi_startproc
 720              		@ args = 0, pretend = 0, frame = 0
 721              		@ frame_needed = 0, uses_anonymous_args = 0
 722              		@ link register save eliminated.
 270:../BLDCMotor/motorctrl.c ****     u_alpha = u_ref * cosf(elec_theta);
 723              		.loc 1 270 5 view .LVU184
 271:../BLDCMotor/motorctrl.c ****     u_beta = u_ref * sinf(elec_theta);
 724              		.loc 1 271 5 view .LVU185
 272:../BLDCMotor/motorctrl.c **** }
 725              		.loc 1 272 5 view .LVU186
 273:../BLDCMotor/motorctrl.c **** dq_t _currmentloop(abc_t i_abc,float ele_theta)
 726              		.loc 1 273 1 is_stmt 0 view .LVU187
 727 0000 7047     		bx	lr
 728              		.cfi_endproc
 729              	.LFE331:
 731              		.section	.text.foc_paraminit,"ax",%progbits
 732              		.align	1
 733              		.global	foc_paraminit
 734              		.syntax unified
 735              		.thumb
 736              		.thumb_func
 738              	foc_paraminit:
 739              	.LFB338:
 404:../BLDCMotor/motorctrl.c **** 
 405:../BLDCMotor/motorctrl.c **** void foc_paraminit(void)
 406:../BLDCMotor/motorctrl.c **** {
 740              		.loc 1 406 1 is_stmt 1 view -0
 741              		.cfi_startproc
 742              		@ args = 0, pretend = 0, frame = 0
 743              		@ frame_needed = 0, uses_anonymous_args = 0
 744 0000 10B5     		push	{r4, lr}
 745              	.LCFI22:
 746              		.cfi_def_cfa_offset 8
 747              		.cfi_offset 4, -8
 748              		.cfi_offset 14, -4
 749 0002 2DED028B 		vpush.64	{d8}
 750              	.LCFI23:
 751              		.cfi_def_cfa_offset 16
 752              		.cfi_offset 80, -16
 753              		.cfi_offset 81, -12
 407:../BLDCMotor/motorctrl.c ****     sgp_curloop_d_pid = &sg_curloop_param.d_pid;
 754              		.loc 1 407 5 view .LVU189
 755              		.loc 1 407 23 is_stmt 0 view .LVU190
 756 0006 1D48     		ldr	r0, .L29
 757 0008 1D4B     		ldr	r3, .L29+4
 758 000a 1860     		str	r0, [r3]
 408:../BLDCMotor/motorctrl.c ****     sgp_curloop_q_pid = &sg_curloop_param.q_pid;
 759              		.loc 1 408 5 is_stmt 1 view .LVU191
 760              		.loc 1 408 23 is_stmt 0 view .LVU192
 761 000c 1D4C     		ldr	r4, .L29+8
 762 000e 00F11C03 		add	r3, r0, #28
 763 0012 2360     		str	r3, [r4]
 409:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_d_pid,0.4f,0.000f,1.0f,D_MAX_VAL,D_MIN_VAL);
 764              		.loc 1 409 5 is_stmt 1 view .LVU193
 765 0014 DFED1C8A 		vldr.32	s17, .L29+12
 766 0018 9FED1C8A 		vldr.32	s16, .L29+16
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 24


 767 001c B0EE682A 		vmov.f32	s4, s17
 768 0020 F0EE481A 		vmov.f32	s3, s16
 769 0024 B7EE001A 		vmov.f32	s2, #1.0e+0
 770 0028 DFED190A 		vldr.32	s1, .L29+20
 771 002c 9FED190A 		vldr.32	s0, .L29+24
 772 0030 FFF7FEFF 		bl	pid_init
 773              	.LVL58:
 410:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_q_pid,0.020f,0.001f,1.0f,D_MAX_VAL,D_MIN_VAL);
 774              		.loc 1 410 5 view .LVU194
 775 0034 B0EE682A 		vmov.f32	s4, s17
 776 0038 F0EE481A 		vmov.f32	s3, s16
 777 003c B7EE001A 		vmov.f32	s2, #1.0e+0
 778 0040 DFED150A 		vldr.32	s1, .L29+28
 779 0044 9FED150A 		vldr.32	s0, .L29+32
 780 0048 2068     		ldr	r0, [r4]
 781 004a FFF7FEFF 		bl	pid_init
 782              	.LVL59:
 411:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[0],80);
 783              		.loc 1 411 5 view .LVU195
 784 004e 9FED148A 		vldr.32	s16, .L29+36
 785 0052 144C     		ldr	r4, .L29+40
 786 0054 B0EE480A 		vmov.f32	s0, s16
 787 0058 2046     		mov	r0, r4
 788 005a FFF7FEFF 		bl	lowfilter_init
 789              	.LVL60:
 412:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[1],80);
 790              		.loc 1 412 5 view .LVU196
 791 005e B0EE480A 		vmov.f32	s0, s16
 792 0062 04F10800 		add	r0, r4, #8
 793 0066 FFF7FEFF 		bl	lowfilter_init
 794              	.LVL61:
 413:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[2],80);
 795              		.loc 1 413 5 view .LVU197
 796 006a B0EE480A 		vmov.f32	s0, s16
 797 006e 04F11000 		add	r0, r4, #16
 798 0072 FFF7FEFF 		bl	lowfilter_init
 799              	.LVL62:
 414:../BLDCMotor/motorctrl.c **** }...
 800              		.loc 1 414 1 is_stmt 0 view .LVU198
 801 0076 BDEC028B 		vldm	sp!, {d8}
 802              	.LCFI24:
 803              		.cfi_restore 80
 804              		.cfi_restore 81
 805              		.cfi_def_cfa_offset 8
 806 007a 10BD     		pop	{r4, pc}
 807              	.L30:
 808              		.align	2
 809              	.L29:
 810 007c 00000000 		.word	.LANCHOR11
 811 0080 00000000 		.word	.LANCHOR4
 812 0084 00000000 		.word	.LANCHOR12
 813 0088 333373C1 		.word	-1049414861
 814 008c 33337341 		.word	1098068787
 815 0090 00000000 		.word	0
 816 0094 CDCCCC3E 		.word	1053609165
 817 0098 6F12833A 		.word	981668463
 818 009c 0AD7A33C 		.word	1017370378
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 25


 819 00a0 0000A042 		.word	1117782016
 820 00a4 00000000 		.word	.LANCHOR6
 821              		.cfi_endproc
 822              	.LFE338:
 824              		.section	.rodata.motortctrl_process.str1.4,"aMS",%progbits,1
 825              		.align	2
 826              	.LC1:
 827 0000 6D6F746F 		.ascii	"motor init\015\012\000"
 827      7220696E 
 827      69740D0A 
 827      00
 828              		.section	.text.motortctrl_process,"ax",%progbits
 829              		.align	1
 830              		.global	motortctrl_process
 831              		.syntax unified
 832              		.thumb
 833              		.thumb_func
 835              	motortctrl_process:
 836              	.LFB329:
  78:../BLDCMotor/motorctrl.c **** {
 837              		.loc 1 78 1 is_stmt 1 view -0
 838              		.cfi_startproc
 839              		@ args = 0, pretend = 0, frame = 0
 840              		@ frame_needed = 0, uses_anonymous_args = 0
 841 0000 08B5     		push	{r3, lr}
 842              	.LCFI25:
 843              		.cfi_def_cfa_offset 8
 844              		.cfi_offset 3, -8
 845              		.cfi_offset 14, -4
  79:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
 846              		.loc 1 79 5 view .LVU200
  79:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
 847              		.loc 1 79 21 is_stmt 0 view .LVU201
 848 0002 194B     		ldr	r3, .L37
 849 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  79:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
 850              		.loc 1 79 5 view .LVU202
 851 0006 032B     		cmp	r3, #3
 852 0008 17D0     		beq	.L32
 853 000a 042B     		cmp	r3, #4
 854 000c 29D0     		beq	.L33
 855 000e 03B1     		cbz	r3, .L36
 856              	.L31:
 106:../BLDCMotor/motorctrl.c **** }
 857              		.loc 1 106 1 view .LVU203
 858 0010 08BD     		pop	{r3, pc}
 859              	.L36:
  82:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
 860              		.loc 1 82 9 is_stmt 1 view .LVU204
  82:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
 861              		.loc 1 82 29 is_stmt 0 view .LVU205
 862 0012 FFF7FEFF 		bl	_get_angleoffset
 863              	.LVL63:
  82:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
 864              		.loc 1 82 27 view .LVU206
 865 0016 154B     		ldr	r3, .L37+4
 866 0018 83ED000A 		vstr.32	s0, [r3]
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 26


  83:../BLDCMotor/motorctrl.c ****         foc_paraminit();
 867              		.loc 1 83 9 is_stmt 1 view .LVU207
 868 001c FFF7FEFF 		bl	foc_paraminit
 869              	.LVL64:
  84:../BLDCMotor/motorctrl.c ****         USER_DEBUG_NORMAL("motor init\r\n");
 870              		.loc 1 84 9 view .LVU208
 871 0020 1349     		ldr	r1, .L37+8
 872 0022 0020     		movs	r0, #0
 873 0024 FFF7FEFF 		bl	SEGGER_RTT_printf
 874              	.LVL65:
  85:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
 875              		.loc 1 85 9 view .LVU209
 876 0028 1420     		movs	r0, #20
 877 002a FFF7FEFF 		bl	HAL_Delay
 878              	.LVL66:
  86:../BLDCMotor/motorctrl.c ****         motor_enable();
 879              		.loc 1 86 9 view .LVU210
 880 002e FFF7FEFF 		bl	motor_enable
 881              	.LVL67:
  87:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
 882              		.loc 1 87 9 view .LVU211
  87:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
 883              		.loc 1 87 24 is_stmt 0 view .LVU212
 884 0032 0D4B     		ldr	r3, .L37
 885 0034 0322     		movs	r2, #3
 886 0036 1A70     		strb	r2, [r3]
  88:../BLDCMotor/motorctrl.c ****         break;
 887              		.loc 1 88 9 is_stmt 1 view .LVU213
 888 0038 EAE7     		b	.L31
 889              	.L32:
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 890              		.loc 1 92 13 view .LVU214
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 891              		.loc 1 92 29 is_stmt 0 view .LVU215
 892 003a 0B4A     		ldr	r2, .L37
 893 003c 5388     		ldrh	r3, [r2, #2]
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 894              		.loc 1 92 19 view .LVU216
 895 003e 0133     		adds	r3, r3, #1
 896 0040 9BB2     		uxth	r3, r3
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 897              		.loc 1 92 16 view .LVU217
 898 0042 5380     		strh	r3, [r2, #2]	@ movhi
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 899              		.loc 1 92 17 view .LVU218
 900 0044 0B4A     		ldr	r2, .L37+12
 901 0046 A2FB0312 		umull	r1, r2, r2, r3
 902 004a 120B     		lsrs	r2, r2, #12
 903 004c 43F69821 		movw	r1, #15000
 904 0050 01FB1233 		mls	r3, r1, r2, r3
 905 0054 9BB2     		uxth	r3, r3
  92:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
 906              		.loc 1 92 16 view .LVU219
 907 0056 002B     		cmp	r3, #0
 908 0058 DAD1     		bne	.L31
  95:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_STOP;
 909              		.loc 1 95 17 is_stmt 1 view .LVU220
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 27


  95:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_STOP;
 910              		.loc 1 95 32 is_stmt 0 view .LVU221
 911 005a 034B     		ldr	r3, .L37
 912 005c 0422     		movs	r2, #4
 913 005e 1A70     		strb	r2, [r3]
 914 0060 D6E7     		b	.L31
 915              	.L33:
 101:../BLDCMotor/motorctrl.c ****         motor_disable();
 916              		.loc 1 101 9 is_stmt 1 view .LVU222
 917 0062 FFF7FEFF 		bl	motor_disable
 918              	.LVL68:
 102:../BLDCMotor/motorctrl.c ****         break;
 919              		.loc 1 102 9 view .LVU223
 106:../BLDCMotor/motorctrl.c **** }
 920              		.loc 1 106 1 is_stmt 0 view .LVU224
 921 0066 D3E7     		b	.L31
 922              	.L38:
 923              		.align	2
 924              	.L37:
 925 0068 00000000 		.word	.LANCHOR13
 926 006c 00000000 		.word	.LANCHOR7
 927 0070 00000000 		.word	.LC1
 928 0074 73B2E745 		.word	1172812403
 929              		.cfi_endproc
 930              	.LFE329:
 932              		.global	test_angle
 933              		.global	cur_angle
 934              		.global	test_val
 935              		.global	test_ic
 936              		.global	test_ib
 937              		.global	test_ia
 938              		.global	raw_angle
 939              		.global	next_angle_test
 940              		.global	pre_angle_test
 941              		.global	g_Motor1
 942              		.global	sg_motordebug
 943              		.section	.rodata
 944              		.align	2
 945              		.set	.LANCHOR9,. + 0
 946              	.LC0:
 947 0000 00000000 		.word	0
 948 0004 0000803F 		.word	1065353216
 949 0008 00000000 		.word	0
 950 000c 66660000 		.word	26214
 951              		.section	.bss.cur_angle,"aw",%nobits
 952              		.align	2
 953              		.set	.LANCHOR10,. + 0
 956              	cur_angle:
 957 0000 00000000 		.space	4
 958              		.section	.bss.g_Motor1,"aw",%nobits
 959              		.align	2
 960              		.set	.LANCHOR13,. + 0
 963              	g_Motor1:
 964 0000 00000000 		.space	4
 965              		.section	.bss.next_angle_test,"aw",%nobits
 966              		.align	2
 969              	next_angle_test:
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 28


 970 0000 00000000 		.space	4
 971              		.section	.bss.pre_angle_test,"aw",%nobits
 972              		.align	2
 975              	pre_angle_test:
 976 0000 00000000 		.space	4
 977              		.section	.bss.raw_angle,"aw",%nobits
 978              		.align	2
 981              	raw_angle:
 982 0000 00000000 		.space	4
 983              		.section	.bss.sg_MecThetaOffset,"aw",%nobits
 984              		.align	2
 985              		.set	.LANCHOR7,. + 0
 988              	sg_MecThetaOffset:
 989 0000 00000000 		.space	4
 990              		.section	.bss.sg_curloop_param,"aw",%nobits
 991              		.align	2
 992              		.set	.LANCHOR11,. + 0
 995              	sg_curloop_param:
 996 0000 00000000 		.space	56
 996      00000000 
 996      00000000 
 996      00000000 
 996      00000000 
 997              		.section	.bss.sg_elefilter,"aw",%nobits
 998              		.align	2
 999              		.set	.LANCHOR6,. + 0
 1002              	sg_elefilter:
 1003 0000 00000000 		.space	24
 1003      00000000 
 1003      00000000 
 1003      00000000 
 1003      00000000 
 1004              		.section	.bss.sg_motordebug,"aw",%nobits
 1005              		.align	2
 1006              		.set	.LANCHOR3,. + 0
 1009              	sg_motordebug:
 1010 0000 00000000 		.space	92
 1010      00000000 
 1010      00000000 
 1010      00000000 
 1010      00000000 
 1011              		.section	.bss.sgp_curloop_d_pid,"aw",%nobits
 1012              		.align	2
 1013              		.set	.LANCHOR4,. + 0
 1016              	sgp_curloop_d_pid:
 1017 0000 00000000 		.space	4
 1018              		.section	.bss.sgp_curloop_q_pid,"aw",%nobits
 1019              		.align	2
 1020              		.set	.LANCHOR12,. + 0
 1023              	sgp_curloop_q_pid:
 1024 0000 00000000 		.space	4
 1025              		.section	.bss.test_angle,"aw",%nobits
 1026              		.align	2
 1027              		.set	.LANCHOR8,. + 0
 1030              	test_angle:
 1031 0000 00000000 		.space	4
 1032              		.section	.bss.test_ia,"aw",%nobits
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 29


 1033              		.align	2
 1034              		.set	.LANCHOR0,. + 0
 1037              	test_ia:
 1038 0000 00000000 		.space	4
 1039              		.section	.bss.test_ib,"aw",%nobits
 1040              		.align	2
 1041              		.set	.LANCHOR1,. + 0
 1044              	test_ib:
 1045 0000 00000000 		.space	4
 1046              		.section	.bss.test_ic,"aw",%nobits
 1047              		.align	2
 1048              		.set	.LANCHOR2,. + 0
 1051              	test_ic:
 1052 0000 00000000 		.space	4
 1053              		.section	.bss.test_val,"aw",%nobits
 1054              		.align	2
 1055              		.set	.LANCHOR5,. + 0
 1058              	test_val:
 1059 0000 00000000 		.space	4
 1060              		.text
 1061              	.Letext0:
 1062              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 1063              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 1064              		.file 4 "../Common/IQMath/ti/IQmathLib.h"
 1065              		.file 5 "../Common/method/filter.h"
 1066              		.file 6 "../Common/method/pid.h"
 1067              		.file 7 "../BLDCMotor/motorctrl_common.h"
 1068              		.file 8 "./Board/board.h"
 1069              		.file 9 "../Sensor/sensor.h"
 1070              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1071              		.file 11 "Inc/tim.h"
 1072              		.file 12 "Inc/adc.h"
 1073              		.file 13 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\math.h"
 1074              		.file 14 "../Common/debuglog/SEGGER_RTT_V792h/RTT/SEGGER_RTT.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 30


DEFINED SYMBOLS
                            *ABS*:00000000 motorctrl.c
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:20     .text.motor_enable_noirq:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:25     .text.motor_enable_noirq:00000000 motor_enable_noirq
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:46     .text.motor_set_pwm:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:51     .text.motor_set_pwm:00000000 motor_set_pwm
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:80     .text.motor_enable:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:85     .text.motor_enable:00000000 motor_enable
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:111    .text.motor_disable:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:116    .text.motor_disable:00000000 motor_disable
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:139    .text._get_angleoffset:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:144    .text._get_angleoffset:00000000 _get_angleoffset
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:251    .text._get_angleoffset:0000006c $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:257    .text._currmentloop:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:262    .text._currmentloop:00000000 _currmentloop
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:423    .text._currmentloop:000000b8 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:438    .text._50uscycle_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:444    .text._50uscycle_process:00000000 _50uscycle_process
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:691    .text._50uscycle_process:00000160 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:709    .text._limit_voltagecircle:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:715    .text._limit_voltagecircle:00000000 _limit_voltagecircle
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:732    .text.foc_paraminit:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:738    .text.foc_paraminit:00000000 foc_paraminit
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:810    .text.foc_paraminit:0000007c $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:825    .rodata.motortctrl_process.str1.4:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:829    .text.motortctrl_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:835    .text.motortctrl_process:00000000 motortctrl_process
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:925    .text.motortctrl_process:00000068 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1030   .bss.test_angle:00000000 test_angle
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:956    .bss.cur_angle:00000000 cur_angle
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1058   .bss.test_val:00000000 test_val
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1051   .bss.test_ic:00000000 test_ic
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1044   .bss.test_ib:00000000 test_ib
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1037   .bss.test_ia:00000000 test_ia
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:981    .bss.raw_angle:00000000 raw_angle
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:969    .bss.next_angle_test:00000000 next_angle_test
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:975    .bss.pre_angle_test:00000000 pre_angle_test
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:963    .bss.g_Motor1:00000000 g_Motor1
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1009   .bss.sg_motordebug:00000000 sg_motordebug
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:944    .rodata:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:952    .bss.cur_angle:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:959    .bss.g_Motor1:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:966    .bss.next_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:972    .bss.pre_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:978    .bss.raw_angle:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:984    .bss.sg_MecThetaOffset:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:988    .bss.sg_MecThetaOffset:00000000 sg_MecThetaOffset
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:991    .bss.sg_curloop_param:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:995    .bss.sg_curloop_param:00000000 sg_curloop_param
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:998    .bss.sg_elefilter:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1002   .bss.sg_elefilter:00000000 sg_elefilter
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1005   .bss.sg_motordebug:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1012   .bss.sgp_curloop_d_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1016   .bss.sgp_curloop_d_pid:00000000 sgp_curloop_d_pid
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1019   .bss.sgp_curloop_q_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1023   .bss.sgp_curloop_q_pid:00000000 sgp_curloop_q_pid
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1026   .bss.test_angle:00000000 $d
ARM GAS  C:\Users\57308\AppData\Local\Temp\cc48cFTe.s 			page 31


C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1033   .bss.test_ia:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1040   .bss.test_ib:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1047   .bss.test_ic:00000000 $d
C:\Users\57308\AppData\Local\Temp\cc48cFTe.s:1054   .bss.test_val:00000000 $d

UNDEFINED SYMBOLS
tim_pwm_enable
tim_set_pwm
tim_tigger_adc
adc_start
tim_pwm_disable
adc_stop
_svpwm
HAL_Delay
sensor_user_read
_IQ15toF
cosf
_3s_2s
_2s_2r
pid_contrl
RTT_test_Id
__aeabi_f2d
__aeabi_d2f
lowfilter_cale
fmod
_2r_2s
pid_init
lowfilter_init
SEGGER_RTT_printf
