ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"motorctrl.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.sg_debug_clear,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	sg_debug_clear:
  26              	.LFB334:
  27              		.file 1 "../BLDCMotor/motorctrl.c"
   1:../BLDCMotor/motorctrl.c **** #include "./motorctrl.h"
   2:../BLDCMotor/motorctrl.c **** #include "debuglog.h"
   3:../BLDCMotor/motorctrl.c **** #include "motorctrl_common.h"
   4:../BLDCMotor/motorctrl.c **** 
   5:../BLDCMotor/motorctrl.c **** #include "board.h"
   6:../BLDCMotor/motorctrl.c **** 
   7:../BLDCMotor/motorctrl.c **** 
   8:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
   9:../BLDCMotor/motorctrl.c **** #endif
  10:../BLDCMotor/motorctrl.c **** #define Q15_PI_2                   (51471)
  11:../BLDCMotor/motorctrl.c **** #define Q15_2PI                    (205884)
  12:../BLDCMotor/motorctrl.c **** #define PI_2                       (1.570796f)
  13:../BLDCMotor/motorctrl.c **** #define MOTORCTRL_PERCI            (1)
  14:../BLDCMotor/motorctrl.c **** 
  15:../BLDCMotor/motorctrl.c **** enum{
  16:../BLDCMotor/motorctrl.c ****     MOTOR_INIT,
  17:../BLDCMotor/motorctrl.c ****     MOTOR_IDLE,
  18:../BLDCMotor/motorctrl.c ****     MOTOR_START, 
  19:../BLDCMotor/motorctrl.c ****     MOTOR_RUNING,
  20:../BLDCMotor/motorctrl.c ****     MOTOR_STOP,
  21:../BLDCMotor/motorctrl.c **** };
  22:../BLDCMotor/motorctrl.c **** 
  23:../BLDCMotor/motorctrl.c **** motordebug_t sg_motordebug = {0};
  24:../BLDCMotor/motorctrl.c **** typedef struct
  25:../BLDCMotor/motorctrl.c **** {
  26:../BLDCMotor/motorctrl.c ****     unsigned char state;
  27:../BLDCMotor/motorctrl.c ****     unsigned short cnt;
  28:../BLDCMotor/motorctrl.c **** }motorctrl_t;
  29:../BLDCMotor/motorctrl.c **** 
  30:../BLDCMotor/motorctrl.c **** static dq_t _currmentloop(abc_t i_abc,float ele_theta);
  31:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 2


  32:../BLDCMotor/motorctrl.c **** static void motor_enable(void);
  33:../BLDCMotor/motorctrl.c **** static void motor_disable(void);
  34:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp);
  35:../BLDCMotor/motorctrl.c **** static void sg_debug_clear(void)
  36:../BLDCMotor/motorctrl.c **** {
  28              		.loc 1 36 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  37:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_targe =0.0f;
  33              		.loc 1 37 5 view .LVU1
  34              		.loc 1 37 28 is_stmt 0 view .LVU2
  35 0000 024B     		ldr	r3, .L2
  36 0002 0022     		movs	r2, #0
  37 0004 5A64     		str	r2, [r3, #68]	@ float
  38:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_targe =0.0f;
  38              		.loc 1 38 5 is_stmt 1 view .LVU3
  39              		.loc 1 38 28 is_stmt 0 view .LVU4
  40 0006 9A64     		str	r2, [r3, #72]	@ float
  39:../BLDCMotor/motorctrl.c **** }
  41              		.loc 1 39 1 view .LVU5
  42 0008 7047     		bx	lr
  43              	.L3:
  44 000a 00BF     		.align	2
  45              	.L2:
  46 000c 00000000 		.word	.LANCHOR0
  47              		.cfi_endproc
  48              	.LFE334:
  50              		.section	.text.motor_enable_noirq,"ax",%progbits
  51              		.align	1
  52              		.syntax unified
  53              		.thumb
  54              		.thumb_func
  56              	motor_enable_noirq:
  57              	.LFB374:
  40:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab);
  41:../BLDCMotor/motorctrl.c **** 
  42:../BLDCMotor/motorctrl.c **** static void g431_angletest(abc_t i_abc);
  43:../BLDCMotor/motorctrl.c **** 
  44:../BLDCMotor/motorctrl.c **** 
  45:../BLDCMotor/motorctrl.c **** motorctrl_t g_Motor1 = {
  46:../BLDCMotor/motorctrl.c ****     .state = MOTOR_INIT,
  47:../BLDCMotor/motorctrl.c ****     .cnt = 0,
  48:../BLDCMotor/motorctrl.c **** };
  49:../BLDCMotor/motorctrl.c **** static volatile float sg_MecThetaOffset = 0.0f;
  50:../BLDCMotor/motorctrl.c **** static lowfilter_t sg_elefilter[3];
  51:../BLDCMotor/motorctrl.c **** pid_cb_t test_d_pid = {0};
  52:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_d_pid;
  53:../BLDCMotor/motorctrl.c **** static pid_cb_t *sgp_curloop_q_pid;
  54:../BLDCMotor/motorctrl.c **** static curloop_t sg_curloop_param;
  55:../BLDCMotor/motorctrl.c **** float pre_angle_test = 0.0f;
  56:../BLDCMotor/motorctrl.c **** float next_angle_test = 0.0f;
  57:../BLDCMotor/motorctrl.c **** float raw_angle = 0.0f;
  58:../BLDCMotor/motorctrl.c **** float test_ia = 0.0f;
  59:../BLDCMotor/motorctrl.c **** float test_ib = 0.0f;
  60:../BLDCMotor/motorctrl.c **** float test_ic = 0.0f;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 3


  61:../BLDCMotor/motorctrl.c **** void motortctrl_process(void)
  62:../BLDCMotor/motorctrl.c **** {
  63:../BLDCMotor/motorctrl.c ****     char rec_buf[64];
  64:../BLDCMotor/motorctrl.c ****     char cnt = 0;
  65:../BLDCMotor/motorctrl.c ****     // if (readline_fromPC(rec_buf,sizeof(rec_buf)))
  66:../BLDCMotor/motorctrl.c ****     // {
  67:../BLDCMotor/motorctrl.c ****     //     motorprotocol_pause(rec_buf);
  68:../BLDCMotor/motorctrl.c ****     // }
  69:../BLDCMotor/motorctrl.c ****     motorprotocol_process();
  70:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
  71:../BLDCMotor/motorctrl.c ****     {
  72:../BLDCMotor/motorctrl.c ****     case MOTOR_INIT:
  73:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
  74:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
  75:../BLDCMotor/motorctrl.c ****         foc_paraminit();
  76:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
  77:../BLDCMotor/motorctrl.c ****         motor_enable();
  78:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
  79:../BLDCMotor/motorctrl.c ****         break;
  80:../BLDCMotor/motorctrl.c **** 
  81:../BLDCMotor/motorctrl.c ****     case MOTOR_RUNING:
  82:../BLDCMotor/motorctrl.c ****         {
  83:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 15000))
  84:../BLDCMotor/motorctrl.c ****             {
  85:../BLDCMotor/motorctrl.c ****                 // g_Motor1.state = MOTOR_STOP;
  86:../BLDCMotor/motorctrl.c ****             }
  87:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 1)
  88:../BLDCMotor/motorctrl.c ****             {
  89:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_STOP;
  90:../BLDCMotor/motorctrl.c ****             }
  91:../BLDCMotor/motorctrl.c ****         }
  92:../BLDCMotor/motorctrl.c ****         break;
  93:../BLDCMotor/motorctrl.c **** 
  94:../BLDCMotor/motorctrl.c ****     case MOTOR_STOP:
  95:../BLDCMotor/motorctrl.c ****         motor_disable();
  96:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_IDLE;
  97:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
  98:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 3)
  99:../BLDCMotor/motorctrl.c ****             {
 100:../BLDCMotor/motorctrl.c ****                 g_Motor1.state = MOTOR_INIT;
 101:../BLDCMotor/motorctrl.c ****             }        
 102:../BLDCMotor/motorctrl.c ****         break;
 103:../BLDCMotor/motorctrl.c ****     
 104:../BLDCMotor/motorctrl.c ****     default:
 105:../BLDCMotor/motorctrl.c ****         break;
 106:../BLDCMotor/motorctrl.c ****     }
 107:../BLDCMotor/motorctrl.c **** }
 108:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 109:../BLDCMotor/motorctrl.c **** unsigned int test_angletime = 0;
 110:../BLDCMotor/motorctrl.c **** float per_eleangle = 0.0f;
 111:../BLDCMotor/motorctrl.c **** void _50uscycle_process(unsigned int *abc_vale,float _elec_theta)
 112:../BLDCMotor/motorctrl.c **** {
 113:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 114:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;    
 115:../BLDCMotor/motorctrl.c ****     duty_t dut01,dut02;
 116:../BLDCMotor/motorctrl.c **** /*----------------‰∏âÁõ∏ÁîµÊµÅÂ§ÑÁêÜ------------------------------*/    
 117:../BLDCMotor/motorctrl.c ****     float Ia,Ib,Ic;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 4


 118:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 119:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 120:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 121:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 122:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 123:../BLDCMotor/motorctrl.c **** 
 124:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)A_VOLITETOCURRENT_FACTOR;
 125:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 126:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 127:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 128:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 129:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 130:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 131:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 132:../BLDCMotor/motorctrl.c **** 
 133:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 134:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ22toF(Q15_Mechtheta);
 135:../BLDCMotor/motorctrl.c ****     raw_angle = mech_theta;
 136:../BLDCMotor/motorctrl.c ****     mech_theta = (mech_theta + 0.0f);//0.12f);//sg_MecThetaOffset);
 137:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 138:../BLDCMotor/motorctrl.c ****     elec_theta += ANGLE_COMPENSATA;
 139:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 140:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 141:../BLDCMotor/motorctrl.c ****     #if 1
 142:../BLDCMotor/motorctrl.c ****         #if 0
 143:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 144:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 145:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta > 6.28f)
 146:../BLDCMotor/motorctrl.c ****             {
 147:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta = 0.0f;
 148:../BLDCMotor/motorctrl.c ****             }
 149:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 150:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 151:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 152:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 153:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.001f;                
 154:../BLDCMotor/motorctrl.c ****         #else
 155:../BLDCMotor/motorctrl.c ****         static unsigned short cnt = 0;
 156:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 157:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 158:../BLDCMotor/motorctrl.c **** 
 159:../BLDCMotor/motorctrl.c ****                         
 160:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta < 0.0f)
 161:../BLDCMotor/motorctrl.c ****             {
 162:../BLDCMotor/motorctrl.c ****                 cnt++;
 163:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 164:../BLDCMotor/motorctrl.c ****             }
 165:../BLDCMotor/motorctrl.c ****             if (cnt > MOTOR_PAIR*2)
 166:../BLDCMotor/motorctrl.c ****             {
 167:../BLDCMotor/motorctrl.c ****                 return;
 168:../BLDCMotor/motorctrl.c ****             }
 169:../BLDCMotor/motorctrl.c **** 
 170:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 171:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 172:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 173:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 174:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.001f;               
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 5


 175:../BLDCMotor/motorctrl.c ****         #endif 
 176:../BLDCMotor/motorctrl.c ****     #else
 177:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 178:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 179:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 180:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta - PI/2.0F);
 181:../BLDCMotor/motorctrl.c ****         #else
 182:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta - PI/2.0F);
 183:../BLDCMotor/motorctrl.c ****         #endif
 184:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 185:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 186:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 187:../BLDCMotor/motorctrl.c ****     #endif
 188:../BLDCMotor/motorctrl.c **** 
 189:../BLDCMotor/motorctrl.c **** #endif
 190:../BLDCMotor/motorctrl.c **** 
 191:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 192:../BLDCMotor/motorctrl.c **** 
 193:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 194:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ22toF(Q15_Mechtheta);
 195:../BLDCMotor/motorctrl.c ****     raw_angle = mech_theta;
 196:../BLDCMotor/motorctrl.c ****     mech_theta = (mech_theta - sg_MecThetaOffset);
 197:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 198:../BLDCMotor/motorctrl.c ****     elec_theta += ANGLE_COMPENSATA;
 199:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 200:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 201:../BLDCMotor/motorctrl.c **** 
 202:../BLDCMotor/motorctrl.c ****     #if 0//Âº∫Êãñ       
 203:../BLDCMotor/motorctrl.c ****         #if 1
 204:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 205:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 206:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta > 6.28f)
 207:../BLDCMotor/motorctrl.c ****             {
 208:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta = 0.0f;
 209:../BLDCMotor/motorctrl.c ****             }
 210:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 211:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 212:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 213:../BLDCMotor/motorctrl.c ****             // motor_set_pwm(dut01);//ÊöÇÊó∂Â±èËîΩ ÁîµÊú∫‰∏çËΩ¨Âä®
 214:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.001f;                
 215:../BLDCMotor/motorctrl.c ****         #else
 216:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-0.8f,_IQ15(0.0f),_IQ15(0.8f)};
 217:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;            
 218:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta < 0.0f)
 219:../BLDCMotor/motorctrl.c ****             {
 220:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 221:../BLDCMotor/motorctrl.c ****             }
 222:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,sg_motordebug.self_ele_theta);
 223:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta);
 224:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 225:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 226:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.001f;               
 227:../BLDCMotor/motorctrl.c ****         #endif
 228:../BLDCMotor/motorctrl.c ****     #else //‰ΩøÁî®‰º†ÊÑüÂô®
 229:../BLDCMotor/motorctrl.c ****     {
 230:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,0.1f,_IQ15(0.0f),_IQ15(0.8f)};
 231:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 6


 232:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 233:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta - PI/2.0F);
 234:../BLDCMotor/motorctrl.c ****         #endif
 235:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 236:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 237:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 238:../BLDCMotor/motorctrl.c ****     }
 239:../BLDCMotor/motorctrl.c ****     #endif
 240:../BLDCMotor/motorctrl.c **** #endif
 241:../BLDCMotor/motorctrl.c **** 
 242:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 243:../BLDCMotor/motorctrl.c ****     g431_angletest(i_abc);
 244:../BLDCMotor/motorctrl.c **** #endif
 245:../BLDCMotor/motorctrl.c ****     return;
 246:../BLDCMotor/motorctrl.c **** }
 247:../BLDCMotor/motorctrl.c **** 
 248:../BLDCMotor/motorctrl.c **** static void g431_angletest(abc_t i_abc)
 249:../BLDCMotor/motorctrl.c **** {
 250:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 251:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;
 252:../BLDCMotor/motorctrl.c ****     duty_t dut01;        
 253:../BLDCMotor/motorctrl.c ****   unsigned int nCycleUsed = 0;
 254:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
 255:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 256:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 257:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 258:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 259:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 260:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 261:../BLDCMotor/motorctrl.c ****   }
 262:../BLDCMotor/motorctrl.c ****   test_angletime = nCycleUsed/170;
 263:../BLDCMotor/motorctrl.c **** 
 264:../BLDCMotor/motorctrl.c ****     #if 0//Âº∫Êãñ
 265:../BLDCMotor/motorctrl.c ****         {
 266:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta);
 267:../BLDCMotor/motorctrl.c ****             #if 0 //Ê≠£ËΩ¨
 268:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,0.6f,_IQ15(0.0f),_IQ15(0.0f)};
 269:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 270:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta >= _2PI)
 271:../BLDCMotor/motorctrl.c ****             {
 272:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta -= _2PI;
 273:../BLDCMotor/motorctrl.c ****             }
 274:../BLDCMotor/motorctrl.c ****             // udq.q = sg_motordebug.iq_targe;
 275:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta); 
 276:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
 277:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 278:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta += 0.0031415926f;
 279:../BLDCMotor/motorctrl.c ****             #else //ÂèçËΩ¨
 280:../BLDCMotor/motorctrl.c ****             dq_t udq = {0.0f,-0.6f,_IQ15(0.0f),_IQ15(0.0f)};
 281:../BLDCMotor/motorctrl.c ****             alpbet_t uab,uab_q15;
 282:../BLDCMotor/motorctrl.c ****             // udq.q = sg_motordebug.iq_targe; 
 283:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.self_ele_theta <= 0.0f)
 284:../BLDCMotor/motorctrl.c ****             {
 285:../BLDCMotor/motorctrl.c ****                 sg_motordebug.self_ele_theta += _2PI;
 286:../BLDCMotor/motorctrl.c ****             }
 287:../BLDCMotor/motorctrl.c ****             uab = _2r_2s(udq, sg_motordebug.self_ele_theta); 
 288:../BLDCMotor/motorctrl.c ****             dut01 = _svpwm(uab.alpha,uab.beta);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 7


 289:../BLDCMotor/motorctrl.c ****             motor_set_pwm(dut01);
 290:../BLDCMotor/motorctrl.c ****             sg_motordebug.self_ele_theta -= 0.0031415926f;
 291:../BLDCMotor/motorctrl.c ****             #endif
 292:../BLDCMotor/motorctrl.c ****         }
 293:../BLDCMotor/motorctrl.c ****     #else //‰ΩøÁî®‰º†ÊÑüÂô®
 294:../BLDCMotor/motorctrl.c ****     {
 295:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f,_IQ15(0.0f),_IQ15(0.8f)};
 296:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 297:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 298:../BLDCMotor/motorctrl.c ****             udq = _currmentloop(i_abc,elec_theta);
 299:../BLDCMotor/motorctrl.c ****         #else
 300:../BLDCMotor/motorctrl.c ****             _currmentloop(i_abc,elec_theta - PI_2);
 301:../BLDCMotor/motorctrl.c ****             udq.d = sg_motordebug.id_targe;
 302:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 303:../BLDCMotor/motorctrl.c ****         #endif
 304:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 305:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 306:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 307:../BLDCMotor/motorctrl.c ****     }
 308:../BLDCMotor/motorctrl.c ****     #endif
 309:../BLDCMotor/motorctrl.c **** }
 310:../BLDCMotor/motorctrl.c **** 
 311:../BLDCMotor/motorctrl.c **** alpbet_t _limit_voltagecircle(alpbet_t raw_uab) {  
 312:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 313:../BLDCMotor/motorctrl.c ****     float voltage_magnitude = sqrt(raw_uab.alpha * raw_uab.alpha + raw_uab.beta * raw_uab.beta); //
 314:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 315:../BLDCMotor/motorctrl.c ****     if (voltage_magnitude > max_voltage) {  
 316:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 317:../BLDCMotor/motorctrl.c ****         float scale_factor = max_voltage / voltage_magnitude;  
 318:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 319:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 320:../BLDCMotor/motorctrl.c ****     } else {  
 321:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Âú®ÂÖÅËÆ∏ËåÉÂõ¥ÂÜÖÔºåÂàô‰∏çËøõË°å‰ªª‰ΩïÊîπÂèò  
 322:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha;  
 323:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 324:../BLDCMotor/motorctrl.c ****     }
 325:../BLDCMotor/motorctrl.c ****     return uab;
 326:../BLDCMotor/motorctrl.c **** }
 327:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 328:../BLDCMotor/motorctrl.c **** dq_t _currmentloop(abc_t i_abc,float ele_theta)
 329:../BLDCMotor/motorctrl.c **** {
 330:../BLDCMotor/motorctrl.c **** #if 1
 331:../BLDCMotor/motorctrl.c ****     alpbet_t i_alphbeta;
 332:../BLDCMotor/motorctrl.c ****     float _tempa,_tempb,_tempc;
 333:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 334:../BLDCMotor/motorctrl.c ****     _tempa = i_abc.a;
 335:../BLDCMotor/motorctrl.c ****     _tempb = i_abc.b;
 336:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 337:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 338:../BLDCMotor/motorctrl.c ****     /*bac*/
 339:../BLDCMotor/motorctrl.c ****     i_abc.a = _tempa;
 340:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempc;
 341:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempb;
 342:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 343:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 344:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 345:../BLDCMotor/motorctrl.c **** 
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 8


 346:../BLDCMotor/motorctrl.c **** #endif
 347:../BLDCMotor/motorctrl.c **** 
 348:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 349:../BLDCMotor/motorctrl.c ****     i_abc.a = _tempa;
 350:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempb;
 351:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempc;
 352:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 353:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 354:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 355:../BLDCMotor/motorctrl.c **** #endif
 356:../BLDCMotor/motorctrl.c **** 
 357:../BLDCMotor/motorctrl.c ****     _3s_2s(i_abc,&i_alphbeta);   
 358:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 359:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 360:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 361:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 362:../BLDCMotor/motorctrl.c **** #if 1
 363:../BLDCMotor/motorctrl.c ****     float tar_id = 0.0f,tar_iq = 0.0f;
 364:../BLDCMotor/motorctrl.c ****     tar_id = sg_motordebug.id_targe;
 365:../BLDCMotor/motorctrl.c ****     tar_iq = sg_motordebug.iq_targe;
 366:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 367:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 368:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 369:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 370:../BLDCMotor/motorctrl.c **** #endif
 371:../BLDCMotor/motorctrl.c ****     return udq;
 372:../BLDCMotor/motorctrl.c **** #endif
 373:../BLDCMotor/motorctrl.c **** }
 374:../BLDCMotor/motorctrl.c **** 
 375:../BLDCMotor/motorctrl.c **** static void motor_enable(void)
 376:../BLDCMotor/motorctrl.c **** {
 377:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 378:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 379:../BLDCMotor/motorctrl.c **** #endif
 380:../BLDCMotor/motorctrl.c ****     /*pwm ‰ΩøËÉΩ*/
 381:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
 382:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
 383:../BLDCMotor/motorctrl.c ****     adc_start();
 384:../BLDCMotor/motorctrl.c **** }
 385:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 386:../BLDCMotor/motorctrl.c **** {
  58              		.loc 1 386 1 is_stmt 1 view -0
  59              		.cfi_startproc
  60              		@ args = 0, pretend = 0, frame = 0
  61              		@ frame_needed = 0, uses_anonymous_args = 0
  62 0000 08B5     		push	{r3, lr}
  63              	.LCFI0:
  64              		.cfi_def_cfa_offset 8
  65              		.cfi_offset 3, -8
  66              		.cfi_offset 14, -4
 387:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 388:../BLDCMotor/motorctrl.c ****     gpio_setmotor_power();
 389:../BLDCMotor/motorctrl.c **** #endif
 390:../BLDCMotor/motorctrl.c ****     /*pwm ‰ΩøËÉΩ*/
 391:../BLDCMotor/motorctrl.c ****     tim_pwm_enable();
  67              		.loc 1 391 5 view .LVU7
  68 0002 FFF7FEFF 		bl	tim_pwm_enable
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 9


  69              	.LVL0:
 392:../BLDCMotor/motorctrl.c **** }
  70              		.loc 1 392 1 is_stmt 0 view .LVU8
  71 0006 08BD     		pop	{r3, pc}
  72              		.cfi_endproc
  73              	.LFE374:
  75              		.section	.text.motor_set_pwm,"ax",%progbits
  76              		.align	1
  77              		.syntax unified
  78              		.thumb
  79              		.thumb_func
  81              	motor_set_pwm:
  82              	.LFB376:
 393:../BLDCMotor/motorctrl.c **** static void motor_disable(void)
 394:../BLDCMotor/motorctrl.c **** {
 395:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 396:../BLDCMotor/motorctrl.c ****     gpio_setmotor_powerdown();
 397:../BLDCMotor/motorctrl.c **** #endif    
 398:../BLDCMotor/motorctrl.c ****     tim_pwm_disable();
 399:../BLDCMotor/motorctrl.c ****     adc_stop();
 400:../BLDCMotor/motorctrl.c **** }
 401:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 402:../BLDCMotor/motorctrl.c **** {
  83              		.loc 1 402 1 is_stmt 1 view -0
  84              		.cfi_startproc
  85              		@ args = 0, pretend = 0, frame = 16
  86              		@ frame_needed = 0, uses_anonymous_args = 0
  87 0000 00B5     		push	{lr}
  88              	.LCFI1:
  89              		.cfi_def_cfa_offset 4
  90              		.cfi_offset 14, -4
  91 0002 85B0     		sub	sp, sp, #20
  92              	.LCFI2:
  93              		.cfi_def_cfa_offset 24
  94 0004 8DED010A 		vstr.32	s0, [sp, #4]
  95 0008 CDED020A 		vstr.32	s1, [sp, #8]
  96 000c 8DED031A 		vstr.32	s2, [sp, #12]
 403:../BLDCMotor/motorctrl.c ****     tim_set_pwm(temp._a,temp._b,temp._c);
  97              		.loc 1 403 5 view .LVU10
  98 0010 FFF7FEFF 		bl	tim_set_pwm
  99              	.LVL1:
 404:../BLDCMotor/motorctrl.c **** }
 100              		.loc 1 404 1 is_stmt 0 view .LVU11
 101 0014 05B0     		add	sp, sp, #20
 102              	.LCFI3:
 103              		.cfi_def_cfa_offset 4
 104              		@ sp needed
 105 0016 5DF804FB 		ldr	pc, [sp], #4
 106              		.cfi_endproc
 107              	.LFE376:
 109              		.section	.text.motor_enable,"ax",%progbits
 110              		.align	1
 111              		.syntax unified
 112              		.thumb
 113              		.thumb_func
 115              	motor_enable:
 116              	.LFB373:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 10


 376:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 117              		.loc 1 376 1 is_stmt 1 view -0
 118              		.cfi_startproc
 119              		@ args = 0, pretend = 0, frame = 0
 120              		@ frame_needed = 0, uses_anonymous_args = 0
 121 0000 08B5     		push	{r3, lr}
 122              	.LCFI4:
 123              		.cfi_def_cfa_offset 8
 124              		.cfi_offset 3, -8
 125              		.cfi_offset 14, -4
 381:../BLDCMotor/motorctrl.c ****     tim_tigger_adc();
 126              		.loc 1 381 5 view .LVU13
 127 0002 FFF7FEFF 		bl	tim_pwm_enable
 128              	.LVL2:
 382:../BLDCMotor/motorctrl.c ****     adc_start();
 129              		.loc 1 382 5 view .LVU14
 130 0006 FFF7FEFF 		bl	tim_tigger_adc
 131              	.LVL3:
 383:../BLDCMotor/motorctrl.c **** }
 132              		.loc 1 383 5 view .LVU15
 133 000a FFF7FEFF 		bl	adc_start
 134              	.LVL4:
 384:../BLDCMotor/motorctrl.c **** static void motor_enable_noirq(void)
 135              		.loc 1 384 1 is_stmt 0 view .LVU16
 136 000e 08BD     		pop	{r3, pc}
 137              		.cfi_endproc
 138              	.LFE373:
 140              		.section	.text.motor_disable,"ax",%progbits
 141              		.align	1
 142              		.syntax unified
 143              		.thumb
 144              		.thumb_func
 146              	motor_disable:
 147              	.LFB375:
 394:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32H723
 148              		.loc 1 394 1 is_stmt 1 view -0
 149              		.cfi_startproc
 150              		@ args = 0, pretend = 0, frame = 0
 151              		@ frame_needed = 0, uses_anonymous_args = 0
 152 0000 08B5     		push	{r3, lr}
 153              	.LCFI5:
 154              		.cfi_def_cfa_offset 8
 155              		.cfi_offset 3, -8
 156              		.cfi_offset 14, -4
 398:../BLDCMotor/motorctrl.c ****     adc_stop();
 157              		.loc 1 398 5 view .LVU18
 158 0002 FFF7FEFF 		bl	tim_pwm_disable
 159              	.LVL5:
 399:../BLDCMotor/motorctrl.c **** }
 160              		.loc 1 399 5 view .LVU19
 161 0006 FFF7FEFF 		bl	adc_stop
 162              	.LVL6:
 400:../BLDCMotor/motorctrl.c **** static void motor_set_pwm(duty_t temp)
 163              		.loc 1 400 1 is_stmt 0 view .LVU20
 164 000a 08BD     		pop	{r3, pc}
 165              		.cfi_endproc
 166              	.LFE375:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 11


 168              		.section	.text._get_angleoffset,"ax",%progbits
 169              		.align	1
 170              		.syntax unified
 171              		.thumb
 172              		.thumb_func
 174              	_get_angleoffset:
 175              	.LFB377:
 405:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void)
 406:../BLDCMotor/motorctrl.c **** {
 176              		.loc 1 406 1 is_stmt 1 view -0
 177              		.cfi_startproc
 178              		@ args = 0, pretend = 0, frame = 48
 179              		@ frame_needed = 0, uses_anonymous_args = 0
 180 0000 30B5     		push	{r4, r5, lr}
 181              	.LCFI6:
 182              		.cfi_def_cfa_offset 12
 183              		.cfi_offset 4, -12
 184              		.cfi_offset 5, -8
 185              		.cfi_offset 14, -4
 186 0002 8FB0     		sub	sp, sp, #60
 187              	.LCFI7:
 188              		.cfi_def_cfa_offset 72
 407:../BLDCMotor/motorctrl.c ****     motor_enable_noirq();
 189              		.loc 1 407 5 view .LVU22
 190 0004 FFF7FEFF 		bl	motor_enable_noirq
 191              	.LVL7:
 408:../BLDCMotor/motorctrl.c ****     /*-----------ËÆæÁΩÆalpha/betaÂùêÊ†áÁ≥ª------------------*/
 409:../BLDCMotor/motorctrl.c ****     alpbet_t uab = {1.0f,0.0f};
 192              		.loc 1 409 5 view .LVU23
 193              		.loc 1 409 14 is_stmt 0 view .LVU24
 194 0008 0025     		movs	r5, #0
 195 000a 0A95     		str	r5, [sp, #40]
 196 000c 0B95     		str	r5, [sp, #44]
 197 000e 0C95     		str	r5, [sp, #48]
 198 0010 0D95     		str	r5, [sp, #52]
 199 0012 4FF07E52 		mov	r2, #1065353216
 200 0016 0A92     		str	r2, [sp, #40]	@ float
 410:../BLDCMotor/motorctrl.c ****     duty_t dut01;
 201              		.loc 1 410 5 is_stmt 1 view .LVU25
 411:../BLDCMotor/motorctrl.c ****     float theta;
 202              		.loc 1 411 5 view .LVU26
 412:../BLDCMotor/motorctrl.c **** 
 413:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32H723 
 414:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 415:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 416:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 417:../BLDCMotor/motorctrl.c ****         tim_encode_writecnt(0);
 418:../BLDCMotor/motorctrl.c ****         theta = 0.0f;
 419:../BLDCMotor/motorctrl.c ****         // motor_disable();
 420:../BLDCMotor/motorctrl.c ****         return theta;
 421:../BLDCMotor/motorctrl.c ****     #endif
 422:../BLDCMotor/motorctrl.c **** 
 423:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32G4_MCB
 424:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 425:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 426:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 427:../BLDCMotor/motorctrl.c ****         tim_encode_writecnt(4095);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 12


 428:../BLDCMotor/motorctrl.c ****         theta = 0.0f;
 429:../BLDCMotor/motorctrl.c ****         motor_disable();
 430:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 431:../BLDCMotor/motorctrl.c ****         return theta;
 432:../BLDCMotor/motorctrl.c ****     #endif
 433:../BLDCMotor/motorctrl.c **** 
 434:../BLDCMotor/motorctrl.c ****     #ifdef BOARD_STM32G431
 435:../BLDCMotor/motorctrl.c ****         dq_t udq = {0.0f,1.0f};
 203              		.loc 1 435 9 view .LVU27
 204              		.loc 1 435 14 is_stmt 0 view .LVU28
 205 0018 03AB     		add	r3, sp, #12
 206 001a 0395     		str	r5, [sp, #12]
 207 001c 0495     		str	r5, [sp, #16]
 208 001e 0595     		str	r5, [sp, #20]
 209 0020 0695     		str	r5, [sp, #24]
 210 0022 0492     		str	r2, [sp, #16]	@ float
 436:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq,-PI_2);
 211              		.loc 1 436 9 is_stmt 1 view .LVU29
 212              		.loc 1 436 15 is_stmt 0 view .LVU30
 213 0024 0095     		str	r5, [sp]
 214 0026 0ECB     		ldm	r3, {r1, r2, r3}
 215 0028 9FED190A 		vldr.32	s0, .L16
 216 002c 0AA8     		add	r0, sp, #40
 217 002e FFF7FEFF 		bl	_2r_2s
 218              	.LVL8:
 437:../BLDCMotor/motorctrl.c ****         dut01 = _svpwm(uab.alpha,uab.beta);
 219              		.loc 1 437 9 is_stmt 1 view .LVU31
 220              		.loc 1 437 17 is_stmt 0 view .LVU32
 221 0032 DDED0B0A 		vldr.32	s1, [sp, #44]
 222 0036 9DED0A0A 		vldr.32	s0, [sp, #40]
 223 003a FFF7FEFF 		bl	_svpwm
 224              	.LVL9:
 225 003e 8DED070A 		vstr.32	s0, [sp, #28]
 226 0042 CDED080A 		vstr.32	s1, [sp, #32]
 227 0046 8DED091A 		vstr.32	s2, [sp, #36]
 438:../BLDCMotor/motorctrl.c ****         motor_set_pwm(dut01);
 228              		.loc 1 438 9 is_stmt 1 view .LVU33
 229 004a FFF7FEFF 		bl	motor_set_pwm
 230              	.LVL10:
 439:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);    
 231              		.loc 1 439 9 view .LVU34
 232 004e 4FF4FA70 		mov	r0, #500
 233 0052 FFF7FEFF 		bl	HAL_Delay
 234              	.LVL11:
 440:../BLDCMotor/motorctrl.c ****         motor_disable();
 235              		.loc 1 440 9 view .LVU35
 236 0056 FFF7FEFF 		bl	motor_disable
 237              	.LVL12:
 441:../BLDCMotor/motorctrl.c ****         HAL_Delay(500);
 238              		.loc 1 441 9 view .LVU36
 239 005a 4FF4FA70 		mov	r0, #500
 240 005e FFF7FEFF 		bl	HAL_Delay
 241              	.LVL13:
 442:../BLDCMotor/motorctrl.c ****         int32_t Q15_theta;
 242              		.loc 1 442 9 view .LVU37
 443:../BLDCMotor/motorctrl.c ****         int32_t Q_thetaSum = 0;
 243              		.loc 1 443 9 view .LVU38
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 13


 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 244              		.loc 1 444 9 view .LVU39
 245              	.LBB2:
 246              		.loc 1 444 14 view .LVU40
 247              		.loc 1 444 22 is_stmt 0 view .LVU41
 248 0062 2C46     		mov	r4, r5
 249              		.loc 1 444 9 view .LVU42
 250 0064 07E0     		b	.L13
 251              	.LVL14:
 252              	.L14:
 445:../BLDCMotor/motorctrl.c ****         {
 446:../BLDCMotor/motorctrl.c ****             Q_thetaSum += ((int32_t*)(sensor_user_read(SENSOR_01,EN_SENSORDATA_COV)))[0];
 253              		.loc 1 446 13 is_stmt 1 discriminator 3 view .LVU43
 254              		.loc 1 446 39 is_stmt 0 discriminator 3 view .LVU44
 255 0066 0121     		movs	r1, #1
 256 0068 0020     		movs	r0, #0
 257 006a FFF7FEFF 		bl	sensor_user_read
 258              	.LVL15:
 259              		.loc 1 446 86 discriminator 3 view .LVU45
 260 006e 0368     		ldr	r3, [r0]
 261              		.loc 1 446 24 discriminator 3 view .LVU46
 262 0070 1D44     		add	r5, r5, r3
 263              	.LVL16:
 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 264              		.loc 1 444 37 is_stmt 1 discriminator 3 view .LVU47
 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 265              		.loc 1 444 38 is_stmt 0 discriminator 3 view .LVU48
 266 0072 0134     		adds	r4, r4, #1
 267              	.LVL17:
 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 268              		.loc 1 444 38 discriminator 3 view .LVU49
 269 0074 E4B2     		uxtb	r4, r4
 270              	.LVL18:
 271              	.L13:
 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 272              		.loc 1 444 29 is_stmt 1 discriminator 1 view .LVU50
 444:../BLDCMotor/motorctrl.c ****         for (uint8_t i = 0; i < 10; i++)
 273              		.loc 1 444 9 is_stmt 0 discriminator 1 view .LVU51
 274 0076 092C     		cmp	r4, #9
 275 0078 F5D9     		bls	.L14
 276              	.LBE2:
 447:../BLDCMotor/motorctrl.c ****         }
 448:../BLDCMotor/motorctrl.c ****         Q15_theta = Q_thetaSum/10;        
 277              		.loc 1 448 9 is_stmt 1 view .LVU52
 278              		.loc 1 448 19 is_stmt 0 view .LVU53
 279 007a 0648     		ldr	r0, .L16+4
 280 007c 80FB0530 		smull	r3, r0, r0, r5
 281 0080 ED17     		asrs	r5, r5, #31
 282              	.LVL19:
 449:../BLDCMotor/motorctrl.c ****         theta = _IQ20toF(Q15_theta);
 283              		.loc 1 449 9 is_stmt 1 view .LVU54
 284              		.loc 1 449 17 is_stmt 0 view .LVU55
 285 0082 C5EBA000 		rsb	r0, r5, r0, asr #2
 286              	.LVL20:
 287              		.loc 1 449 17 view .LVU56
 288 0086 FFF7FEFF 		bl	_IQ20toF
 289              	.LVL21:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 14


 450:../BLDCMotor/motorctrl.c ****         return theta;
 290              		.loc 1 450 9 is_stmt 1 view .LVU57
 451:../BLDCMotor/motorctrl.c ****     #endif
 452:../BLDCMotor/motorctrl.c **** }
 291              		.loc 1 452 1 is_stmt 0 view .LVU58
 292 008a 0FB0     		add	sp, sp, #60
 293              	.LCFI8:
 294              		.cfi_def_cfa_offset 12
 295              		@ sp needed
 296 008c 30BD     		pop	{r4, r5, pc}
 297              	.LVL22:
 298              	.L17:
 299              		.loc 1 452 1 view .LVU59
 300 008e 00BF     		.align	2
 301              	.L16:
 302 0090 D80FC9BF 		.word	-1077342248
 303 0094 67666666 		.word	1717986919
 304              		.cfi_endproc
 305              	.LFE377:
 307              		.section	.text._currmentloop,"ax",%progbits
 308              		.align	1
 309              		.syntax unified
 310              		.thumb
 311              		.thumb_func
 313              	_currmentloop:
 314              	.LVL23:
 315              	.LFB372:
 329:../BLDCMotor/motorctrl.c **** #if 1
 316              		.loc 1 329 1 is_stmt 1 view -0
 317              		.cfi_startproc
 318              		@ args = 28, pretend = 16, frame = 32
 319              		@ frame_needed = 0, uses_anonymous_args = 0
 329:../BLDCMotor/motorctrl.c **** #if 1
 320              		.loc 1 329 1 is_stmt 0 view .LVU61
 321 0000 84B0     		sub	sp, sp, #16
 322              	.LCFI9:
 323              		.cfi_def_cfa_offset 16
 324 0002 70B5     		push	{r4, r5, r6, lr}
 325              	.LCFI10:
 326              		.cfi_def_cfa_offset 32
 327              		.cfi_offset 4, -32
 328              		.cfi_offset 5, -28
 329              		.cfi_offset 6, -24
 330              		.cfi_offset 14, -20
 331 0004 2DED028B 		vpush.64	{d8}
 332              	.LCFI11:
 333              		.cfi_def_cfa_offset 40
 334              		.cfi_offset 80, -40
 335              		.cfi_offset 81, -36
 336 0008 8CB0     		sub	sp, sp, #48
 337              	.LCFI12:
 338              		.cfi_def_cfa_offset 88
 339 000a 0446     		mov	r4, r0
 340 000c 0DF14C0C 		add	ip, sp, #76
 341 0010 8CE80E00 		stm	ip, {r1, r2, r3}
 342 0014 B0EE408A 		vmov.f32	s16, s0
 331:../BLDCMotor/motorctrl.c ****     float _tempa,_tempb,_tempc;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 15


 343              		.loc 1 331 5 is_stmt 1 view .LVU62
 332:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 344              		.loc 1 332 5 view .LVU63
 333:../BLDCMotor/motorctrl.c ****     _tempa = i_abc.a;
 345              		.loc 1 333 5 view .LVU64
 334:../BLDCMotor/motorctrl.c ****     _tempb = i_abc.b;
 346              		.loc 1 334 5 view .LVU65
 347              	.LVL24:
 335:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 348              		.loc 1 335 5 view .LVU66
 335:../BLDCMotor/motorctrl.c ****     _tempc = i_abc.c;
 349              		.loc 1 335 12 is_stmt 0 view .LVU67
 350 0018 149B     		ldr	r3, [sp, #80]	@ float
 351              	.LVL25:
 336:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 352              		.loc 1 336 5 is_stmt 1 view .LVU68
 336:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G431
 353              		.loc 1 336 12 is_stmt 0 view .LVU69
 354 001a 159A     		ldr	r2, [sp, #84]	@ float
 355              	.LVL26:
 339:../BLDCMotor/motorctrl.c ****     i_abc.b = _tempc;
 356              		.loc 1 339 5 is_stmt 1 view .LVU70
 340:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempb;
 357              		.loc 1 340 5 view .LVU71
 340:../BLDCMotor/motorctrl.c ****     i_abc.c = _tempb;
 358              		.loc 1 340 13 is_stmt 0 view .LVU72
 359 001c 1492     		str	r2, [sp, #80]	@ float
 341:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 360              		.loc 1 341 5 is_stmt 1 view .LVU73
 341:../BLDCMotor/motorctrl.c ****     sg_motordebug.ia = i_abc.a;
 361              		.loc 1 341 13 is_stmt 0 view .LVU74
 362 001e 1593     		str	r3, [sp, #84]	@ float
 342:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 363              		.loc 1 342 5 is_stmt 1 view .LVU75
 342:../BLDCMotor/motorctrl.c ****     sg_motordebug.ib = i_abc.b;
 364              		.loc 1 342 22 is_stmt 0 view .LVU76
 365 0020 214D     		ldr	r5, .L20
 366 0022 1399     		ldr	r1, [sp, #76]	@ float
 367 0024 6960     		str	r1, [r5, #4]	@ float
 343:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 368              		.loc 1 343 5 is_stmt 1 view .LVU77
 343:../BLDCMotor/motorctrl.c ****     sg_motordebug.ic = i_abc.c;
 369              		.loc 1 343 22 is_stmt 0 view .LVU78
 370 0026 AA60     		str	r2, [r5, #8]	@ float
 344:../BLDCMotor/motorctrl.c **** 
 371              		.loc 1 344 5 is_stmt 1 view .LVU79
 344:../BLDCMotor/motorctrl.c **** 
 372              		.loc 1 344 22 is_stmt 0 view .LVU80
 373 0028 EB60     		str	r3, [r5, #12]	@ float
 357:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 374              		.loc 1 357 5 is_stmt 1 view .LVU81
 375 002a 08AE     		add	r6, sp, #32
 376 002c 0296     		str	r6, [sp, #8]
 377 002e 17AB     		add	r3, sp, #92
 378 0030 93E80300 		ldm	r3, {r0, r1}
 379              	.LVL27:
 357:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 16


 380              		.loc 1 357 5 is_stmt 0 view .LVU82
 381 0034 8DE80300 		stm	sp, {r0, r1}
 382 0038 9CE80F00 		ldm	ip, {r0, r1, r2, r3}
 383              	.LVL28:
 357:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,((ele_theta)),&i_dq);
 384              		.loc 1 357 5 view .LVU83
 385 003c FFF7FEFF 		bl	_3s_2s
 386              	.LVL29:
 358:../BLDCMotor/motorctrl.c ****     sg_motordebug.id = (i_dq.d);
 387              		.loc 1 358 5 is_stmt 1 view .LVU84
 388 0040 04AB     		add	r3, sp, #16
 389 0042 0093     		str	r3, [sp]
 390 0044 B0EE480A 		vmov.f32	s0, s16
 391 0048 96E80F00 		ldm	r6, {r0, r1, r2, r3}
 392 004c FFF7FEFF 		bl	_2s_2r
 393              	.LVL30:
 359:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 394              		.loc 1 359 5 view .LVU85
 359:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 395              		.loc 1 359 29 is_stmt 0 view .LVU86
 396 0050 DDED040A 		vldr.32	s1, [sp, #16]
 359:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq = (i_dq.q);
 397              		.loc 1 359 22 view .LVU87
 398 0054 C5ED060A 		vstr.32	s1, [r5, #24]
 360:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 399              		.loc 1 360 5 is_stmt 1 view .LVU88
 360:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 400              		.loc 1 360 29 is_stmt 0 view .LVU89
 401 0058 059B     		ldr	r3, [sp, #20]	@ float
 360:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f};
 402              		.loc 1 360 22 view .LVU90
 403 005a EB61     		str	r3, [r5, #28]	@ float
 361:../BLDCMotor/motorctrl.c **** #if 1
 404              		.loc 1 361 5 is_stmt 1 view .LVU91
 361:../BLDCMotor/motorctrl.c **** #if 1
 405              		.loc 1 361 10 is_stmt 0 view .LVU92
 406 005c 0023     		movs	r3, #0
 407 005e 2360     		str	r3, [r4]
 408 0060 6360     		str	r3, [r4, #4]
 409 0062 A360     		str	r3, [r4, #8]
 410 0064 E360     		str	r3, [r4, #12]
 363:../BLDCMotor/motorctrl.c ****     tar_id = sg_motordebug.id_targe;
 411              		.loc 1 363 5 is_stmt 1 view .LVU93
 412              	.LVL31:
 364:../BLDCMotor/motorctrl.c ****     tar_iq = sg_motordebug.iq_targe;
 413              		.loc 1 364 5 view .LVU94
 365:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 414              		.loc 1 365 5 view .LVU95
 365:../BLDCMotor/motorctrl.c ****     udq.d = pid_contrl(sgp_curloop_d_pid,tar_id,i_dq.d);
 415              		.loc 1 365 12 is_stmt 0 view .LVU96
 416 0066 95ED128A 		vldr.32	s16, [r5, #72]
 417              	.LVL32:
 366:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 418              		.loc 1 366 5 is_stmt 1 view .LVU97
 366:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 419              		.loc 1 366 13 is_stmt 0 view .LVU98
 420 006a 95ED110A 		vldr.32	s0, [r5, #68]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 17


 421 006e 0F4B     		ldr	r3, .L20+4
 422 0070 1868     		ldr	r0, [r3]
 423 0072 FFF7FEFF 		bl	pid_contrl
 424              	.LVL33:
 366:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d;
 425              		.loc 1 366 11 view .LVU99
 426 0076 84ED000A 		vstr.32	s0, [r4]
 367:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 427              		.loc 1 367 5 is_stmt 1 view .LVU100
 367:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 428              		.loc 1 367 33 is_stmt 0 view .LVU101
 429 007a 049B     		ldr	r3, [sp, #16]	@ float
 367:../BLDCMotor/motorctrl.c ****     udq.q =pid_contrl(sgp_curloop_q_pid,tar_iq,i_dq.q);
 430              		.loc 1 367 27 view .LVU102
 431 007c EB63     		str	r3, [r5, #60]	@ float
 368:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 432              		.loc 1 368 5 is_stmt 1 view .LVU103
 368:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 433              		.loc 1 368 12 is_stmt 0 view .LVU104
 434 007e DDED050A 		vldr.32	s1, [sp, #20]
 435 0082 B0EE480A 		vmov.f32	s0, s16
 436 0086 0A4B     		ldr	r3, .L20+8
 437 0088 1868     		ldr	r0, [r3]
 438 008a FFF7FEFF 		bl	pid_contrl
 439              	.LVL34:
 368:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q;
 440              		.loc 1 368 11 view .LVU105
 441 008e 84ED010A 		vstr.32	s0, [r4, #4]
 369:../BLDCMotor/motorctrl.c **** #endif
 442              		.loc 1 369 5 is_stmt 1 view .LVU106
 369:../BLDCMotor/motorctrl.c **** #endif
 443              		.loc 1 369 33 is_stmt 0 view .LVU107
 444 0092 059B     		ldr	r3, [sp, #20]	@ float
 369:../BLDCMotor/motorctrl.c **** #endif
 445              		.loc 1 369 27 view .LVU108
 446 0094 2B65     		str	r3, [r5, #80]	@ float
 371:../BLDCMotor/motorctrl.c **** #endif
 447              		.loc 1 371 5 is_stmt 1 view .LVU109
 373:../BLDCMotor/motorctrl.c **** 
 448              		.loc 1 373 1 is_stmt 0 view .LVU110
 449 0096 2046     		mov	r0, r4
 450 0098 0CB0     		add	sp, sp, #48
 451              	.LCFI13:
 452              		.cfi_def_cfa_offset 40
 453              		@ sp needed
 454 009a BDEC028B 		vldm	sp!, {d8}
 455              	.LCFI14:
 456              		.cfi_restore 80
 457              		.cfi_restore 81
 458              		.cfi_def_cfa_offset 32
 459              	.LVL35:
 373:../BLDCMotor/motorctrl.c **** 
 460              		.loc 1 373 1 view .LVU111
 461 009e BDE87040 		pop	{r4, r5, r6, lr}
 462              	.LCFI15:
 463              		.cfi_restore 14
 464              		.cfi_restore 6
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 18


 465              		.cfi_restore 5
 466              		.cfi_restore 4
 467              		.cfi_def_cfa_offset 16
 468              	.LVL36:
 373:../BLDCMotor/motorctrl.c **** 
 469              		.loc 1 373 1 view .LVU112
 470 00a2 04B0     		add	sp, sp, #16
 471              	.LCFI16:
 472              		.cfi_def_cfa_offset 0
 473 00a4 7047     		bx	lr
 474              	.L21:
 475 00a6 00BF     		.align	2
 476              	.L20:
 477 00a8 00000000 		.word	.LANCHOR0
 478 00ac 00000000 		.word	.LANCHOR1
 479 00b0 00000000 		.word	.LANCHOR2
 480              		.cfi_endproc
 481              	.LFE372:
 483              		.global	__aeabi_f2d
 484              		.global	__aeabi_d2f
 485              		.section	.text._limit_voltagecircle,"ax",%progbits
 486              		.align	1
 487              		.global	_limit_voltagecircle
 488              		.syntax unified
 489              		.thumb
 490              		.thumb_func
 492              	_limit_voltagecircle:
 493              	.LVL37:
 494              	.LFB338:
 311:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 495              		.loc 1 311 49 is_stmt 1 view -0
 496              		.cfi_startproc
 497              		@ args = 20, pretend = 16, frame = 0
 498              		@ frame_needed = 0, uses_anonymous_args = 0
 311:../BLDCMotor/motorctrl.c ****     float max_voltage = D_MAX_VAL;// ËøôÈáåÂ∫îËØ•ÊòØ‰Ω†ÁöÑÊúÄÂ§ßÂÖÅËÆ∏ÁîµÂéãÂÄºÔºå‰æãÂ¶ÇÂØπ‰∫é‰∏âÁõ
 499              		.loc 1 311 49 is_stmt 0 view .LVU114
 500 0000 84B0     		sub	sp, sp, #16
 501              	.LCFI17:
 502              		.cfi_def_cfa_offset 16
 503 0002 10B5     		push	{r4, lr}
 504              	.LCFI18:
 505              		.cfi_def_cfa_offset 24
 506              		.cfi_offset 4, -24
 507              		.cfi_offset 14, -20
 508 0004 2DED028B 		vpush.64	{d8}
 509              	.LCFI19:
 510              		.cfi_def_cfa_offset 32
 511              		.cfi_offset 80, -32
 512              		.cfi_offset 81, -28
 513 0008 0446     		mov	r4, r0
 514 000a 05A8     		add	r0, sp, #20
 515 000c 80E80E00 		stm	r0, {r1, r2, r3}
 312:../BLDCMotor/motorctrl.c ****     float voltage_magnitude = sqrt(raw_uab.alpha * raw_uab.alpha + raw_uab.beta * raw_uab.beta); //
 516              		.loc 1 312 5 is_stmt 1 view .LVU115
 517              	.LVL38:
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 518              		.loc 1 313 5 view .LVU116
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 19


 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 519              		.loc 1 313 43 is_stmt 0 view .LVU117
 520 0010 DDED058A 		vldr.32	s17, [sp, #20]
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 521              		.loc 1 313 50 view .LVU118
 522 0014 28EEA87A 		vmul.f32	s14, s17, s17
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 523              		.loc 1 313 75 view .LVU119
 524 0018 9DED068A 		vldr.32	s16, [sp, #24]
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 525              		.loc 1 313 81 view .LVU120
 526 001c 68EE087A 		vmul.f32	s15, s16, s16
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 527              		.loc 1 313 31 view .LVU121
 528 0020 77EE277A 		vadd.f32	s15, s14, s15
 529 0024 17EE900A 		vmov	r0, s15
 530              	.LVL39:
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 531              		.loc 1 313 31 view .LVU122
 532 0028 FFF7FEFF 		bl	__aeabi_f2d
 533              	.LVL40:
 534 002c 41EC100B 		vmov	d0, r0, r1
 535 0030 FFF7FEFF 		bl	sqrt
 536              	.LVL41:
 537 0034 51EC100B 		vmov	r0, r1, d0
 313:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 538              		.loc 1 313 11 view .LVU123
 539 0038 FFF7FEFF 		bl	__aeabi_d2f
 540              	.LVL42:
 541 003c 07EE900A 		vmov	s15, r0
 542              	.LVL43:
 314:../BLDCMotor/motorctrl.c ****     if (voltage_magnitude > max_voltage) {  
 543              		.loc 1 314 5 is_stmt 1 view .LVU124
 315:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 544              		.loc 1 315 5 view .LVU125
 315:../BLDCMotor/motorctrl.c ****         // Â¶ÇÊûúÁü¢ÈáèÈïøÂ∫¶Ë∂ÖËøáÊúÄÂ§ßÁîµÂéãÔºåÂàôÊåâÊØî‰æãÁº©ÊîæÁü¢Èáè‰ª•‰ΩøÂÖ∂ËêΩÂú®ÁîµÂéãÁü¢È
 545              		.loc 1 315 8 is_stmt 0 view .LVU126
 546 0040 B2EE0A7A 		vmov.f32	s14, #1.3e+1
 547 0044 F4EEC77A 		vcmpe.f32	s15, s14
 548 0048 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 549 004c 12DD     		ble	.L27
 550              	.LBB3:
 317:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 551              		.loc 1 317 9 is_stmt 1 view .LVU127
 317:../BLDCMotor/motorctrl.c ****         uab.alpha = raw_uab.alpha * scale_factor;  
 552              		.loc 1 317 15 is_stmt 0 view .LVU128
 553 004e F0EE476A 		vmov.f32	s13, s14
 554 0052 86EEA77A 		vdiv.f32	s14, s13, s15
 555              	.LVL44:
 318:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 556              		.loc 1 318 9 is_stmt 1 view .LVU129
 318:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 557              		.loc 1 318 35 is_stmt 0 view .LVU130
 558 0056 68EE878A 		vmul.f32	s17, s17, s14
 318:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta * scale_factor;  
 559              		.loc 1 318 19 view .LVU131
 560 005a C4ED008A 		vstr.32	s17, [r4]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 20


 319:../BLDCMotor/motorctrl.c ****     } else {  
 561              		.loc 1 319 9 is_stmt 1 view .LVU132
 319:../BLDCMotor/motorctrl.c ****     } else {  
 562              		.loc 1 319 33 is_stmt 0 view .LVU133
 563 005e 28EE078A 		vmul.f32	s16, s16, s14
 319:../BLDCMotor/motorctrl.c ****     } else {  
 564              		.loc 1 319 18 view .LVU134
 565 0062 84ED018A 		vstr.32	s16, [r4, #4]
 566              	.LVL45:
 567              	.L22:
 319:../BLDCMotor/motorctrl.c ****     } else {  
 568              		.loc 1 319 18 view .LVU135
 569              	.LBE3:
 326:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 570              		.loc 1 326 1 view .LVU136
 571 0066 2046     		mov	r0, r4
 572              	.LVL46:
 326:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 573              		.loc 1 326 1 view .LVU137
 574 0068 BDEC028B 		vldm	sp!, {d8}
 575              	.LCFI20:
 576              		.cfi_remember_state
 577              		.cfi_restore 80
 578              		.cfi_restore 81
 579              		.cfi_def_cfa_offset 24
 580 006c BDE81040 		pop	{r4, lr}
 581              	.LCFI21:
 582              		.cfi_restore 14
 583              		.cfi_restore 4
 584              		.cfi_def_cfa_offset 16
 585              	.LVL47:
 326:../BLDCMotor/motorctrl.c **** #include "arm_math.h"
 586              		.loc 1 326 1 view .LVU138
 587 0070 04B0     		add	sp, sp, #16
 588              	.LCFI22:
 589              		.cfi_def_cfa_offset 0
 590 0072 7047     		bx	lr
 591              	.LVL48:
 592              	.L27:
 593              	.LCFI23:
 594              		.cfi_restore_state
 322:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 595              		.loc 1 322 9 is_stmt 1 view .LVU139
 322:../BLDCMotor/motorctrl.c ****         uab.beta = raw_uab.beta;  
 596              		.loc 1 322 19 is_stmt 0 view .LVU140
 597 0074 C4ED008A 		vstr.32	s17, [r4]
 323:../BLDCMotor/motorctrl.c ****     }
 598              		.loc 1 323 9 is_stmt 1 view .LVU141
 323:../BLDCMotor/motorctrl.c ****     }
 599              		.loc 1 323 18 is_stmt 0 view .LVU142
 600 0078 84ED018A 		vstr.32	s16, [r4, #4]
 325:../BLDCMotor/motorctrl.c **** }
 601              		.loc 1 325 5 is_stmt 1 view .LVU143
 325:../BLDCMotor/motorctrl.c **** }
 602              		.loc 1 325 12 is_stmt 0 view .LVU144
 603 007c F3E7     		b	.L22
 604              		.cfi_endproc
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 21


 605              	.LFE338:
 607              		.section	.text.g431_angletest,"ax",%progbits
 608              		.align	1
 609              		.syntax unified
 610              		.thumb
 611              		.thumb_func
 613              	g431_angletest:
 614              	.LFB337:
 249:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 615              		.loc 1 249 1 is_stmt 1 view -0
 616              		.cfi_startproc
 617              		@ args = 24, pretend = 16, frame = 64
 618              		@ frame_needed = 0, uses_anonymous_args = 0
 619 0000 84B0     		sub	sp, sp, #16
 620              	.LCFI24:
 621              		.cfi_def_cfa_offset 16
 622 0002 70B5     		push	{r4, r5, r6, lr}
 623              	.LCFI25:
 624              		.cfi_def_cfa_offset 32
 625              		.cfi_offset 4, -32
 626              		.cfi_offset 5, -28
 627              		.cfi_offset 6, -24
 628              		.cfi_offset 14, -20
 629 0004 2DED028B 		vpush.64	{d8}
 630              	.LCFI26:
 631              		.cfi_def_cfa_offset 40
 632              		.cfi_offset 80, -40
 633              		.cfi_offset 81, -36
 634 0008 94B0     		sub	sp, sp, #80
 635              	.LCFI27:
 636              		.cfi_def_cfa_offset 120
 637 000a 1AAC     		add	r4, sp, #104
 638 000c 84E80F00 		stm	r4, {r0, r1, r2, r3}
 250:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;
 639              		.loc 1 250 5 view .LVU146
 251:../BLDCMotor/motorctrl.c ****     duty_t dut01;        
 640              		.loc 1 251 5 view .LVU147
 252:../BLDCMotor/motorctrl.c ****   unsigned int nCycleUsed = 0;
 641              		.loc 1 252 5 view .LVU148
 253:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
 642              		.loc 1 253 3 view .LVU149
 643              	.LVL49:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 644              		.loc 1 254 3 view .LVU150
 645              	.LBB4:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 646              		.loc 1 254 3 view .LVU151
 647 0010 FFF7FEFF 		bl	get_system_ticks
 648              	.LVL50:
 649 0014 0546     		mov	r5, r0
 650 0016 0C46     		mov	r4, r1
 651              	.LVL51:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 652              		.loc 1 254 3 is_stmt 0 view .LVU152
 653 0018 0022     		movs	r2, #0
 654              	.LBE4:
 253:../BLDCMotor/motorctrl.c ****   __cycleof__("full test",{nCycleUsed = _;}){
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 22


 655              		.loc 1 253 16 view .LVU153
 656 001a 1346     		mov	r3, r2
 657              	.LVL52:
 658              	.L31:
 659              	.LBB7:
 660              	.LBB5:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 661              		.loc 1 254 3 is_stmt 1 discriminator 5 view .LVU154
 662              	.LBE5:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 663              		.loc 1 254 3 discriminator 5 view .LVU155
 664 001c 02F10806 		add	r6, r2, #8
 665              	.LVL53:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 666              		.loc 1 254 3 is_stmt 0 discriminator 5 view .LVU156
 667 0020 0ABB     		cbnz	r2, .L30
 255:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 668              		.loc 1 255 5 is_stmt 1 view .LVU157
 255:../BLDCMotor/motorctrl.c ****     mech_theta = _IQ20toF(Q15_Mechtheta);
 669              		.loc 1 255 32 is_stmt 0 view .LVU158
 670 0022 0121     		movs	r1, #1
 671 0024 0020     		movs	r0, #0
 672 0026 FFF7FEFF 		bl	sensor_user_read
 673              	.LVL54:
 256:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 674              		.loc 1 256 5 is_stmt 1 view .LVU159
 256:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 675              		.loc 1 256 18 is_stmt 0 view .LVU160
 676 002a 0068     		ldr	r0, [r0]
 677              	.LVL55:
 256:../BLDCMotor/motorctrl.c ****     mech_theta -= sg_MecThetaOffset;
 678              		.loc 1 256 18 view .LVU161
 679 002c FFF7FEFF 		bl	_IQ20toF
 680              	.LVL56:
 257:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 681              		.loc 1 257 5 is_stmt 1 view .LVU162
 682 0030 314B     		ldr	r3, .L33
 683 0032 D3ED007A 		vldr.32	s15, [r3]
 257:../BLDCMotor/motorctrl.c ****     elec_theta = mech_theta * MOTOR_PAIR;
 684              		.loc 1 257 16 is_stmt 0 view .LVU163
 685 0036 30EE670A 		vsub.f32	s0, s0, s15
 686              	.LVL57:
 258:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 687              		.loc 1 258 5 is_stmt 1 view .LVU164
 259:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 688              		.loc 1 259 5 view .LVU165
 259:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 689              		.loc 1 259 18 is_stmt 0 view .LVU166
 690 003a 30EE000A 		vadd.f32	s0, s0, s0
 691              	.LVL58:
 259:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 692              		.loc 1 259 18 view .LVU167
 693 003e FFF7FEFF 		bl	_normalize_angle
 694              	.LVL59:
 259:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 695              		.loc 1 259 18 view .LVU168
 696 0042 B0EE408A 		vmov.f32	s16, s0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 23


 697              	.LVL60:
 260:../BLDCMotor/motorctrl.c ****   }
 698              		.loc 1 260 5 is_stmt 1 view .LVU169
 260:../BLDCMotor/motorctrl.c ****   }
 699              		.loc 1 260 29 is_stmt 0 view .LVU170
 700 0046 2D4B     		ldr	r3, .L33+4
 701 0048 83ED1B0A 		vstr.32	s0, [r3, #108]
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 702              		.loc 1 254 3 is_stmt 1 view .LVU171
 703              	.LBB6:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 704              		.loc 1 254 3 view .LVU172
 705 004c FFF7FEFF 		bl	get_system_ticks
 706              	.LVL61:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 707              		.loc 1 254 3 is_stmt 0 view .LVU173
 708 0050 401B     		subs	r0, r0, r5
 709 0052 61EB0404 		sbc	r4, r1, r4
 710 0056 2A4B     		ldr	r3, .L33+8
 711 0058 1B68     		ldr	r3, [r3]
 712 005a C51A     		subs	r5, r0, r3
 713 005c 64EBE374 		sbc	r4, r4, r3, asr #31
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 714              		.loc 1 254 3 is_stmt 1 view .LVU174
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 715              		.loc 1 254 3 view .LVU175
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 716              		.loc 1 254 3 view .LVU176
 717 0060 2B46     		mov	r3, r5
 718              	.LVL62:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 719              		.loc 1 254 3 is_stmt 0 view .LVU177
 720              	.LBE6:
 721 0062 3246     		mov	r2, r6
 722 0064 DAE7     		b	.L31
 723              	.L30:
 254:../BLDCMotor/motorctrl.c ****     Q15_Mechtheta = ((int32_t*)sensor_user_read(SENSOR_01,EN_SENSORDATA_COV))[0];
 724              		.loc 1 254 3 view .LVU178
 725              	.LBE7:
 262:../BLDCMotor/motorctrl.c **** 
 726              		.loc 1 262 3 is_stmt 1 view .LVU179
 262:../BLDCMotor/motorctrl.c **** 
 727              		.loc 1 262 30 is_stmt 0 view .LVU180
 728 0066 274A     		ldr	r2, .L33+12
 729 0068 A2FB0323 		umull	r2, r3, r2, r3
 730              	.LVL63:
 262:../BLDCMotor/motorctrl.c **** 
 731              		.loc 1 262 30 view .LVU181
 732 006c DB09     		lsrs	r3, r3, #7
 262:../BLDCMotor/motorctrl.c **** 
 733              		.loc 1 262 18 view .LVU182
 734 006e 264A     		ldr	r2, .L33+16
 735 0070 1360     		str	r3, [r2]
 736              	.LBB8:
 295:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
 737              		.loc 1 295 9 is_stmt 1 view .LVU183
 295:../BLDCMotor/motorctrl.c ****         alpbet_t uab,uab_q15;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 24


 738              		.loc 1 295 14 is_stmt 0 view .LVU184
 739 0072 264B     		ldr	r3, .L33+20
 740 0074 09AD     		add	r5, sp, #36
 741 0076 0FCB     		ldm	r3, {r0, r1, r2, r3}
 742 0078 85E80F00 		stm	r5, {r0, r1, r2, r3}
 296:../BLDCMotor/motorctrl.c ****         #if 0/*Èó≠ÁéØÊéßÂà∂*/
 743              		.loc 1 296 9 is_stmt 1 view .LVU185
 300:../BLDCMotor/motorctrl.c ****             udq.d = sg_motordebug.id_targe;
 744              		.loc 1 300 13 view .LVU186
 745 007c 04AE     		add	r6, sp, #16
 746 007e 1DAB     		add	r3, sp, #116
 747 0080 93E80700 		ldm	r3, {r0, r1, r2}
 748 0084 8DE80700 		stm	sp, {r0, r1, r2}
 749 0088 1AAB     		add	r3, sp, #104
 750 008a 0ECB     		ldm	r3, {r1, r2, r3}
 751 008c 9FED200A 		vldr.32	s0, .L33+24
 752 0090 38EE400A 		vsub.f32	s0, s16, s0
 753 0094 3046     		mov	r0, r6
 754 0096 FFF7FEFF 		bl	_currmentloop
 755              	.LVL64:
 301:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 756              		.loc 1 301 13 view .LVU187
 301:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 757              		.loc 1 301 34 is_stmt 0 view .LVU188
 758 009a 184B     		ldr	r3, .L33+4
 759 009c 5A6C     		ldr	r2, [r3, #68]	@ float
 301:../BLDCMotor/motorctrl.c ****             udq.q = sg_motordebug.iq_targe;
 760              		.loc 1 301 19 view .LVU189
 761 009e 0992     		str	r2, [sp, #36]	@ float
 302:../BLDCMotor/motorctrl.c ****         #endif
 762              		.loc 1 302 13 is_stmt 1 view .LVU190
 302:../BLDCMotor/motorctrl.c ****         #endif
 763              		.loc 1 302 34 is_stmt 0 view .LVU191
 764 00a0 9B6C     		ldr	r3, [r3, #72]	@ float
 302:../BLDCMotor/motorctrl.c ****         #endif
 765              		.loc 1 302 19 view .LVU192
 766 00a2 0A93     		str	r3, [sp, #40]	@ float
 304:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 767              		.loc 1 304 9 is_stmt 1 view .LVU193
 304:../BLDCMotor/motorctrl.c ****         uab = _limit_voltagecircle(uab);
 768              		.loc 1 304 15 is_stmt 0 view .LVU194
 769 00a4 0DAC     		add	r4, sp, #52
 770 00a6 0C9B     		ldr	r3, [sp, #48]
 771 00a8 0093     		str	r3, [sp]
 772 00aa 95E80E00 		ldm	r5, {r1, r2, r3}
 773 00ae B0EE480A 		vmov.f32	s0, s16
 774 00b2 2046     		mov	r0, r4
 775 00b4 FFF7FEFF 		bl	_2r_2s
 776              	.LVL65:
 305:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 777              		.loc 1 305 9 is_stmt 1 view .LVU195
 305:../BLDCMotor/motorctrl.c ****         motor_set_pwm(_svpwm(uab.alpha,uab.beta));
 778              		.loc 1 305 15 is_stmt 0 view .LVU196
 779 00b8 109B     		ldr	r3, [sp, #64]
 780 00ba 0093     		str	r3, [sp]
 781 00bc 94E80E00 		ldm	r4, {r1, r2, r3}
 782 00c0 3046     		mov	r0, r6
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 25


 783 00c2 FFF7FEFF 		bl	_limit_voltagecircle
 784              	.LVL66:
 785 00c6 96E80F00 		ldm	r6, {r0, r1, r2, r3}
 786 00ca 84E80F00 		stm	r4, {r0, r1, r2, r3}
 306:../BLDCMotor/motorctrl.c ****     }
 787              		.loc 1 306 9 is_stmt 1 view .LVU197
 788 00ce DDED0E0A 		vldr.32	s1, [sp, #56]
 789 00d2 9DED0D0A 		vldr.32	s0, [sp, #52]
 790 00d6 FFF7FEFF 		bl	_svpwm
 791              	.LVL67:
 792 00da 8DED110A 		vstr.32	s0, [sp, #68]
 793 00de CDED120A 		vstr.32	s1, [sp, #72]
 794 00e2 8DED131A 		vstr.32	s2, [sp, #76]
 795 00e6 FFF7FEFF 		bl	motor_set_pwm
 796              	.LVL68:
 797              	.LBE8:
 309:../BLDCMotor/motorctrl.c **** 
 798              		.loc 1 309 1 is_stmt 0 view .LVU198
 799 00ea 14B0     		add	sp, sp, #80
 800              	.LCFI28:
 801              		.cfi_def_cfa_offset 40
 802              		@ sp needed
 803 00ec BDEC028B 		vldm	sp!, {d8}
 804              	.LCFI29:
 805              		.cfi_restore 80
 806              		.cfi_restore 81
 807              		.cfi_def_cfa_offset 32
 808              	.LVL69:
 309:../BLDCMotor/motorctrl.c **** 
 809              		.loc 1 309 1 view .LVU199
 810 00f0 BDE87040 		pop	{r4, r5, r6, lr}
 811              	.LCFI30:
 812              		.cfi_restore 14
 813              		.cfi_restore 6
 814              		.cfi_restore 5
 815              		.cfi_restore 4
 816              		.cfi_def_cfa_offset 16
 817              	.LVL70:
 309:../BLDCMotor/motorctrl.c **** 
 818              		.loc 1 309 1 view .LVU200
 819 00f4 04B0     		add	sp, sp, #16
 820              	.LCFI31:
 821              		.cfi_def_cfa_offset 0
 822 00f6 7047     		bx	lr
 823              	.L34:
 824              		.align	2
 825              	.L33:
 826 00f8 00000000 		.word	.LANCHOR3
 827 00fc 00000000 		.word	.LANCHOR0
 828 0100 00000000 		.word	g_nOffset
 829 0104 C1C0C0C0 		.word	-1061109567
 830 0108 00000000 		.word	.LANCHOR4
 831 010c 00000000 		.word	.LANCHOR5
 832 0110 D80FC93F 		.word	1070141400
 833              		.cfi_endproc
 834              	.LFE337:
 836              		.section	.text._50uscycle_process,"ax",%progbits
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 26


 837              		.align	1
 838              		.global	_50uscycle_process
 839              		.syntax unified
 840              		.thumb
 841              		.thumb_func
 843              	_50uscycle_process:
 844              	.LVL71:
 845              	.LFB336:
 112:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 846              		.loc 1 112 1 is_stmt 1 view -0
 847              		.cfi_startproc
 848              		@ args = 0, pretend = 0, frame = 24
 849              		@ frame_needed = 0, uses_anonymous_args = 0
 112:../BLDCMotor/motorctrl.c ****     float elec_theta,mech_theta;
 850              		.loc 1 112 1 is_stmt 0 view .LVU202
 851 0000 10B5     		push	{r4, lr}
 852              	.LCFI32:
 853              		.cfi_def_cfa_offset 8
 854              		.cfi_offset 4, -8
 855              		.cfi_offset 14, -4
 856 0002 2DED028B 		vpush.64	{d8}
 857              	.LCFI33:
 858              		.cfi_def_cfa_offset 16
 859              		.cfi_offset 80, -16
 860              		.cfi_offset 81, -12
 861 0006 88B0     		sub	sp, sp, #32
 862              	.LCFI34:
 863              		.cfi_def_cfa_offset 48
 113:../BLDCMotor/motorctrl.c ****     int32_t Q15_Mechtheta;    
 864              		.loc 1 113 5 is_stmt 1 view .LVU203
 114:../BLDCMotor/motorctrl.c ****     duty_t dut01,dut02;
 865              		.loc 1 114 5 view .LVU204
 115:../BLDCMotor/motorctrl.c **** /*----------------‰∏âÁõ∏ÁîµÊµÅÂ§ÑÁêÜ------------------------------*/    
 866              		.loc 1 115 5 view .LVU205
 117:../BLDCMotor/motorctrl.c ****     int32_t a1,b1,c1;
 867              		.loc 1 117 5 view .LVU206
 118:../BLDCMotor/motorctrl.c ****     a1 = abc_vale[0] - A_ADCCHANNL_OFFSET;
 868              		.loc 1 118 5 view .LVU207
 119:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 869              		.loc 1 119 5 view .LVU208
 119:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 870              		.loc 1 119 18 is_stmt 0 view .LVU209
 871 0008 0268     		ldr	r2, [r0]
 119:../BLDCMotor/motorctrl.c ****     b1 = abc_vale[1] - B_ADCCHANNL_OFFSET;
 872              		.loc 1 119 22 view .LVU210
 873 000a A2F64902 		subw	r2, r2, #2121
 874              	.LVL72:
 120:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 875              		.loc 1 120 5 is_stmt 1 view .LVU211
 120:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 876              		.loc 1 120 18 is_stmt 0 view .LVU212
 877 000e 4368     		ldr	r3, [r0, #4]
 120:../BLDCMotor/motorctrl.c ****     c1 = abc_vale[2] - C_ADCCHANNL_OFFSET;
 878              		.loc 1 120 22 view .LVU213
 879 0010 A3F50563 		sub	r3, r3, #2128
 880 0014 08EE903A 		vmov	s17, r3	@ int
 881              	.LVL73:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 27


 121:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 882              		.loc 1 121 5 is_stmt 1 view .LVU214
 121:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 883              		.loc 1 121 18 is_stmt 0 view .LVU215
 884 0018 8368     		ldr	r3, [r0, #8]
 885              	.LVL74:
 121:../BLDCMotor/motorctrl.c ****     sg_motordebug.Q_ia = a1;
 886              		.loc 1 121 22 view .LVU216
 887 001a A3F66403 		subw	r3, r3, #2148
 888 001e 08EE103A 		vmov	s16, r3	@ int
 889              	.LVL75:
 122:../BLDCMotor/motorctrl.c **** 
 890              		.loc 1 122 5 is_stmt 1 view .LVU217
 122:../BLDCMotor/motorctrl.c **** 
 891              		.loc 1 122 24 is_stmt 0 view .LVU218
 892 0022 1C4B     		ldr	r3, .L37
 893              	.LVL76:
 122:../BLDCMotor/motorctrl.c **** 
 894              		.loc 1 122 24 view .LVU219
 895 0024 1A62     		str	r2, [r3, #32]
 124:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 896              		.loc 1 124 5 is_stmt 1 view .LVU220
 124:../BLDCMotor/motorctrl.c ****     Ib = (float)b1*(float)B_VOLITETOCURRENT_FACTOR;
 897              		.loc 1 124 10 is_stmt 0 view .LVU221
 898 0026 07EE902A 		vmov	s15, r2	@ int
 899 002a B8EEE70A 		vcvt.f32.s32	s0, s15
 900              	.LVL77:
 125:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 901              		.loc 1 125 5 is_stmt 1 view .LVU222
 125:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 902              		.loc 1 125 10 is_stmt 0 view .LVU223
 903 002e F8EEE88A 		vcvt.f32.s32	s17, s17
 904              	.LVL78:
 125:../BLDCMotor/motorctrl.c ****     Ic = (float)c1*(float)C_VOLITETOCURRENT_FACTOR;
 905              		.loc 1 125 8 view .LVU224
 906 0032 DFED197A 		vldr.32	s15, .L37+4
 907 0036 68EEA78A 		vmul.f32	s17, s17, s15
 908              	.LVL79:
 126:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 909              		.loc 1 126 5 is_stmt 1 view .LVU225
 126:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 910              		.loc 1 126 10 is_stmt 0 view .LVU226
 911 003a B8EEC88A 		vcvt.f32.s32	s16, s16
 912              	.LVL80:
 126:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 913              		.loc 1 126 8 view .LVU227
 914 003e DFED177A 		vldr.32	s15, .L37+8
 915 0042 28EE278A 		vmul.f32	s16, s16, s15
 916              	.LVL81:
 127:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 917              		.loc 1 127 5 is_stmt 1 view .LVU228
 128:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 918              		.loc 1 128 5 view .LVU229
 128:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 919              		.loc 1 128 15 is_stmt 0 view .LVU230
 920 0046 164C     		ldr	r4, .L37+12
 921 0048 DFED167A 		vldr.32	s15, .L37+16
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 28


 922 004c 20EE270A 		vmul.f32	s0, s0, s15
 923              	.LVL82:
 128:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 924              		.loc 1 128 15 view .LVU231
 925 0050 2046     		mov	r0, r4
 926              	.LVL83:
 128:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 927              		.loc 1 128 15 view .LVU232
 928 0052 FFF7FEFF 		bl	lowfilter_cale
 929              	.LVL84:
 128:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 930              		.loc 1 128 13 view .LVU233
 931 0056 8DED020A 		vstr.32	s0, [sp, #8]
 129:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 932              		.loc 1 129 5 is_stmt 1 view .LVU234
 129:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 933              		.loc 1 129 15 is_stmt 0 view .LVU235
 934 005a B0EE680A 		vmov.f32	s0, s17
 935 005e 04F10800 		add	r0, r4, #8
 936 0062 FFF7FEFF 		bl	lowfilter_cale
 937              	.LVL85:
 129:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 938              		.loc 1 129 13 view .LVU236
 939 0066 8DED030A 		vstr.32	s0, [sp, #12]
 130:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 940              		.loc 1 130 5 is_stmt 1 view .LVU237
 130:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 941              		.loc 1 130 15 is_stmt 0 view .LVU238
 942 006a B0EE480A 		vmov.f32	s0, s16
 943 006e 04F11000 		add	r0, r4, #16
 944 0072 FFF7FEFF 		bl	lowfilter_cale
 945              	.LVL86:
 130:../BLDCMotor/motorctrl.c **** #ifdef BOARD_STM32G4_MCB
 946              		.loc 1 130 13 view .LVU239
 947 0076 8DED040A 		vstr.32	s0, [sp, #16]
 243:../BLDCMotor/motorctrl.c **** #endif
 948              		.loc 1 243 5 is_stmt 1 view .LVU240
 949 007a 08AB     		add	r3, sp, #32
 950 007c 13E90300 		ldmdb	r3, {r0, r1}
 951 0080 8DE80300 		stm	sp, {r0, r1}
 952 0084 02AB     		add	r3, sp, #8
 953 0086 0FCB     		ldm	r3, {r0, r1, r2, r3}
 954 0088 FFF7FEFF 		bl	g431_angletest
 955              	.LVL87:
 245:../BLDCMotor/motorctrl.c **** }
 956              		.loc 1 245 5 view .LVU241
 246:../BLDCMotor/motorctrl.c **** 
 957              		.loc 1 246 1 is_stmt 0 view .LVU242
 958 008c 08B0     		add	sp, sp, #32
 959              	.LCFI35:
 960              		.cfi_def_cfa_offset 16
 961              		@ sp needed
 962 008e BDEC028B 		vldm	sp!, {d8}
 963              	.LCFI36:
 964              		.cfi_restore 80
 965              		.cfi_restore 81
 966              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 29


 967              	.LVL88:
 246:../BLDCMotor/motorctrl.c **** 
 968              		.loc 1 246 1 view .LVU243
 969 0092 10BD     		pop	{r4, pc}
 970              	.L38:
 971              		.align	2
 972              	.L37:
 973 0094 00000000 		.word	.LANCHOR0
 974 0098 713D0A3F 		.word	1057635697
 975 009c FFAFB23E 		.word	1051897855
 976 00a0 00000000 		.word	.LANCHOR6
 977 00a4 52B89E3E 		.word	1050589266
 978              		.cfi_endproc
 979              	.LFE336:
 981              		.section	.text.foc_paraminit,"ax",%progbits
 982              		.align	1
 983              		.global	foc_paraminit
 984              		.syntax unified
 985              		.thumb
 986              		.thumb_func
 988              	foc_paraminit:
 989              	.LFB378:
 453:../BLDCMotor/motorctrl.c **** 
 454:../BLDCMotor/motorctrl.c **** void foc_paraminit(void)
 455:../BLDCMotor/motorctrl.c **** {
 990              		.loc 1 455 1 is_stmt 1 view -0
 991              		.cfi_startproc
 992              		@ args = 0, pretend = 0, frame = 0
 993              		@ frame_needed = 0, uses_anonymous_args = 0
 994 0000 38B5     		push	{r3, r4, r5, lr}
 995              	.LCFI37:
 996              		.cfi_def_cfa_offset 16
 997              		.cfi_offset 3, -16
 998              		.cfi_offset 4, -12
 999              		.cfi_offset 5, -8
 1000              		.cfi_offset 14, -4
 1001 0002 2DED028B 		vpush.64	{d8}
 1002              	.LCFI38:
 1003              		.cfi_def_cfa_offset 24
 1004              		.cfi_offset 80, -24
 1005              		.cfi_offset 81, -20
 456:../BLDCMotor/motorctrl.c ****     sgp_curloop_d_pid = &(sg_curloop_param.d_pid);
 1006              		.loc 1 456 5 view .LVU245
 1007              		.loc 1 456 23 is_stmt 0 view .LVU246
 1008 0006 1D48     		ldr	r0, .L41
 1009 0008 1D4B     		ldr	r3, .L41+4
 1010 000a 1860     		str	r0, [r3]
 457:../BLDCMotor/motorctrl.c ****     sgp_curloop_q_pid = &sg_curloop_param.q_pid;
 1011              		.loc 1 457 5 is_stmt 1 view .LVU247
 1012              		.loc 1 457 23 is_stmt 0 view .LVU248
 1013 000c 1D4D     		ldr	r5, .L41+8
 1014 000e 00F11C03 		add	r3, r0, #28
 1015 0012 2B60     		str	r3, [r5]
 458:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_d_pid,sg_motordebug.pid_d_kp,sg_motordebug.pid_d_ki,0.001f,D_MAX_VAL,D_MIN
 1016              		.loc 1 458 5 is_stmt 1 view .LVU249
 1017 0014 9FED1C8A 		vldr.32	s16, .L41+12
 1018 0018 1C4C     		ldr	r4, .L41+16
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 30


 1019 001a BAEE0A2A 		vmov.f32	s4, #-1.3e+1
 1020 001e F2EE0A1A 		vmov.f32	s3, #1.3e+1
 1021 0022 B0EE481A 		vmov.f32	s2, s16
 1022 0026 D4ED1A0A 		vldr.32	s1, [r4, #104]
 1023 002a 94ED190A 		vldr.32	s0, [r4, #100]
 1024 002e FFF7FEFF 		bl	pid_init
 1025              	.LVL89:
 459:../BLDCMotor/motorctrl.c ****     pid_init(sgp_curloop_q_pid,sg_motordebug.pid_d_kp,sg_motordebug.pid_d_ki,0.001f,D_MAX_VAL,D_MIN
 1026              		.loc 1 459 5 view .LVU250
 1027 0032 BAEE0A2A 		vmov.f32	s4, #-1.3e+1
 1028 0036 F2EE0A1A 		vmov.f32	s3, #1.3e+1
 1029 003a B0EE481A 		vmov.f32	s2, s16
 1030 003e D4ED1A0A 		vldr.32	s1, [r4, #104]
 1031 0042 94ED190A 		vldr.32	s0, [r4, #100]
 1032 0046 2868     		ldr	r0, [r5]
 1033 0048 FFF7FEFF 		bl	pid_init
 1034              	.LVL90:
 460:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[0],80);
 1035              		.loc 1 460 5 view .LVU251
 1036 004c 9FED108A 		vldr.32	s16, .L41+20
 1037 0050 104C     		ldr	r4, .L41+24
 1038 0052 B0EE480A 		vmov.f32	s0, s16
 1039 0056 2046     		mov	r0, r4
 1040 0058 FFF7FEFF 		bl	lowfilter_init
 1041              	.LVL91:
 461:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[1],80);
 1042              		.loc 1 461 5 view .LVU252
 1043 005c B0EE480A 		vmov.f32	s0, s16
 1044 0060 04F10800 		add	r0, r4, #8
 1045 0064 FFF7FEFF 		bl	lowfilter_init
 1046              	.LVL92:
 462:../BLDCMotor/motorctrl.c ****     lowfilter_init(&sg_elefilter[2],80);
 1047              		.loc 1 462 5 view .LVU253
 1048 0068 B0EE480A 		vmov.f32	s0, s16
 1049 006c 04F11000 		add	r0, r4, #16
 1050 0070 FFF7FEFF 		bl	lowfilter_init
 1051              	.LVL93:
 463:../BLDCMotor/motorctrl.c **** }
 1052              		.loc 1 463 1 is_stmt 0 view .LVU254
 1053 0074 BDEC028B 		vldm	sp!, {d8}
 1054              	.LCFI39:
 1055              		.cfi_restore 80
 1056              		.cfi_restore 81
 1057              		.cfi_def_cfa_offset 16
 1058 0078 38BD     		pop	{r3, r4, r5, pc}
 1059              	.L42:
 1060 007a 00BF     		.align	2
 1061              	.L41:
 1062 007c 00000000 		.word	.LANCHOR7
 1063 0080 00000000 		.word	.LANCHOR1
 1064 0084 00000000 		.word	.LANCHOR2
 1065 0088 6F12833A 		.word	981668463
 1066 008c 00000000 		.word	.LANCHOR0
 1067 0090 0000A042 		.word	1117782016
 1068 0094 00000000 		.word	.LANCHOR6
 1069              		.cfi_endproc
 1070              	.LFE378:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 31


 1072              		.section	.text.motortctrl_process,"ax",%progbits
 1073              		.align	1
 1074              		.global	motortctrl_process
 1075              		.syntax unified
 1076              		.thumb
 1077              		.thumb_func
 1079              	motortctrl_process:
 1080              	.LFB335:
  62:../BLDCMotor/motorctrl.c ****     char rec_buf[64];
 1081              		.loc 1 62 1 is_stmt 1 view -0
 1082              		.cfi_startproc
 1083              		@ args = 0, pretend = 0, frame = 0
 1084              		@ frame_needed = 0, uses_anonymous_args = 0
 1085 0000 08B5     		push	{r3, lr}
 1086              	.LCFI40:
 1087              		.cfi_def_cfa_offset 8
 1088              		.cfi_offset 3, -8
 1089              		.cfi_offset 14, -4
  63:../BLDCMotor/motorctrl.c ****     char cnt = 0;
 1090              		.loc 1 63 5 view .LVU256
  64:../BLDCMotor/motorctrl.c ****     // if (readline_fromPC(rec_buf,sizeof(rec_buf)))
 1091              		.loc 1 64 5 view .LVU257
 1092              	.LVL94:
  69:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
 1093              		.loc 1 69 5 view .LVU258
 1094 0002 FFF7FEFF 		bl	motorprotocol_process
 1095              	.LVL95:
  70:../BLDCMotor/motorctrl.c ****     {
 1096              		.loc 1 70 5 view .LVU259
  70:../BLDCMotor/motorctrl.c ****     {
 1097              		.loc 1 70 21 is_stmt 0 view .LVU260
 1098 0006 1A4B     		ldr	r3, .L52
 1099 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  70:../BLDCMotor/motorctrl.c ****     {
 1100              		.loc 1 70 5 view .LVU261
 1101 000a 042B     		cmp	r3, #4
 1102 000c 2BD8     		bhi	.L43
 1103 000e DFE803F0 		tbb	[pc, r3]
 1104              	.L46:
 1105 0012 03       		.byte	(.L49-.L46)/2
 1106 0013 26       		.byte	(.L48-.L46)/2
 1107 0014 2A       		.byte	(.L43-.L46)/2
 1108 0015 15       		.byte	(.L47-.L46)/2
 1109 0016 21       		.byte	(.L45-.L46)/2
 1110 0017 00       		.p2align 1
 1111              	.L49:
  73:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1112              		.loc 1 73 9 is_stmt 1 view .LVU262
  73:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1113              		.loc 1 73 29 is_stmt 0 view .LVU263
 1114 0018 FFF7FEFF 		bl	_get_angleoffset
 1115              	.LVL96:
  73:../BLDCMotor/motorctrl.c ****         sg_debug_clear();
 1116              		.loc 1 73 27 view .LVU264
 1117 001c 154B     		ldr	r3, .L52+4
 1118 001e 83ED000A 		vstr.32	s0, [r3]
  74:../BLDCMotor/motorctrl.c ****         foc_paraminit();
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 32


 1119              		.loc 1 74 9 is_stmt 1 view .LVU265
 1120 0022 FFF7FEFF 		bl	sg_debug_clear
 1121              	.LVL97:
  75:../BLDCMotor/motorctrl.c ****         HAL_Delay(20);
 1122              		.loc 1 75 9 view .LVU266
 1123 0026 FFF7FEFF 		bl	foc_paraminit
 1124              	.LVL98:
  76:../BLDCMotor/motorctrl.c ****         motor_enable();
 1125              		.loc 1 76 9 view .LVU267
 1126 002a 1420     		movs	r0, #20
 1127 002c FFF7FEFF 		bl	HAL_Delay
 1128              	.LVL99:
  77:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
 1129              		.loc 1 77 9 view .LVU268
 1130 0030 FFF7FEFF 		bl	motor_enable
 1131              	.LVL100:
  78:../BLDCMotor/motorctrl.c ****         break;
 1132              		.loc 1 78 9 view .LVU269
  78:../BLDCMotor/motorctrl.c ****         break;
 1133              		.loc 1 78 24 is_stmt 0 view .LVU270
 1134 0034 0E4B     		ldr	r3, .L52
 1135 0036 0322     		movs	r2, #3
 1136 0038 1A70     		strb	r2, [r3]
  79:../BLDCMotor/motorctrl.c **** 
 1137              		.loc 1 79 9 is_stmt 1 view .LVU271
 1138 003a 14E0     		b	.L43
 1139              	.L47:
  83:../BLDCMotor/motorctrl.c ****             {
 1140              		.loc 1 83 13 view .LVU272
  83:../BLDCMotor/motorctrl.c ****             {
 1141              		.loc 1 83 29 is_stmt 0 view .LVU273
 1142 003c 0C4A     		ldr	r2, .L52
 1143 003e 5388     		ldrh	r3, [r2, #2]
  83:../BLDCMotor/motorctrl.c ****             {
 1144              		.loc 1 83 19 view .LVU274
 1145 0040 0133     		adds	r3, r3, #1
  83:../BLDCMotor/motorctrl.c ****             {
 1146              		.loc 1 83 16 view .LVU275
 1147 0042 5380     		strh	r3, [r2, #2]	@ movhi
  86:../BLDCMotor/motorctrl.c ****             if (sg_motordebug.motor_stat == 1)
 1148              		.loc 1 86 13 is_stmt 1 view .LVU276
  87:../BLDCMotor/motorctrl.c ****             {
 1149              		.loc 1 87 13 view .LVU277
  87:../BLDCMotor/motorctrl.c ****             {
 1150              		.loc 1 87 30 is_stmt 0 view .LVU278
 1151 0044 0C4B     		ldr	r3, .L52+8
 1152 0046 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  87:../BLDCMotor/motorctrl.c ****             {
 1153              		.loc 1 87 16 view .LVU279
 1154 0048 012B     		cmp	r3, #1
 1155 004a 0CD1     		bne	.L43
  89:../BLDCMotor/motorctrl.c ****             }
 1156              		.loc 1 89 17 is_stmt 1 view .LVU280
  89:../BLDCMotor/motorctrl.c ****             }
 1157              		.loc 1 89 32 is_stmt 0 view .LVU281
 1158 004c 1346     		mov	r3, r2
 1159 004e 0422     		movs	r2, #4
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 33


 1160 0050 1A70     		strb	r2, [r3]
 1161 0052 08E0     		b	.L43
 1162              	.L45:
  95:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_IDLE;
 1163              		.loc 1 95 9 is_stmt 1 view .LVU282
 1164 0054 FFF7FEFF 		bl	motor_disable
 1165              	.LVL101:
  96:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
 1166              		.loc 1 96 9 view .LVU283
  96:../BLDCMotor/motorctrl.c ****     case MOTOR_IDLE:
 1167              		.loc 1 96 24 is_stmt 0 view .LVU284
 1168 0058 054B     		ldr	r3, .L52
 1169 005a 0122     		movs	r2, #1
 1170 005c 1A70     		strb	r2, [r3]
 1171              	.L48:
  98:../BLDCMotor/motorctrl.c ****             {
 1172              		.loc 1 98 13 is_stmt 1 view .LVU285
  98:../BLDCMotor/motorctrl.c ****             {
 1173              		.loc 1 98 30 is_stmt 0 view .LVU286
 1174 005e 064B     		ldr	r3, .L52+8
 1175 0060 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  98:../BLDCMotor/motorctrl.c ****             {
 1176              		.loc 1 98 16 view .LVU287
 1177 0062 032B     		cmp	r3, #3
 1178 0064 00D0     		beq	.L51
 1179              	.L43:
 107:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 1180              		.loc 1 107 1 view .LVU288
 1181 0066 08BD     		pop	{r3, pc}
 1182              	.L51:
 100:../BLDCMotor/motorctrl.c ****             }        
 1183              		.loc 1 100 17 is_stmt 1 view .LVU289
 100:../BLDCMotor/motorctrl.c ****             }        
 1184              		.loc 1 100 32 is_stmt 0 view .LVU290
 1185 0068 014B     		ldr	r3, .L52
 1186 006a 0022     		movs	r2, #0
 1187 006c 1A70     		strb	r2, [r3]
 107:../BLDCMotor/motorctrl.c **** /*------------Âë®ÊúüÊÄßË¢´Ë∞ÉÁî®----------------*/
 1188              		.loc 1 107 1 view .LVU291
 1189 006e FAE7     		b	.L43
 1190              	.L53:
 1191              		.align	2
 1192              	.L52:
 1193 0070 00000000 		.word	.LANCHOR8
 1194 0074 00000000 		.word	.LANCHOR3
 1195 0078 00000000 		.word	.LANCHOR0
 1196              		.cfi_endproc
 1197              	.LFE335:
 1199              		.global	per_eleangle
 1200              		.global	test_angletime
 1201              		.global	test_ic
 1202              		.global	test_ib
 1203              		.global	test_ia
 1204              		.global	raw_angle
 1205              		.global	next_angle_test
 1206              		.global	pre_angle_test
 1207              		.global	test_d_pid
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 34


 1208              		.global	g_Motor1
 1209              		.global	sg_motordebug
 1210              		.section	.rodata
 1211              		.align	2
 1212              		.set	.LANCHOR5,. + 0
 1213              	.LC0:
 1214 0000 00000000 		.word	0
 1215 0004 0000803F 		.word	1065353216
 1216 0008 00000000 		.word	0
 1217 000c 66660000 		.word	26214
 1218              		.section	.bss.g_Motor1,"aw",%nobits
 1219              		.align	2
 1220              		.set	.LANCHOR8,. + 0
 1223              	g_Motor1:
 1224 0000 00000000 		.space	4
 1225              		.section	.bss.next_angle_test,"aw",%nobits
 1226              		.align	2
 1229              	next_angle_test:
 1230 0000 00000000 		.space	4
 1231              		.section	.bss.per_eleangle,"aw",%nobits
 1232              		.align	2
 1235              	per_eleangle:
 1236 0000 00000000 		.space	4
 1237              		.section	.bss.pre_angle_test,"aw",%nobits
 1238              		.align	2
 1241              	pre_angle_test:
 1242 0000 00000000 		.space	4
 1243              		.section	.bss.raw_angle,"aw",%nobits
 1244              		.align	2
 1247              	raw_angle:
 1248 0000 00000000 		.space	4
 1249              		.section	.bss.sg_MecThetaOffset,"aw",%nobits
 1250              		.align	2
 1251              		.set	.LANCHOR3,. + 0
 1254              	sg_MecThetaOffset:
 1255 0000 00000000 		.space	4
 1256              		.section	.bss.sg_curloop_param,"aw",%nobits
 1257              		.align	2
 1258              		.set	.LANCHOR7,. + 0
 1261              	sg_curloop_param:
 1262 0000 00000000 		.space	56
 1262      00000000 
 1262      00000000 
 1262      00000000 
 1262      00000000 
 1263              		.section	.bss.sg_elefilter,"aw",%nobits
 1264              		.align	2
 1265              		.set	.LANCHOR6,. + 0
 1268              	sg_elefilter:
 1269 0000 00000000 		.space	24
 1269      00000000 
 1269      00000000 
 1269      00000000 
 1269      00000000 
 1270              		.section	.bss.sg_motordebug,"aw",%nobits
 1271              		.align	2
 1272              		.set	.LANCHOR0,. + 0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 35


 1275              	sg_motordebug:
 1276 0000 00000000 		.space	124
 1276      00000000 
 1276      00000000 
 1276      00000000 
 1276      00000000 
 1277              		.section	.bss.sgp_curloop_d_pid,"aw",%nobits
 1278              		.align	2
 1279              		.set	.LANCHOR1,. + 0
 1282              	sgp_curloop_d_pid:
 1283 0000 00000000 		.space	4
 1284              		.section	.bss.sgp_curloop_q_pid,"aw",%nobits
 1285              		.align	2
 1286              		.set	.LANCHOR2,. + 0
 1289              	sgp_curloop_q_pid:
 1290 0000 00000000 		.space	4
 1291              		.section	.bss.test_angletime,"aw",%nobits
 1292              		.align	2
 1293              		.set	.LANCHOR4,. + 0
 1296              	test_angletime:
 1297 0000 00000000 		.space	4
 1298              		.section	.bss.test_d_pid,"aw",%nobits
 1299              		.align	2
 1302              	test_d_pid:
 1303 0000 00000000 		.space	28
 1303      00000000 
 1303      00000000 
 1303      00000000 
 1303      00000000 
 1304              		.section	.bss.test_ia,"aw",%nobits
 1305              		.align	2
 1308              	test_ia:
 1309 0000 00000000 		.space	4
 1310              		.section	.bss.test_ib,"aw",%nobits
 1311              		.align	2
 1314              	test_ib:
 1315 0000 00000000 		.space	4
 1316              		.section	.bss.test_ic,"aw",%nobits
 1317              		.align	2
 1320              	test_ic:
 1321 0000 00000000 		.space	4
 1322              		.text
 1323              	.Letext0:
 1324              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 1325              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 1326              		.file 4 "../Common/method/pid.h"
 1327              		.file 5 "../Common/method/filter.h"
 1328              		.file 6 "../Common/IQMath/ti/IQmathLib.h"
 1329              		.file 7 "../BLDCMotor/motorctrl_common.h"
 1330              		.file 8 "../Common/Perf_counter/perf_counter.h"
 1331              		.file 9 "./Board/board.h"
 1332              		.file 10 "../Sensor/sensor.h"
 1333              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1334              		.file 12 "Inc/tim.h"
 1335              		.file 13 "Inc/adc.h"
 1336              		.file 14 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\math.h"
 1337              		.file 15 "../BLDCMotor/./motorctrl.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 36


ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 37


DEFINED SYMBOLS
                            *ABS*:00000000 motorctrl.c
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:20     .text.sg_debug_clear:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:25     .text.sg_debug_clear:00000000 sg_debug_clear
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:46     .text.sg_debug_clear:0000000c $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:51     .text.motor_enable_noirq:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:56     .text.motor_enable_noirq:00000000 motor_enable_noirq
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:76     .text.motor_set_pwm:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:81     .text.motor_set_pwm:00000000 motor_set_pwm
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:110    .text.motor_enable:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:115    .text.motor_enable:00000000 motor_enable
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:141    .text.motor_disable:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:146    .text.motor_disable:00000000 motor_disable
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:169    .text._get_angleoffset:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:174    .text._get_angleoffset:00000000 _get_angleoffset
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:302    .text._get_angleoffset:00000090 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:308    .text._currmentloop:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:313    .text._currmentloop:00000000 _currmentloop
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:477    .text._currmentloop:000000a8 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:486    .text._limit_voltagecircle:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:492    .text._limit_voltagecircle:00000000 _limit_voltagecircle
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:608    .text.g431_angletest:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:613    .text.g431_angletest:00000000 g431_angletest
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:826    .text.g431_angletest:000000f8 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:837    .text._50uscycle_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:843    .text._50uscycle_process:00000000 _50uscycle_process
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:973    .text._50uscycle_process:00000094 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:982    .text.foc_paraminit:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:988    .text.foc_paraminit:00000000 foc_paraminit
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1062   .text.foc_paraminit:0000007c $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1073   .text.motortctrl_process:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1079   .text.motortctrl_process:00000000 motortctrl_process
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1105   .text.motortctrl_process:00000012 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1193   .text.motortctrl_process:00000070 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1235   .bss.per_eleangle:00000000 per_eleangle
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1296   .bss.test_angletime:00000000 test_angletime
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1320   .bss.test_ic:00000000 test_ic
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1314   .bss.test_ib:00000000 test_ib
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1308   .bss.test_ia:00000000 test_ia
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1247   .bss.raw_angle:00000000 raw_angle
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1229   .bss.next_angle_test:00000000 next_angle_test
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1241   .bss.pre_angle_test:00000000 pre_angle_test
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1302   .bss.test_d_pid:00000000 test_d_pid
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1223   .bss.g_Motor1:00000000 g_Motor1
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1275   .bss.sg_motordebug:00000000 sg_motordebug
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1211   .rodata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1219   .bss.g_Motor1:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1226   .bss.next_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1232   .bss.per_eleangle:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1238   .bss.pre_angle_test:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1244   .bss.raw_angle:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1250   .bss.sg_MecThetaOffset:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1254   .bss.sg_MecThetaOffset:00000000 sg_MecThetaOffset
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1257   .bss.sg_curloop_param:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1261   .bss.sg_curloop_param:00000000 sg_curloop_param
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1264   .bss.sg_elefilter:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1268   .bss.sg_elefilter:00000000 sg_elefilter
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s 			page 38


C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1271   .bss.sg_motordebug:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1278   .bss.sgp_curloop_d_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1282   .bss.sgp_curloop_d_pid:00000000 sgp_curloop_d_pid
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1285   .bss.sgp_curloop_q_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1289   .bss.sgp_curloop_q_pid:00000000 sgp_curloop_q_pid
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1292   .bss.test_angletime:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1299   .bss.test_d_pid:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1305   .bss.test_ia:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1311   .bss.test_ib:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1317   .bss.test_ic:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1110   .text.motortctrl_process:00000017 $d
C:\Users\57308\AppData\Local\Temp\ccVRXgV1.s:1110   .text.motortctrl_process:00000018 $t

UNDEFINED SYMBOLS
tim_pwm_enable
tim_set_pwm
tim_tigger_adc
adc_start
tim_pwm_disable
adc_stop
_2r_2s
_svpwm
HAL_Delay
sensor_user_read
_IQ20toF
_3s_2s
_2s_2r
pid_contrl
__aeabi_f2d
__aeabi_d2f
sqrt
get_system_ticks
_normalize_angle
g_nOffset
lowfilter_cale
pid_init
lowfilter_init
motorprotocol_process
