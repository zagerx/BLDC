ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"motorctrl.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text._get_angleoffset,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	_get_angleoffset:
  26              	.LFB330:
  27              		.file 1 "../BLDCMotor/motorctrl.c"
   1:../BLDCMotor/motorctrl.c **** #include "./motorctrl.h"
   2:../BLDCMotor/motorctrl.c **** #include "debuglog.h"
   3:../BLDCMotor/motorctrl.c **** #include "focmethod.h"
   4:../BLDCMotor/motorctrl.c **** #include "sensor.h"
   5:../BLDCMotor/motorctrl.c **** #define MOTORCTRL_PERCI            (1)
   6:../BLDCMotor/motorctrl.c **** 
   7:../BLDCMotor/motorctrl.c **** enum{
   8:../BLDCMotor/motorctrl.c ****     MOTOR_INIT,
   9:../BLDCMotor/motorctrl.c ****     MOTOR_DIR1,
  10:../BLDCMotor/motorctrl.c ****     MOTOR_DIR2,
  11:../BLDCMotor/motorctrl.c ****     MOTOT_ANGIL,
  12:../BLDCMotor/motorctrl.c ****     MOTOR_IDLE,
  13:../BLDCMotor/motorctrl.c ****     MOTOR_START, 
  14:../BLDCMotor/motorctrl.c ****     MOTOR_RUNING,
  15:../BLDCMotor/motorctrl.c ****     MOTOR_RUNING2,  
  16:../BLDCMotor/motorctrl.c ****     MOTOT_FALT,
  17:../BLDCMotor/motorctrl.c ****     MOTOR_STOP,
  18:../BLDCMotor/motorctrl.c ****     MOTOR_TEST,
  19:../BLDCMotor/motorctrl.c ****     MOTOR_OFFSET,
  20:../BLDCMotor/motorctrl.c **** };
  21:../BLDCMotor/motorctrl.c **** typedef struct
  22:../BLDCMotor/motorctrl.c **** {
  23:../BLDCMotor/motorctrl.c ****     float ia;
  24:../BLDCMotor/motorctrl.c ****     float ib;
  25:../BLDCMotor/motorctrl.c ****     float ic;
  26:../BLDCMotor/motorctrl.c ****     float i_alpha;
  27:../BLDCMotor/motorctrl.c ****     float i_beta;
  28:../BLDCMotor/motorctrl.c ****     float i_d;
  29:../BLDCMotor/motorctrl.c ****     float i_q;
  30:../BLDCMotor/motorctrl.c **** 
  31:../BLDCMotor/motorctrl.c ****     float id_real;
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 2


  32:../BLDCMotor/motorctrl.c ****     float iq_targe;
  33:../BLDCMotor/motorctrl.c ****     float iq_real;
  34:../BLDCMotor/motorctrl.c **** 
  35:../BLDCMotor/motorctrl.c ****     float pid_Q_out;
  36:../BLDCMotor/motorctrl.c ****     float pid_D_out;
  37:../BLDCMotor/motorctrl.c ****     float ele_angle;
  38:../BLDCMotor/motorctrl.c **** }motordebug_t;
  39:../BLDCMotor/motorctrl.c **** motordebug_t sg_motordebug;
  40:../BLDCMotor/motorctrl.c **** typedef struct
  41:../BLDCMotor/motorctrl.c **** {
  42:../BLDCMotor/motorctrl.c ****     unsigned char state;
  43:../BLDCMotor/motorctrl.c ****     unsigned short cnt;
  44:../BLDCMotor/motorctrl.c **** }motorctrl_t;
  45:../BLDCMotor/motorctrl.c **** motorctrl_t g_Motor1 = {
  46:../BLDCMotor/motorctrl.c ****     .state = MOTOR_INIT,
  47:../BLDCMotor/motorctrl.c ****     .cnt = 0,
  48:../BLDCMotor/motorctrl.c **** };
  49:../BLDCMotor/motorctrl.c **** static float sg_MecThetaOffset = 0.0f;
  50:../BLDCMotor/motorctrl.c **** 
  51:../BLDCMotor/motorctrl.c **** extern alpbet_t _2r_2s(dq_t i_dq,float theta);
  52:../BLDCMotor/motorctrl.c **** extern void _3s_2s(abc_t i_abc,alpbet_t *alp_bet);
  53:../BLDCMotor/motorctrl.c **** extern void _2s_2r(alpbet_t i_alphabeta,float theta,dq_t *dq);
  54:../BLDCMotor/motorctrl.c **** extern alpbet_t _2r_2s_Q(dq_t i_dq,float theta);
  55:../BLDCMotor/motorctrl.c **** static lowfilter_t sg_elefilter[3];
  56:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void);
  57:../BLDCMotor/motorctrl.c **** void motortctrl_process(void)
  58:../BLDCMotor/motorctrl.c **** {
  59:../BLDCMotor/motorctrl.c ****     
  60:../BLDCMotor/motorctrl.c ****     switch (g_Motor1.state)
  61:../BLDCMotor/motorctrl.c ****     {
  62:../BLDCMotor/motorctrl.c ****     case MOTOR_INIT:
  63:../BLDCMotor/motorctrl.c ****         for (unsigned char  i = 0; i < 10; i++)
  64:../BLDCMotor/motorctrl.c ****         {
  65:../BLDCMotor/motorctrl.c ****             float theta = 100.0f;
  66:../BLDCMotor/motorctrl.c ****             theta = (*(sensor_data_t*)sensor_user_read(SENSOR_01)).cov_data;            
  67:../BLDCMotor/motorctrl.c ****         }
  68:../BLDCMotor/motorctrl.c ****         sg_MecThetaOffset = _get_angleoffset();
  69:../BLDCMotor/motorctrl.c ****         /*-----电流滤波器初始化-------*/
  70:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[0],80);
  71:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[1],80);
  72:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[2],80);
  73:../BLDCMotor/motorctrl.c **** 
  74:../BLDCMotor/motorctrl.c ****         /*------PID参数初始化---------*/
  75:../BLDCMotor/motorctrl.c ****         foc_paraminit();
  76:../BLDCMotor/motorctrl.c ****         sg_motordebug.iq_targe = 2.0f;
  77:../BLDCMotor/motorctrl.c ****         motor_enable();
  78:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
  79:../BLDCMotor/motorctrl.c ****         break;
  80:../BLDCMotor/motorctrl.c **** 
  81:../BLDCMotor/motorctrl.c ****     case MOTOR_TEST:
  82:../BLDCMotor/motorctrl.c **** 
  83:../BLDCMotor/motorctrl.c ****         break;
  84:../BLDCMotor/motorctrl.c **** 
  85:../BLDCMotor/motorctrl.c ****     case MOTOR_RUNING:
  86:../BLDCMotor/motorctrl.c ****         {
  87:../BLDCMotor/motorctrl.c ****             if (!(++g_Motor1.cnt % 5000))
  88:../BLDCMotor/motorctrl.c ****             {
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 3


  89:../BLDCMotor/motorctrl.c ****                 /* code */
  90:../BLDCMotor/motorctrl.c ****                 // g_Motor1.state = MOTOR_STOP;
  91:../BLDCMotor/motorctrl.c ****             }
  92:../BLDCMotor/motorctrl.c ****         }
  93:../BLDCMotor/motorctrl.c ****         break;
  94:../BLDCMotor/motorctrl.c ****     case MOTOR_STOP:
  95:../BLDCMotor/motorctrl.c ****         motor_disable();
  96:../BLDCMotor/motorctrl.c ****         break;
  97:../BLDCMotor/motorctrl.c ****     default:
  98:../BLDCMotor/motorctrl.c ****         break;
  99:../BLDCMotor/motorctrl.c ****     }
 100:../BLDCMotor/motorctrl.c **** }
 101:../BLDCMotor/motorctrl.c **** 
 102:../BLDCMotor/motorctrl.c **** static float _get_angleoffset(void)
 103:../BLDCMotor/motorctrl.c **** {
  28              		.loc 1 103 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 32
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 10B5     		push	{r4, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 4, -8
  36              		.cfi_offset 14, -4
  37 0002 2DED028B 		vpush.64	{d8}
  38              	.LCFI1:
  39              		.cfi_def_cfa_offset 16
  40              		.cfi_offset 80, -16
  41              		.cfi_offset 81, -12
  42 0006 88B0     		sub	sp, sp, #32
  43              	.LCFI2:
  44              		.cfi_def_cfa_offset 48
 104:../BLDCMotor/motorctrl.c ****     motor_enable_noirq();
  45              		.loc 1 104 5 view .LVU1
  46 0008 FFF7FEFF 		bl	motor_enable_noirq
  47              	.LVL0:
 105:../BLDCMotor/motorctrl.c ****     /*-----------设置alpha/beta坐标系------------------*/
 106:../BLDCMotor/motorctrl.c ****     alpbet_t uab = {1.0f,0.0f};
  48              		.loc 1 106 5 view .LVU2
  49              		.loc 1 106 14 is_stmt 0 view .LVU3
  50 000c 0024     		movs	r4, #0
  51 000e 0394     		str	r4, [sp, #12]
  52 0010 0494     		str	r4, [sp, #16]
  53 0012 0594     		str	r4, [sp, #20]
  54 0014 0694     		str	r4, [sp, #24]
  55 0016 0794     		str	r4, [sp, #28]
  56 0018 B7EE000A 		vmov.f32	s0, #1.0e+0
  57 001c 8DED030A 		vstr.32	s0, [sp, #12]
 107:../BLDCMotor/motorctrl.c ****     duty_t dut01;
  58              		.loc 1 107 5 is_stmt 1 view .LVU4
 108:../BLDCMotor/motorctrl.c ****     float theta;
  59              		.loc 1 108 5 view .LVU5
 109:../BLDCMotor/motorctrl.c ****     dut01 = _svpwm(uab.alpha,uab.beta);
  60              		.loc 1 109 5 view .LVU6
  61              		.loc 1 109 13 is_stmt 0 view .LVU7
  62 0020 DFED0D0A 		vldr.32	s1, .L3
  63 0024 FFF7FEFF 		bl	_svpwm
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 4


  64              	.LVL1:
  65 0028 8DED000A 		vstr.32	s0, [sp]
  66 002c CDED010A 		vstr.32	s1, [sp, #4]
  67 0030 8DED021A 		vstr.32	s2, [sp, #8]
 110:../BLDCMotor/motorctrl.c ****     motor_set_pwm(dut01._a,dut01._b,dut01._c);
  68              		.loc 1 110 5 is_stmt 1 view .LVU8
  69 0034 FFF7FEFF 		bl	motor_set_pwm
  70              	.LVL2:
 111:../BLDCMotor/motorctrl.c ****     HAL_Delay(200);
  71              		.loc 1 111 5 view .LVU9
  72 0038 C820     		movs	r0, #200
  73 003a FFF7FEFF 		bl	HAL_Delay
  74              	.LVL3:
 112:../BLDCMotor/motorctrl.c ****     theta = (*(sensor_data_t*)sensor_user_read(SENSOR_01)).cov_data;
  75              		.loc 1 112 5 view .LVU10
  76              		.loc 1 112 31 is_stmt 0 view .LVU11
  77 003e 2046     		mov	r0, r4
  78 0040 FFF7FEFF 		bl	sensor_user_read
  79              	.LVL4:
  80              		.loc 1 112 11 view .LVU12
  81 0044 90ED018A 		vldr.32	s16, [r0, #4]
  82              	.LVL5:
 113:../BLDCMotor/motorctrl.c ****     motor_disable();
  83              		.loc 1 113 5 is_stmt 1 view .LVU13
  84 0048 FFF7FEFF 		bl	motor_disable
  85              	.LVL6:
 114:../BLDCMotor/motorctrl.c ****     return theta;
  86              		.loc 1 114 5 view .LVU14
 115:../BLDCMotor/motorctrl.c **** }
  87              		.loc 1 115 1 is_stmt 0 view .LVU15
  88 004c B0EE480A 		vmov.f32	s0, s16
  89 0050 08B0     		add	sp, sp, #32
  90              	.LCFI3:
  91              		.cfi_def_cfa_offset 16
  92              		@ sp needed
  93 0052 BDEC028B 		vldm	sp!, {d8}
  94              	.LCFI4:
  95              		.cfi_restore 80
  96              		.cfi_restore 81
  97              		.cfi_def_cfa_offset 8
  98              	.LVL7:
  99              		.loc 1 115 1 view .LVU16
 100 0056 10BD     		pop	{r4, pc}
 101              	.L4:
 102              		.align	2
 103              	.L3:
 104 0058 00000000 		.word	0
 105              		.cfi_endproc
 106              	.LFE330:
 108              		.section	.text.motortctrl_process,"ax",%progbits
 109              		.align	1
 110              		.global	motortctrl_process
 111              		.syntax unified
 112              		.thumb
 113              		.thumb_func
 114              		.fpu fpv4-sp-d16
 116              	motortctrl_process:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 5


 117              	.LFB329:
  58:../BLDCMotor/motorctrl.c ****     
 118              		.loc 1 58 1 is_stmt 1 view -0
 119              		.cfi_startproc
 120              		@ args = 0, pretend = 0, frame = 0
 121              		@ frame_needed = 0, uses_anonymous_args = 0
 122 0000 10B5     		push	{r4, lr}
 123              	.LCFI5:
 124              		.cfi_def_cfa_offset 8
 125              		.cfi_offset 4, -8
 126              		.cfi_offset 14, -4
 127 0002 2DED028B 		vpush.64	{d8}
 128              	.LCFI6:
 129              		.cfi_def_cfa_offset 16
 130              		.cfi_offset 80, -16
 131              		.cfi_offset 81, -12
  60:../BLDCMotor/motorctrl.c ****     {
 132              		.loc 1 60 5 view .LVU18
  60:../BLDCMotor/motorctrl.c ****     {
 133              		.loc 1 60 21 is_stmt 0 view .LVU19
 134 0006 1F4B     		ldr	r3, .L12
 135 0008 1C78     		ldrb	r4, [r3]	@ zero_extendqisi2
  60:../BLDCMotor/motorctrl.c ****     {
 136              		.loc 1 60 5 view .LVU20
 137 000a 062C     		cmp	r4, #6
 138 000c 31D0     		beq	.L6
 139 000e 092C     		cmp	r4, #9
 140 0010 34D0     		beq	.L7
 141 0012 3CB1     		cbz	r4, .L8
 142              	.L5:
 100:../BLDCMotor/motorctrl.c **** 
 143              		.loc 1 100 1 view .LVU21
 144 0014 BDEC028B 		vldm	sp!, {d8}
 145              	.LCFI7:
 146              		.cfi_remember_state
 147              		.cfi_restore 80
 148              		.cfi_restore 81
 149              		.cfi_def_cfa_offset 8
 150 0018 10BD     		pop	{r4, pc}
 151              	.LVL8:
 152              	.L10:
 153              	.LCFI8:
 154              		.cfi_restore_state
 155              	.LBB2:
 156              	.LBB3:
  65:../BLDCMotor/motorctrl.c ****             theta = (*(sensor_data_t*)sensor_user_read(SENSOR_01)).cov_data;            
 157              		.loc 1 65 13 is_stmt 1 discriminator 3 view .LVU22
  66:../BLDCMotor/motorctrl.c ****         }
 158              		.loc 1 66 13 discriminator 3 view .LVU23
  66:../BLDCMotor/motorctrl.c ****         }
 159              		.loc 1 66 39 is_stmt 0 discriminator 3 view .LVU24
 160 001a 0020     		movs	r0, #0
 161 001c FFF7FEFF 		bl	sensor_user_read
 162              	.LVL9:
  66:../BLDCMotor/motorctrl.c ****         }
 163              		.loc 1 66 39 discriminator 3 view .LVU25
 164              	.LBE3:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 6


  63:../BLDCMotor/motorctrl.c ****         {
 165              		.loc 1 63 44 is_stmt 1 discriminator 3 view .LVU26
  63:../BLDCMotor/motorctrl.c ****         {
 166              		.loc 1 63 45 is_stmt 0 discriminator 3 view .LVU27
 167 0020 0134     		adds	r4, r4, #1
 168              	.LVL10:
  63:../BLDCMotor/motorctrl.c ****         {
 169              		.loc 1 63 45 discriminator 3 view .LVU28
 170 0022 E4B2     		uxtb	r4, r4
 171              	.LVL11:
 172              	.L8:
  63:../BLDCMotor/motorctrl.c ****         {
 173              		.loc 1 63 36 is_stmt 1 discriminator 1 view .LVU29
  63:../BLDCMotor/motorctrl.c ****         {
 174              		.loc 1 63 9 is_stmt 0 discriminator 1 view .LVU30
 175 0024 092C     		cmp	r4, #9
 176 0026 F8D9     		bls	.L10
 177              	.LBE2:
  68:../BLDCMotor/motorctrl.c ****         /*-----电流滤波器初始化-------*/
 178              		.loc 1 68 9 is_stmt 1 view .LVU31
  68:../BLDCMotor/motorctrl.c ****         /*-----电流滤波器初始化-------*/
 179              		.loc 1 68 29 is_stmt 0 view .LVU32
 180 0028 FFF7FEFF 		bl	_get_angleoffset
 181              	.LVL12:
  68:../BLDCMotor/motorctrl.c ****         /*-----电流滤波器初始化-------*/
 182              		.loc 1 68 27 view .LVU33
 183 002c 164B     		ldr	r3, .L12+4
 184 002e 83ED000A 		vstr.32	s0, [r3]
  70:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[1],80);
 185              		.loc 1 70 9 is_stmt 1 view .LVU34
 186 0032 9FED168A 		vldr.32	s16, .L12+8
 187 0036 164C     		ldr	r4, .L12+12
 188              	.LVL13:
  70:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[1],80);
 189              		.loc 1 70 9 is_stmt 0 view .LVU35
 190 0038 B0EE480A 		vmov.f32	s0, s16
 191 003c 2046     		mov	r0, r4
 192 003e FFF7FEFF 		bl	lowfilter_init
 193              	.LVL14:
  71:../BLDCMotor/motorctrl.c ****         lowfilter_init(&sg_elefilter[2],80);
 194              		.loc 1 71 9 is_stmt 1 view .LVU36
 195 0042 B0EE480A 		vmov.f32	s0, s16
 196 0046 04F10800 		add	r0, r4, #8
 197 004a FFF7FEFF 		bl	lowfilter_init
 198              	.LVL15:
  72:../BLDCMotor/motorctrl.c **** 
 199              		.loc 1 72 9 view .LVU37
 200 004e B0EE480A 		vmov.f32	s0, s16
 201 0052 04F11000 		add	r0, r4, #16
 202 0056 FFF7FEFF 		bl	lowfilter_init
 203              	.LVL16:
  75:../BLDCMotor/motorctrl.c ****         sg_motordebug.iq_targe = 2.0f;
 204              		.loc 1 75 9 view .LVU38
 205 005a FFF7FEFF 		bl	foc_paraminit
 206              	.LVL17:
  76:../BLDCMotor/motorctrl.c ****         motor_enable();
 207              		.loc 1 76 9 view .LVU39
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 7


  76:../BLDCMotor/motorctrl.c ****         motor_enable();
 208              		.loc 1 76 32 is_stmt 0 view .LVU40
 209 005e 0D4B     		ldr	r3, .L12+16
 210 0060 4FF08042 		mov	r2, #1073741824
 211 0064 1A62     		str	r2, [r3, #32]	@ float
  77:../BLDCMotor/motorctrl.c ****         g_Motor1.state = MOTOR_RUNING;           
 212              		.loc 1 77 9 is_stmt 1 view .LVU41
 213 0066 FFF7FEFF 		bl	motor_enable
 214              	.LVL18:
  78:../BLDCMotor/motorctrl.c ****         break;
 215              		.loc 1 78 9 view .LVU42
  78:../BLDCMotor/motorctrl.c ****         break;
 216              		.loc 1 78 24 is_stmt 0 view .LVU43
 217 006a 064B     		ldr	r3, .L12
 218 006c 0622     		movs	r2, #6
 219 006e 1A70     		strb	r2, [r3]
  79:../BLDCMotor/motorctrl.c **** 
 220              		.loc 1 79 9 is_stmt 1 view .LVU44
 221 0070 D0E7     		b	.L5
 222              	.L6:
  87:../BLDCMotor/motorctrl.c ****             {
 223              		.loc 1 87 13 view .LVU45
  87:../BLDCMotor/motorctrl.c ****             {
 224              		.loc 1 87 29 is_stmt 0 view .LVU46
 225 0072 044A     		ldr	r2, .L12
 226 0074 5388     		ldrh	r3, [r2, #2]
  87:../BLDCMotor/motorctrl.c ****             {
 227              		.loc 1 87 19 view .LVU47
 228 0076 0133     		adds	r3, r3, #1
  87:../BLDCMotor/motorctrl.c ****             {
 229              		.loc 1 87 16 view .LVU48
 230 0078 5380     		strh	r3, [r2, #2]	@ movhi
  91:../BLDCMotor/motorctrl.c ****         }
 231              		.loc 1 91 13 is_stmt 1 view .LVU49
  93:../BLDCMotor/motorctrl.c ****     case MOTOR_STOP:
 232              		.loc 1 93 9 view .LVU50
 233 007a CBE7     		b	.L5
 234              	.L7:
  95:../BLDCMotor/motorctrl.c ****         break;
 235              		.loc 1 95 9 view .LVU51
 236 007c FFF7FEFF 		bl	motor_disable
 237              	.LVL19:
  96:../BLDCMotor/motorctrl.c ****     default:
 238              		.loc 1 96 9 view .LVU52
 100:../BLDCMotor/motorctrl.c **** 
 239              		.loc 1 100 1 is_stmt 0 view .LVU53
 240 0080 C8E7     		b	.L5
 241              	.L13:
 242 0082 00BF     		.align	2
 243              	.L12:
 244 0084 00000000 		.word	.LANCHOR0
 245 0088 00000000 		.word	.LANCHOR1
 246 008c 0000A042 		.word	1117782016
 247 0090 00000000 		.word	.LANCHOR2
 248 0094 00000000 		.word	.LANCHOR3
 249              		.cfi_endproc
 250              	.LFE329:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 8


 252              		.section	.text.motorctrl_foccalc,"ax",%progbits
 253              		.align	1
 254              		.global	motorctrl_foccalc
 255              		.syntax unified
 256              		.thumb
 257              		.thumb_func
 258              		.fpu fpv4-sp-d16
 260              	motorctrl_foccalc:
 261              	.LVL20:
 262              	.LFB331:
 116:../BLDCMotor/motorctrl.c **** /*------------周期性被调用----------------*/
 117:../BLDCMotor/motorctrl.c **** 
 118:../BLDCMotor/motorctrl.c **** extern  pid_cb_t *sgp_curloop_d_pid;
 119:../BLDCMotor/motorctrl.c **** extern pid_cb_t *sgp_curloop_q_pid;
 120:../BLDCMotor/motorctrl.c **** float AAAAAA;
 121:../BLDCMotor/motorctrl.c **** duty_t dut01,dut02;
 122:../BLDCMotor/motorctrl.c **** void motorctrl_foccalc(unsigned int *abc_vale,float _elec_theta)
 123:../BLDCMotor/motorctrl.c **** {
 263              		.loc 1 123 1 is_stmt 1 view -0
 264              		.cfi_startproc
 265              		@ args = 0, pretend = 0, frame = 96
 266              		@ frame_needed = 0, uses_anonymous_args = 0
 267              		.loc 1 123 1 is_stmt 0 view .LVU55
 268 0000 30B5     		push	{r4, r5, lr}
 269              	.LCFI9:
 270              		.cfi_def_cfa_offset 12
 271              		.cfi_offset 4, -12
 272              		.cfi_offset 5, -8
 273              		.cfi_offset 14, -4
 274 0002 2DED048B 		vpush.64	{d8, d9}
 275              	.LCFI10:
 276              		.cfi_def_cfa_offset 28
 277              		.cfi_offset 80, -28
 278              		.cfi_offset 81, -24
 279              		.cfi_offset 82, -20
 280              		.cfi_offset 83, -16
 281 0006 9DB0     		sub	sp, sp, #116
 282              	.LCFI11:
 283              		.cfi_def_cfa_offset 144
 124:../BLDCMotor/motorctrl.c **** /*----------------三相电流处理------------------------------*/    
 125:../BLDCMotor/motorctrl.c ****     float Ia,Ib,Ic;    
 284              		.loc 1 125 5 is_stmt 1 view .LVU56
 126:../BLDCMotor/motorctrl.c ****     float a1,a2,a3;
 285              		.loc 1 126 5 view .LVU57
 127:../BLDCMotor/motorctrl.c ****     a1 = (float)abc_vale[0] - AD_OFFSET;
 286              		.loc 1 127 5 view .LVU58
 287              		.loc 1 127 10 is_stmt 0 view .LVU59
 288 0008 D0ED007A 		vldr.32	s15, [r0]	@ int
 289 000c F8EE677A 		vcvt.f32.u32	s15, s15
 290              		.loc 1 127 8 view .LVU60
 291 0010 9FED637A 		vldr.32	s14, .L19
 292 0014 77EEC77A 		vsub.f32	s15, s15, s14
 293              	.LVL21:
 128:../BLDCMotor/motorctrl.c ****     a2 = (float)abc_vale[2] - AD_OFFSET;
 294              		.loc 1 128 5 is_stmt 1 view .LVU61
 295              		.loc 1 128 10 is_stmt 0 view .LVU62
 296 0018 D0ED026A 		vldr.32	s13, [r0, #8]	@ int
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 9


 297 001c F8EE668A 		vcvt.f32.u32	s17, s13
 298              		.loc 1 128 8 view .LVU63
 299 0020 78EEC78A 		vsub.f32	s17, s17, s14
 300              	.LVL22:
 129:../BLDCMotor/motorctrl.c ****     a3 = (float)abc_vale[1] - AD_OFFSET;  
 301              		.loc 1 129 5 is_stmt 1 view .LVU64
 302              		.loc 1 129 25 is_stmt 0 view .LVU65
 303 0024 90ED018A 		vldr.32	s16, [r0, #4]	@ int
 304              		.loc 1 129 10 view .LVU66
 305 0028 B8EE488A 		vcvt.f32.u32	s16, s16
 306              		.loc 1 129 8 view .LVU67
 307 002c 38EE478A 		vsub.f32	s16, s16, s14
 308              	.LVL23:
 130:../BLDCMotor/motorctrl.c ****     Ia = (float)a1*(float)(3.3f/4096.0f/RA_S/BETA_);
 309              		.loc 1 130 5 is_stmt 1 view .LVU68
 310              		.loc 1 130 8 is_stmt 0 view .LVU69
 311 0030 9FED5C0A 		vldr.32	s0, .L19+4
 312              	.LVL24:
 131:../BLDCMotor/motorctrl.c ****     Ib = (float)a2*(float)(3.3f/4096.0f/RB_S/BETA_);
 313              		.loc 1 131 5 is_stmt 1 view .LVU70
 314              		.loc 1 131 8 is_stmt 0 view .LVU71
 315 0034 68EE808A 		vmul.f32	s17, s17, s0
 316              	.LVL25:
 132:../BLDCMotor/motorctrl.c ****     Ic = (float)a3*(float)(3.3f/4096.0f/RC_S/BETA_);
 317              		.loc 1 132 5 is_stmt 1 view .LVU72
 318              		.loc 1 132 8 is_stmt 0 view .LVU73
 319 0038 28EE008A 		vmul.f32	s16, s16, s0
 320              	.LVL26:
 133:../BLDCMotor/motorctrl.c **** #if 1
 134:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 321              		.loc 1 134 5 is_stmt 1 view .LVU74
 135:../BLDCMotor/motorctrl.c ****     i_abc.a = lowfilter_cale(&sg_elefilter[0],Ia);
 322              		.loc 1 135 5 view .LVU75
 323              		.loc 1 135 15 is_stmt 0 view .LVU76
 324 003c 5A4C     		ldr	r4, .L19+8
 325 003e 27EE800A 		vmul.f32	s0, s15, s0
 326              	.LVL27:
 327              		.loc 1 135 15 view .LVU77
 328 0042 2046     		mov	r0, r4
 329              	.LVL28:
 330              		.loc 1 135 15 view .LVU78
 331 0044 FFF7FEFF 		bl	lowfilter_cale
 332              	.LVL29:
 333              		.loc 1 135 15 view .LVU79
 334 0048 B0EE409A 		vmov.f32	s18, s0
 335              		.loc 1 135 13 view .LVU80
 336 004c 8DED160A 		vstr.32	s0, [sp, #88]
 136:../BLDCMotor/motorctrl.c ****     i_abc.b = lowfilter_cale(&sg_elefilter[1],Ib);
 337              		.loc 1 136 5 is_stmt 1 view .LVU81
 338              		.loc 1 136 15 is_stmt 0 view .LVU82
 339 0050 B0EE680A 		vmov.f32	s0, s17
 340 0054 04F10800 		add	r0, r4, #8
 341 0058 FFF7FEFF 		bl	lowfilter_cale
 342              	.LVL30:
 343 005c F0EE408A 		vmov.f32	s17, s0
 344              	.LVL31:
 345              		.loc 1 136 13 view .LVU83
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 10


 346 0060 8DED170A 		vstr.32	s0, [sp, #92]
 137:../BLDCMotor/motorctrl.c ****     i_abc.c = lowfilter_cale(&sg_elefilter[2],Ic);
 347              		.loc 1 137 5 is_stmt 1 view .LVU84
 348              		.loc 1 137 15 is_stmt 0 view .LVU85
 349 0064 B0EE480A 		vmov.f32	s0, s16
 350 0068 04F11000 		add	r0, r4, #16
 351 006c FFF7FEFF 		bl	lowfilter_cale
 352              	.LVL32:
 353 0070 B0EE408A 		vmov.f32	s16, s0
 354              	.LVL33:
 355              		.loc 1 137 13 view .LVU86
 356 0074 8DED180A 		vstr.32	s0, [sp, #96]
 138:../BLDCMotor/motorctrl.c **** #else
 139:../BLDCMotor/motorctrl.c ****     abc_t i_abc;
 140:../BLDCMotor/motorctrl.c ****     i_abc.a = Ia;
 141:../BLDCMotor/motorctrl.c ****     i_abc.b = Ib;
 142:../BLDCMotor/motorctrl.c ****     i_abc.c = Ic;
 143:../BLDCMotor/motorctrl.c **** #endif
 144:../BLDCMotor/motorctrl.c **** 
 145:../BLDCMotor/motorctrl.c **** /*---------------------获取当前转子角度-------------------------*/
 146:../BLDCMotor/motorctrl.c ****     float mech_theta,elec_theta;
 357              		.loc 1 146 5 is_stmt 1 view .LVU87
 147:../BLDCMotor/motorctrl.c ****     static float pre_elec_theta = 0.0f;
 358              		.loc 1 147 5 view .LVU88
 148:../BLDCMotor/motorctrl.c ****     mech_theta = (*(sensor_data_t*)sensor_user_read(SENSOR_01)).cov_data - sg_MecThetaOffset;
 359              		.loc 1 148 5 view .LVU89
 360              		.loc 1 148 36 is_stmt 0 view .LVU90
 361 0078 0020     		movs	r0, #0
 362 007a FFF7FEFF 		bl	sensor_user_read
 363              	.LVL34:
 364              		.loc 1 148 64 view .LVU91
 365 007e 90ED010A 		vldr.32	s0, [r0, #4]
 366              		.loc 1 148 74 view .LVU92
 367 0082 4A4B     		ldr	r3, .L19+12
 368 0084 D3ED007A 		vldr.32	s15, [r3]
 369              		.loc 1 148 16 view .LVU93
 370 0088 30EE670A 		vsub.f32	s0, s0, s15
 371              	.LVL35:
 149:../BLDCMotor/motorctrl.c ****     
 150:../BLDCMotor/motorctrl.c ****     elec_theta = (mech_theta) * MOTOR_PAIR;    
 372              		.loc 1 150 5 is_stmt 1 view .LVU94
 151:../BLDCMotor/motorctrl.c ****     elec_theta = _normalize_angle(elec_theta);
 373              		.loc 1 151 5 view .LVU95
 374              		.loc 1 151 18 is_stmt 0 view .LVU96
 375 008c 30EE000A 		vadd.f32	s0, s0, s0
 376              	.LVL36:
 377              		.loc 1 151 18 view .LVU97
 378 0090 FFF7FEFF 		bl	_normalize_angle
 379              	.LVL37:
 380              		.loc 1 151 18 view .LVU98
 381 0094 F0EE409A 		vmov.f32	s19, s0
 382              	.LVL38:
 152:../BLDCMotor/motorctrl.c ****     sg_motordebug.ele_angle = elec_theta;
 383              		.loc 1 152 5 is_stmt 1 view .LVU99
 384              		.loc 1 152 29 is_stmt 0 view .LVU100
 385 0098 454D     		ldr	r5, .L19+16
 386 009a 85ED0C0A 		vstr.32	s0, [r5, #48]
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 11


 153:../BLDCMotor/motorctrl.c ****     /*--------------对电流进行反park变化-----------------------*/
 154:../BLDCMotor/motorctrl.c ****     // i_abc.a = cosf(elec_theta);
 155:../BLDCMotor/motorctrl.c ****     // i_abc.b = cosf(elec_theta - 2.0/3.0f*PI);
 156:../BLDCMotor/motorctrl.c ****     // i_abc.c = cosf(elec_theta + 2.0/3.0f*PI);
 157:../BLDCMotor/motorctrl.c ****     dq_t i_dq;
 387              		.loc 1 157 5 is_stmt 1 view .LVU101
 158:../BLDCMotor/motorctrl.c ****     alpbet_t i_alphbeta;    
 388              		.loc 1 158 5 view .LVU102
 159:../BLDCMotor/motorctrl.c ****     _3s_2s(i_abc,&i_alphbeta);
 389              		.loc 1 159 5 view .LVU103
 390 009e 0DAC     		add	r4, sp, #52
 391 00a0 0294     		str	r4, [sp, #8]
 392 00a2 1CAB     		add	r3, sp, #112
 393 00a4 13E90300 		ldmdb	r3, {r0, r1}
 394 00a8 8DE80300 		stm	sp, {r0, r1}
 395 00ac 16AB     		add	r3, sp, #88
 396 00ae 0FCB     		ldm	r3, {r0, r1, r2, r3}
 397 00b0 FFF7FEFF 		bl	_3s_2s
 398              	.LVL39:
 160:../BLDCMotor/motorctrl.c ****     _2s_2r(i_alphbeta,elec_theta - PI/2.0F,&i_dq);
 399              		.loc 1 160 5 view .LVU104
 400 00b4 12AB     		add	r3, sp, #72
 401 00b6 0193     		str	r3, [sp, #4]
 402 00b8 119B     		ldr	r3, [sp, #68]
 403 00ba 0093     		str	r3, [sp]
 404 00bc 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 405 00c0 9FED3C0A 		vldr.32	s0, .L19+20
 406 00c4 39EEC00A 		vsub.f32	s0, s19, s0
 407 00c8 FFF7FEFF 		bl	_2s_2r
 408              	.LVL40:
 161:../BLDCMotor/motorctrl.c ****     sg_motordebug.id_real = i_dq.d *1000;
 409              		.loc 1 161 5 view .LVU105
 410              		.loc 1 161 36 is_stmt 0 view .LVU106
 411 00cc DFED3A6A 		vldr.32	s13, .L19+24
 412 00d0 9DED127A 		vldr.32	s14, [sp, #72]
 413 00d4 27EE267A 		vmul.f32	s14, s14, s13
 414              		.loc 1 161 27 view .LVU107
 415 00d8 85ED077A 		vstr.32	s14, [r5, #28]
 162:../BLDCMotor/motorctrl.c ****     sg_motordebug.iq_real = i_dq.q *1000;
 416              		.loc 1 162 5 is_stmt 1 view .LVU108
 417              		.loc 1 162 33 is_stmt 0 view .LVU109
 418 00dc DDED137A 		vldr.32	s15, [sp, #76]
 419              		.loc 1 162 36 view .LVU110
 420 00e0 67EEA67A 		vmul.f32	s15, s15, s13
 421              		.loc 1 162 27 view .LVU111
 422 00e4 C5ED097A 		vstr.32	s15, [r5, #36]
 163:../BLDCMotor/motorctrl.c **** 
 164:../BLDCMotor/motorctrl.c **** #if 0
 165:../BLDCMotor/motorctrl.c **** /*-------------------闭环控制-----------------------*/
 166:../BLDCMotor/motorctrl.c ****     dq_t u_dq = {0.0f,2.0f};
 167:../BLDCMotor/motorctrl.c ****     // u_dq.d = pid_contrl(sgp_curloop_d_pid,0.0f,i_dq.d);
 168:../BLDCMotor/motorctrl.c ****     // u_dq.q = pid_contrl(sgp_curloop_q_pid,sg_motordebug.iq_targe,i_dq.q);
 169:../BLDCMotor/motorctrl.c ****     sg_motordebug.pid_Q_out = u_dq.q;
 170:../BLDCMotor/motorctrl.c ****     sg_motordebug.pid_D_out = u_dq.d;
 171:../BLDCMotor/motorctrl.c ****     alpbet_t uab;
 172:../BLDCMotor/motorctrl.c ****     uab = _2r_2s(u_dq, elec_theta);
 173:../BLDCMotor/motorctrl.c ****     pre_elec_theta = elec_theta;
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 12


 174:../BLDCMotor/motorctrl.c ****     duty_t dut01;
 175:../BLDCMotor/motorctrl.c ****     dut01 = _svpwm(uab.alpha,uab.beta);
 176:../BLDCMotor/motorctrl.c ****     motor_set_pwm(dut01._a,dut01._b,dut01._c);
 177:../BLDCMotor/motorctrl.c **** #else
 178:../BLDCMotor/motorctrl.c **** /*------------------------
 179:../BLDCMotor/motorctrl.c **** 开环控制
 180:../BLDCMotor/motorctrl.c **** 100us调用匹配参数  
 181:../BLDCMotor/motorctrl.c ****     42BLDC  theta += 0.004f;  uq = 1.0f
 182:../BLDCMotor/motorctrl.c ****     yateng  theta += 0.004f;  uq = 1.0f    
 183:../BLDCMotor/motorctrl.c ****     qita    theta += 0.004f;  uq = 1.0f
 184:../BLDCMotor/motorctrl.c **** ---------------------------*/
 185:../BLDCMotor/motorctrl.c **** 
 186:../BLDCMotor/motorctrl.c ****     dq_t udq = {0.0f,0.60f,0,_IQ15(0.6f)};
 423              		.loc 1 186 5 is_stmt 1 view .LVU112
 424              		.loc 1 186 10 is_stmt 0 view .LVU113
 425 00e8 344B     		ldr	r3, .L19+28
 426 00ea 09AC     		add	r4, sp, #36
 427 00ec 0FCB     		ldm	r3, {r0, r1, r2, r3}
 428 00ee 84E80F00 		stm	r4, {r0, r1, r2, r3}
 187:../BLDCMotor/motorctrl.c ****     alpbet_t uab,uab_q15;
 429              		.loc 1 187 5 is_stmt 1 view .LVU114
 430              	.LBB4:
 188:../BLDCMotor/motorctrl.c ****     #if 1//强拖
 189:../BLDCMotor/motorctrl.c ****         {
 190:../BLDCMotor/motorctrl.c ****             static float theta = 0.0f;
 431              		.loc 1 190 13 view .LVU115
 191:../BLDCMotor/motorctrl.c ****             if (theta >= _2PI)
 432              		.loc 1 191 13 view .LVU116
 433              		.loc 1 191 23 is_stmt 0 view .LVU117
 434 00f2 334B     		ldr	r3, .L19+32
 435 00f4 93ED007A 		vldr.32	s14, [r3]
 436              		.loc 1 191 16 view .LVU118
 437 00f8 DFED327A 		vldr.32	s15, .L19+36
 438 00fc B4EEE77A 		vcmpe.f32	s14, s15
 439 0100 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 440 0104 01DB     		blt	.L15
 192:../BLDCMotor/motorctrl.c ****             {
 193:../BLDCMotor/motorctrl.c ****                 /* code */
 194:../BLDCMotor/motorctrl.c ****                 theta = 0.0f;
 441              		.loc 1 194 17 is_stmt 1 view .LVU119
 442              		.loc 1 194 23 is_stmt 0 view .LVU120
 443 0106 0022     		movs	r2, #0
 444 0108 1A60     		str	r2, [r3]	@ float
 445              	.L15:
 195:../BLDCMotor/motorctrl.c ****             }
 196:../BLDCMotor/motorctrl.c ****             // uab = _2r_2s(udq, theta);
 197:../BLDCMotor/motorctrl.c ****             uab_q15 = _2r_2s_Q(udq, theta);
 446              		.loc 1 197 13 is_stmt 1 view .LVU121
 447              		.loc 1 197 23 is_stmt 0 view .LVU122
 448 010a 2D4C     		ldr	r4, .L19+32
 449 010c 0C9B     		ldr	r3, [sp, #48]
 450 010e 0093     		str	r3, [sp]
 451 0110 09AB     		add	r3, sp, #36
 452 0112 0ECB     		ldm	r3, {r1, r2, r3}
 453 0114 94ED000A 		vldr.32	s0, [r4]
 454 0118 04A8     		add	r0, sp, #16
 455 011a FFF7FEFF 		bl	_2r_2s_Q
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 13


 456              	.LVL41:
 198:../BLDCMotor/motorctrl.c ****             theta += 0.001f;
 457              		.loc 1 198 13 is_stmt 1 view .LVU123
 458              		.loc 1 198 19 is_stmt 0 view .LVU124
 459 011e D4ED007A 		vldr.32	s15, [r4]
 460 0122 9FED297A 		vldr.32	s14, .L19+40
 461 0126 77EE877A 		vadd.f32	s15, s15, s14
 462 012a C4ED007A 		vstr.32	s15, [r4]
 463              	.LBE4:
 199:../BLDCMotor/motorctrl.c ****         }
 200:../BLDCMotor/motorctrl.c ****     #else //使用传感器
 201:../BLDCMotor/motorctrl.c ****         uab = _2r_2s(udq, elec_theta);
 202:../BLDCMotor/motorctrl.c ****         pre_elec_theta = elec_theta; 
 203:../BLDCMotor/motorctrl.c ****     #endif
 204:../BLDCMotor/motorctrl.c **** 
 205:../BLDCMotor/motorctrl.c ****     dut02 = _svpwm_Q(uab_q15.Q_alpha,(uab_q15.Q_beta));
 464              		.loc 1 205 5 is_stmt 1 view .LVU125
 465              		.loc 1 205 13 is_stmt 0 view .LVU126
 466 012e 0899     		ldr	r1, [sp, #32]
 467 0130 0798     		ldr	r0, [sp, #28]
 468 0132 FFF7FEFF 		bl	_svpwm_Q
 469              	.LVL42:
 470 0136 254A     		ldr	r2, .L19+44
 471 0138 82ED000A 		vstr.32	s0, [r2]
 472 013c C2ED010A 		vstr.32	s1, [r2, #4]
 473 0140 82ED021A 		vstr.32	s2, [r2, #8]
 206:../BLDCMotor/motorctrl.c ****     dut01 = dut02;
 474              		.loc 1 206 5 is_stmt 1 view .LVU127
 475              		.loc 1 206 11 is_stmt 0 view .LVU128
 476 0144 224B     		ldr	r3, .L19+48
 477 0146 07CA     		ldm	r2, {r0, r1, r2}
 478 0148 83E80700 		stm	r3, {r0, r1, r2}
 207:../BLDCMotor/motorctrl.c ****     // dut01 = _svpwm(uab.alpha,uab.beta);
 208:../BLDCMotor/motorctrl.c **** 
 209:../BLDCMotor/motorctrl.c ****     motor_set_pwm(dut01._a,dut01._b,dut01._c);
 479              		.loc 1 209 5 is_stmt 1 view .LVU129
 480 014c 93ED021A 		vldr.32	s2, [r3, #8]
 481 0150 D3ED010A 		vldr.32	s1, [r3, #4]
 482 0154 93ED000A 		vldr.32	s0, [r3]
 483 0158 FFF7FEFF 		bl	motor_set_pwm
 484              	.LVL43:
 210:../BLDCMotor/motorctrl.c **** #endif
 211:../BLDCMotor/motorctrl.c **** 
 212:../BLDCMotor/motorctrl.c **** /*-------------------观测三相电流--------------------*/
 213:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_IA,i_abc.a);
 485              		.loc 1 213 5 view .LVU130
 486 015c B0EE490A 		vmov.f32	s0, s18
 487 0160 0220     		movs	r0, #2
 488 0162 FFF7FEFF 		bl	ipc_write_data
 489              	.LVL44:
 214:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_IB,i_abc.b);
 490              		.loc 1 214 5 view .LVU131
 491 0166 B0EE680A 		vmov.f32	s0, s17
 492 016a 0320     		movs	r0, #3
 493 016c FFF7FEFF 		bl	ipc_write_data
 494              	.LVL45:
 215:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_IC,i_abc.c);
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 14


 495              		.loc 1 215 5 view .LVU132
 496 0170 B0EE480A 		vmov.f32	s0, s16
 497 0174 0420     		movs	r0, #4
 498 0176 FFF7FEFF 		bl	ipc_write_data
 499              	.LVL46:
 216:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_IALPHA,i_alphbeta.alpha);
 500              		.loc 1 216 5 view .LVU133
 501 017a 9DED0D0A 		vldr.32	s0, [sp, #52]
 502 017e 0520     		movs	r0, #5
 503 0180 FFF7FEFF 		bl	ipc_write_data
 504              	.LVL47:
 217:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_IBETA,i_alphbeta.beta);    
 505              		.loc 1 217 5 view .LVU134
 506 0184 9DED0E0A 		vldr.32	s0, [sp, #56]
 507 0188 0620     		movs	r0, #6
 508 018a FFF7FEFF 		bl	ipc_write_data
 509              	.LVL48:
 218:../BLDCMotor/motorctrl.c ****     ipc_write_data(PUBLIC_DATA_ID,i_dq.d);
 510              		.loc 1 218 5 view .LVU135
 511 018e 9DED120A 		vldr.32	s0, [sp, #72]
 512 0192 0720     		movs	r0, #7
 513 0194 FFF7FEFF 		bl	ipc_write_data
 514              	.LVL49:
 219:../BLDCMotor/motorctrl.c ****     // ipc_write_data(PUBLIC_DATA_IQ,i_dq.q);
 220:../BLDCMotor/motorctrl.c ****     return;
 515              		.loc 1 220 5 view .LVU136
 221:../BLDCMotor/motorctrl.c **** }
 516              		.loc 1 221 1 is_stmt 0 view .LVU137
 517 0198 1DB0     		add	sp, sp, #116
 518              	.LCFI12:
 519              		.cfi_def_cfa_offset 28
 520              		@ sp needed
 521 019a BDEC048B 		vldm	sp!, {d8-d9}
 522              	.LCFI13:
 523              		.cfi_restore 82
 524              		.cfi_restore 83
 525              		.cfi_restore 80
 526              		.cfi_restore 81
 527              		.cfi_def_cfa_offset 12
 528 019e 30BD     		pop	{r4, r5, pc}
 529              	.L20:
 530              		.align	2
 531              	.L19:
 532 01a0 00400445 		.word	1157906432
 533 01a4 3694673C 		.word	1013421110
 534 01a8 00000000 		.word	.LANCHOR2
 535 01ac 00000000 		.word	.LANCHOR1
 536 01b0 00000000 		.word	.LANCHOR3
 537 01b4 DA0FC93F 		.word	1070141402
 538 01b8 00007A44 		.word	1148846080
 539 01bc 00000000 		.word	.LANCHOR4
 540 01c0 00000000 		.word	.LANCHOR5
 541 01c4 DA0FC940 		.word	1086918618
 542 01c8 6F12833A 		.word	981668463
 543 01cc 00000000 		.word	.LANCHOR6
 544 01d0 00000000 		.word	.LANCHOR7
 545              		.cfi_endproc
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 15


 546              	.LFE331:
 548              		.global	dut02
 549              		.global	dut01
 550              		.global	AAAAAA
 551              		.global	g_Motor1
 552              		.global	sg_motordebug
 553              		.section	.rodata
 554              		.align	2
 555              		.set	.LANCHOR4,. + 0
 556              	.LC0:
 557 0000 00000000 		.word	0
 558 0004 9A99193F 		.word	1058642330
 559 0008 00000000 		.word	0
 560 000c CC4C0000 		.word	19660
 561              		.section	.bss.AAAAAA,"aw",%nobits
 562              		.align	2
 565              	AAAAAA:
 566 0000 00000000 		.space	4
 567              		.section	.bss.dut01,"aw",%nobits
 568              		.align	2
 569              		.set	.LANCHOR7,. + 0
 572              	dut01:
 573 0000 00000000 		.space	12
 573      00000000 
 573      00000000 
 574              		.section	.bss.dut02,"aw",%nobits
 575              		.align	2
 576              		.set	.LANCHOR6,. + 0
 579              	dut02:
 580 0000 00000000 		.space	12
 580      00000000 
 580      00000000 
 581              		.section	.bss.g_Motor1,"aw",%nobits
 582              		.align	2
 583              		.set	.LANCHOR0,. + 0
 586              	g_Motor1:
 587 0000 00000000 		.space	4
 588              		.section	.bss.sg_MecThetaOffset,"aw",%nobits
 589              		.align	2
 590              		.set	.LANCHOR1,. + 0
 593              	sg_MecThetaOffset:
 594 0000 00000000 		.space	4
 595              		.section	.bss.sg_elefilter,"aw",%nobits
 596              		.align	2
 597              		.set	.LANCHOR2,. + 0
 600              	sg_elefilter:
 601 0000 00000000 		.space	24
 601      00000000 
 601      00000000 
 601      00000000 
 601      00000000 
 602              		.section	.bss.sg_motordebug,"aw",%nobits
 603              		.align	2
 604              		.set	.LANCHOR3,. + 0
 607              	sg_motordebug:
 608 0000 00000000 		.space	52
 608      00000000 
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 16


 608      00000000 
 608      00000000 
 608      00000000 
 609              		.section	.bss.theta.0,"aw",%nobits
 610              		.align	2
 611              		.set	.LANCHOR5,. + 0
 614              	theta.0:
 615 0000 00000000 		.space	4
 616              		.text
 617              	.Letext0:
 618              		.file 2 "d:\\program files (x86)\\gcc-arm-none-eabi-10-2020-q4-major-win32\\tool\\arm-none-eabi\\i
 619              		.file 3 "d:\\program files (x86)\\gcc-arm-none-eabi-10-2020-q4-major-win32\\tool\\arm-none-eabi\\i
 620              		.file 4 "../Common/IQMath/ti/IQmathLib.h"
 621              		.file 5 "../Common/method/filter.h"
 622              		.file 6 "../Common/IPC/ipc.h"
 623              		.file 7 "../Sensor/sensor_cfg.h"
 624              		.file 8 "../Sensor/sensor.h"
 625              		.file 9 "../BLDCMotor/focmethod.h"
 626              		.file 10 "Inc/tim.h"
 627              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s 			page 17


DEFINED SYMBOLS
                            *ABS*:00000000 motorctrl.c
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:18     .text._get_angleoffset:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:25     .text._get_angleoffset:00000000 _get_angleoffset
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:104    .text._get_angleoffset:00000058 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:109    .text.motortctrl_process:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:116    .text.motortctrl_process:00000000 motortctrl_process
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:244    .text.motortctrl_process:00000084 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:253    .text.motorctrl_foccalc:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:260    .text.motorctrl_foccalc:00000000 motorctrl_foccalc
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:532    .text.motorctrl_foccalc:000001a0 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:579    .bss.dut02:00000000 dut02
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:572    .bss.dut01:00000000 dut01
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:565    .bss.AAAAAA:00000000 AAAAAA
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:586    .bss.g_Motor1:00000000 g_Motor1
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:607    .bss.sg_motordebug:00000000 sg_motordebug
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:554    .rodata:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:562    .bss.AAAAAA:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:568    .bss.dut01:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:575    .bss.dut02:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:582    .bss.g_Motor1:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:589    .bss.sg_MecThetaOffset:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:593    .bss.sg_MecThetaOffset:00000000 sg_MecThetaOffset
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:596    .bss.sg_elefilter:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:600    .bss.sg_elefilter:00000000 sg_elefilter
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:603    .bss.sg_motordebug:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:610    .bss.theta.0:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccp4iVH6.s:614    .bss.theta.0:00000000 theta.0

UNDEFINED SYMBOLS
motor_enable_noirq
_svpwm
motor_set_pwm
HAL_Delay
sensor_user_read
motor_disable
lowfilter_init
foc_paraminit
motor_enable
lowfilter_cale
_normalize_angle
_3s_2s
_2s_2r
_2r_2s_Q
_svpwm_Q
ipc_write_data
