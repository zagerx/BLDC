ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"mt6816.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.mt6816_read,"ax",%progbits
  20              		.align	1
  21              		.global	mt6816_read
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	mt6816_read:
  27              	.LFB329:
  28              		.file 1 "./Hardware/mt6816.c"
   1:./Hardware/mt6816.c **** #include "spi.h"
   2:./Hardware/mt6816.c **** #include "_common.h"
   3:./Hardware/mt6816.c **** extern SPI_HandleTypeDef hspi1;
   4:./Hardware/mt6816.c **** static unsigned char Spi_TxData[4]={0x83,0x84,0x05,0xff};
   5:./Hardware/mt6816.c **** static unsigned char Spi_pRxData[4]={0};
   6:./Hardware/mt6816.c **** static lowfilter_t sg_anglefilter;
   7:./Hardware/mt6816.c **** 
   8:./Hardware/mt6816.c **** typedef struct mt6816_data
   9:./Hardware/mt6816.c **** {
  10:./Hardware/mt6816.c ****     int32_t *raw_buf;     //原始数据
  11:./Hardware/mt6816.c ****     int32_t *covdata_buf;       //转换后的数据    
  12:./Hardware/mt6816.c ****     int32_t *filterdata_buf;    //滤波后数据
  13:./Hardware/mt6816.c ****     int16_t buf_column;
  14:./Hardware/mt6816.c **** }mt6816_data_t;
  15:./Hardware/mt6816.c **** 
  16:./Hardware/mt6816.c **** static mt6816_data_t sg_mt6816data = {0};
  17:./Hardware/mt6816.c ****  int32_t rawdata,covdata,filterdata;
  18:./Hardware/mt6816.c **** static int16_t column;
  19:./Hardware/mt6816.c **** 
  20:./Hardware/mt6816.c **** 
  21:./Hardware/mt6816.c **** void* mt6816_read(void)
  22:./Hardware/mt6816.c **** {
  29              		.loc 1 22 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 10B5     		push	{r4, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 4, -8
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 2


  37              		.cfi_offset 14, -4
  38 0002 82B0     		sub	sp, sp, #8
  39              	.LCFI1:
  40              		.cfi_def_cfa_offset 16
  23:./Hardware/mt6816.c ****     unsigned int AngleIn17bits = 0;
  41              		.loc 1 23 5 view .LVU1
  42              	.LVL0:
  24:./Hardware/mt6816.c ****     HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_RESET);  
  43              		.loc 1 24 5 view .LVU2
  44 0004 0022     		movs	r2, #0
  45 0006 4FF40041 		mov	r1, #32768
  46 000a 4FF09040 		mov	r0, #1207959552
  47 000e FFF7FEFF 		bl	HAL_GPIO_WritePin
  48              	.LVL1:
  25:./Hardware/mt6816.c ****     HAL_SPI_TransmitReceive(&hspi1, &Spi_TxData[0], &Spi_pRxData[0],0x03,0xffff);
  49              		.loc 1 25 5 view .LVU3
  50 0012 164C     		ldr	r4, .L3
  51 0014 4FF6FF73 		movw	r3, #65535
  52 0018 0093     		str	r3, [sp]
  53 001a 0323     		movs	r3, #3
  54 001c 2246     		mov	r2, r4
  55 001e 1449     		ldr	r1, .L3+4
  56 0020 1448     		ldr	r0, .L3+8
  57 0022 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
  58              	.LVL2:
  26:./Hardware/mt6816.c ****     HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_SET);
  59              		.loc 1 26 5 view .LVU4
  60 0026 0122     		movs	r2, #1
  61 0028 4FF40041 		mov	r1, #32768
  62 002c 4FF09040 		mov	r0, #1207959552
  63 0030 FFF7FEFF 		bl	HAL_GPIO_WritePin
  64              	.LVL3:
  27:./Hardware/mt6816.c **** 
  28:./Hardware/mt6816.c ****     AngleIn17bits =(((Spi_pRxData[1]&0x00ff)<<8) | (Spi_pRxData[2]&0x00fc))>>2;
  65              		.loc 1 28 5 view .LVU5
  66              		.loc 1 28 34 is_stmt 0 view .LVU6
  67 0034 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
  68              		.loc 1 28 64 view .LVU7
  69 0036 A378     		ldrb	r3, [r4, #2]	@ zero_extendqisi2
  70              		.loc 1 28 67 view .LVU8
  71 0038 03F0FC03 		and	r3, r3, #252
  72              		.loc 1 28 50 view .LVU9
  73 003c 43EA0223 		orr	r3, r3, r2, lsl #8
  74              		.loc 1 28 76 view .LVU10
  75 0040 9B10     		asrs	r3, r3, #2
  76              	.LVL4:
  29:./Hardware/mt6816.c ****     AngleIn17bits = 16384 - AngleIn17bits;
  77              		.loc 1 29 5 is_stmt 1 view .LVU11
  78              		.loc 1 29 19 is_stmt 0 view .LVU12
  79 0042 C3F58043 		rsb	r3, r3, #16384
  80              	.LVL5:
  30:./Hardware/mt6816.c ****     rawdata = AngleIn17bits;
  81              		.loc 1 30 5 is_stmt 1 view .LVU13
  82              		.loc 1 30 13 is_stmt 0 view .LVU14
  83 0046 0C4A     		ldr	r2, .L3+12
  84 0048 1360     		str	r3, [r2]
  31:./Hardware/mt6816.c ****     covdata = (AngleIn17bits * 0.00038349f) * (1<<20);
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 3


  85              		.loc 1 31 5 is_stmt 1 view .LVU15
  86              		.loc 1 31 30 is_stmt 0 view .LVU16
  87 004a 07EE903A 		vmov	s15, r3	@ int
  88 004e F8EE677A 		vcvt.f32.u32	s15, s15
  89 0052 9FED0A7A 		vldr.32	s14, .L3+16
  90 0056 67EE877A 		vmul.f32	s15, s15, s14
  91              		.loc 1 31 13 view .LVU17
  92 005a FEEEC67A 		vcvt.s32.f32	s15, s15, #20
  93 005e 084B     		ldr	r3, .L3+20
  94              	.LVL6:
  95              		.loc 1 31 13 view .LVU18
  96 0060 C3ED007A 		vstr.32	s15, [r3]	@ int
  32:./Hardware/mt6816.c ****     return (void*)&sg_mt6816data;
  97              		.loc 1 32 5 is_stmt 1 view .LVU19
  33:./Hardware/mt6816.c **** }
  98              		.loc 1 33 1 is_stmt 0 view .LVU20
  99 0064 0748     		ldr	r0, .L3+24
 100 0066 02B0     		add	sp, sp, #8
 101              	.LCFI2:
 102              		.cfi_def_cfa_offset 8
 103              		@ sp needed
 104 0068 10BD     		pop	{r4, pc}
 105              	.L4:
 106 006a 00BF     		.align	2
 107              	.L3:
 108 006c 00000000 		.word	.LANCHOR0
 109 0070 00000000 		.word	.LANCHOR1
 110 0074 00000000 		.word	hspi1
 111 0078 00000000 		.word	.LANCHOR2
 112 007c 280FC939 		.word	969477928
 113 0080 00000000 		.word	.LANCHOR3
 114 0084 00000000 		.word	.LANCHOR4
 115              		.cfi_endproc
 116              	.LFE329:
 118              		.section	.text.mt6816_init,"ax",%progbits
 119              		.align	1
 120              		.global	mt6816_init
 121              		.syntax unified
 122              		.thumb
 123              		.thumb_func
 125              	mt6816_init:
 126              	.LFB330:
  34:./Hardware/mt6816.c **** 
  35:./Hardware/mt6816.c **** // float mt6816_readf(void)
  36:./Hardware/mt6816.c **** // {
  37:./Hardware/mt6816.c **** 
  38:./Hardware/mt6816.c **** // }
  39:./Hardware/mt6816.c **** void mt6816_init(void)
  40:./Hardware/mt6816.c **** {
 127              		.loc 1 40 1 is_stmt 1 view -0
 128              		.cfi_startproc
 129              		@ args = 0, pretend = 0, frame = 0
 130              		@ frame_needed = 0, uses_anonymous_args = 0
 131 0000 10B5     		push	{r4, lr}
 132              	.LCFI3:
 133              		.cfi_def_cfa_offset 8
 134              		.cfi_offset 4, -8
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 4


 135              		.cfi_offset 14, -4
 136 0002 82B0     		sub	sp, sp, #8
 137              	.LCFI4:
 138              		.cfi_def_cfa_offset 16
  41:./Hardware/mt6816.c ****     for (uint8_t i = 0; i < 10; i++)
 139              		.loc 1 41 5 view .LVU22
 140              	.LBB2:
 141              		.loc 1 41 10 view .LVU23
 142              	.LVL7:
 143              		.loc 1 41 18 is_stmt 0 view .LVU24
 144 0004 0024     		movs	r4, #0
 145              		.loc 1 41 5 view .LVU25
 146 0006 18E0     		b	.L6
 147              	.LVL8:
 148              	.L7:
  42:./Hardware/mt6816.c ****     {    
  43:./Hardware/mt6816.c ****         /*mt6816 首次上电读取数据错误*/
  44:./Hardware/mt6816.c ****         HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_RESET);  
 149              		.loc 1 44 9 is_stmt 1 discriminator 3 view .LVU26
 150 0008 0022     		movs	r2, #0
 151 000a 4FF40041 		mov	r1, #32768
 152 000e 4FF09040 		mov	r0, #1207959552
 153 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 154              	.LVL9:
  45:./Hardware/mt6816.c ****         HAL_SPI_TransmitReceive(&hspi1, &Spi_TxData[0], &Spi_pRxData[0],0x03,0xffff);
 155              		.loc 1 45 9 discriminator 3 view .LVU27
 156 0016 4FF6FF73 		movw	r3, #65535
 157 001a 0093     		str	r3, [sp]
 158 001c 0323     		movs	r3, #3
 159 001e 0F4A     		ldr	r2, .L9
 160 0020 0F49     		ldr	r1, .L9+4
 161 0022 1048     		ldr	r0, .L9+8
 162 0024 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 163              	.LVL10:
  46:./Hardware/mt6816.c ****         HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_SET);
 164              		.loc 1 46 9 discriminator 3 view .LVU28
 165 0028 0122     		movs	r2, #1
 166 002a 4FF40041 		mov	r1, #32768
 167 002e 4FF09040 		mov	r0, #1207959552
 168 0032 FFF7FEFF 		bl	HAL_GPIO_WritePin
 169              	.LVL11:
  41:./Hardware/mt6816.c ****     {    
 170              		.loc 1 41 33 discriminator 3 view .LVU29
  41:./Hardware/mt6816.c ****     {    
 171              		.loc 1 41 34 is_stmt 0 discriminator 3 view .LVU30
 172 0036 0134     		adds	r4, r4, #1
 173              	.LVL12:
  41:./Hardware/mt6816.c ****     {    
 174              		.loc 1 41 34 discriminator 3 view .LVU31
 175 0038 E4B2     		uxtb	r4, r4
 176              	.LVL13:
 177              	.L6:
  41:./Hardware/mt6816.c ****     {    
 178              		.loc 1 41 25 is_stmt 1 discriminator 1 view .LVU32
  41:./Hardware/mt6816.c ****     {    
 179              		.loc 1 41 5 is_stmt 0 discriminator 1 view .LVU33
 180 003a 092C     		cmp	r4, #9
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 5


 181 003c E4D9     		bls	.L7
 182              	.LBE2:
  47:./Hardware/mt6816.c ****     }
  48:./Hardware/mt6816.c **** 
  49:./Hardware/mt6816.c ****     sg_mt6816data.raw_buf = &rawdata;
 183              		.loc 1 49 5 is_stmt 1 view .LVU34
 184              		.loc 1 49 27 is_stmt 0 view .LVU35
 185 003e 0A4B     		ldr	r3, .L9+12
 186 0040 0A4A     		ldr	r2, .L9+16
 187 0042 1A60     		str	r2, [r3]
  50:./Hardware/mt6816.c ****     sg_mt6816data.covdata_buf = &covdata;
 188              		.loc 1 50 5 is_stmt 1 view .LVU36
 189              		.loc 1 50 31 is_stmt 0 view .LVU37
 190 0044 0A4A     		ldr	r2, .L9+20
 191 0046 5A60     		str	r2, [r3, #4]
  51:./Hardware/mt6816.c ****     sg_mt6816data.filterdata_buf = &filterdata;
 192              		.loc 1 51 5 is_stmt 1 view .LVU38
 193              		.loc 1 51 34 is_stmt 0 view .LVU39
 194 0048 0A4A     		ldr	r2, .L9+24
 195 004a 9A60     		str	r2, [r3, #8]
  52:./Hardware/mt6816.c **** 
  53:./Hardware/mt6816.c ****     lowfilter_init(&sg_anglefilter,99);
 196              		.loc 1 53 5 is_stmt 1 view .LVU40
 197 004c 9FED0A0A 		vldr.32	s0, .L9+28
 198 0050 0A48     		ldr	r0, .L9+32
 199 0052 FFF7FEFF 		bl	lowfilter_init
 200              	.LVL14:
  54:./Hardware/mt6816.c **** }...
 201              		.loc 1 54 1 is_stmt 0 view .LVU41
 202 0056 02B0     		add	sp, sp, #8
 203              	.LCFI5:
 204              		.cfi_def_cfa_offset 8
 205              		@ sp needed
 206 0058 10BD     		pop	{r4, pc}
 207              	.LVL15:
 208              	.L10:
 209              		.loc 1 54 1 view .LVU42
 210 005a 00BF     		.align	2
 211              	.L9:
 212 005c 00000000 		.word	.LANCHOR0
 213 0060 00000000 		.word	.LANCHOR1
 214 0064 00000000 		.word	hspi1
 215 0068 00000000 		.word	.LANCHOR4
 216 006c 00000000 		.word	.LANCHOR2
 217 0070 00000000 		.word	.LANCHOR3
 218 0074 00000000 		.word	.LANCHOR5
 219 0078 0000C642 		.word	1120272384
 220 007c 00000000 		.word	.LANCHOR6
 221              		.cfi_endproc
 222              	.LFE330:
 224              		.global	filterdata
 225              		.global	covdata
 226              		.global	rawdata
 227              		.section	.bss.Spi_pRxData,"aw",%nobits
 228              		.align	2
 229              		.set	.LANCHOR0,. + 0
 232              	Spi_pRxData:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 6


 233 0000 00000000 		.space	4
 234              		.section	.bss.covdata,"aw",%nobits
 235              		.align	2
 236              		.set	.LANCHOR3,. + 0
 239              	covdata:
 240 0000 00000000 		.space	4
 241              		.section	.bss.filterdata,"aw",%nobits
 242              		.align	2
 243              		.set	.LANCHOR5,. + 0
 246              	filterdata:
 247 0000 00000000 		.space	4
 248              		.section	.bss.rawdata,"aw",%nobits
 249              		.align	2
 250              		.set	.LANCHOR2,. + 0
 253              	rawdata:
 254 0000 00000000 		.space	4
 255              		.section	.bss.sg_anglefilter,"aw",%nobits
 256              		.align	2
 257              		.set	.LANCHOR6,. + 0
 260              	sg_anglefilter:
 261 0000 00000000 		.space	8
 261      00000000 
 262              		.section	.bss.sg_mt6816data,"aw",%nobits
 263              		.align	2
 264              		.set	.LANCHOR4,. + 0
 267              	sg_mt6816data:
 268 0000 00000000 		.space	16
 268      00000000 
 268      00000000 
 268      00000000 
 269              		.section	.data.Spi_TxData,"aw"
 270              		.align	2
 271              		.set	.LANCHOR1,. + 0
 274              	Spi_TxData:
 275 0000 838405FF 		.ascii	"\203\204\005\377"
 276              		.text
 277              	.Letext0:
 278              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 279              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 280              		.file 4 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 281              		.file 5 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 282              		.file 6 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_gpio.h"
 283              		.file 7 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 284              		.file 8 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 285              		.file 9 "../Common/method/filter.h"
 286              		.file 10 "Inc/spi.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccs9chz2.s 			page 7


DEFINED SYMBOLS
                            *ABS*:00000000 mt6816.c
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:20     .text.mt6816_read:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:26     .text.mt6816_read:00000000 mt6816_read
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:108    .text.mt6816_read:0000006c $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:119    .text.mt6816_init:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:125    .text.mt6816_init:00000000 mt6816_init
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:212    .text.mt6816_init:0000005c $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:246    .bss.filterdata:00000000 filterdata
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:239    .bss.covdata:00000000 covdata
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:253    .bss.rawdata:00000000 rawdata
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:228    .bss.Spi_pRxData:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:232    .bss.Spi_pRxData:00000000 Spi_pRxData
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:235    .bss.covdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:242    .bss.filterdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:249    .bss.rawdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:256    .bss.sg_anglefilter:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:260    .bss.sg_anglefilter:00000000 sg_anglefilter
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:263    .bss.sg_mt6816data:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:267    .bss.sg_mt6816data:00000000 sg_mt6816data
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:270    .data.Spi_TxData:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccs9chz2.s:274    .data.Spi_TxData:00000000 Spi_TxData

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_TransmitReceive
hspi1
lowfilter_init
