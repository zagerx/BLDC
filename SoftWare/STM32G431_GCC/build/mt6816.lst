ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"mt6816.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.mt6816_read,"ax",%progbits
  20              		.align	1
  21              		.global	mt6816_read
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	mt6816_read:
  27              	.LFB329:
  28              		.file 1 "./Hardware/mt6816.c"
   1:./Hardware/mt6816.c **** #include "spi.h"
   2:./Hardware/mt6816.c **** #include "filter.h"
   3:./Hardware/mt6816.c **** extern SPI_HandleTypeDef hspi1;
   4:./Hardware/mt6816.c ****  unsigned char Spi_TxData[4]={0x83,0x84,0x85,0x00};
   5:./Hardware/mt6816.c ****  unsigned char Spi_pRxData[4]={0};
   6:./Hardware/mt6816.c **** static lowfilter_t sg_anglefilter;
   7:./Hardware/mt6816.c **** 
   8:./Hardware/mt6816.c **** typedef struct mt6816_data
   9:./Hardware/mt6816.c **** {
  10:./Hardware/mt6816.c ****     int32_t *raw_buf;
  11:./Hardware/mt6816.c ****     int32_t *covdata_buf;
  12:./Hardware/mt6816.c ****     int32_t *filterdata_buf;
  13:./Hardware/mt6816.c ****     int16_t buf_column;
  14:./Hardware/mt6816.c **** }mt6816_data_t;
  15:./Hardware/mt6816.c **** 
  16:./Hardware/mt6816.c **** static mt6816_data_t sg_mt6816data = {0};
  17:./Hardware/mt6816.c **** int32_t rawdata,covdata,filterdata;
  18:./Hardware/mt6816.c **** static int16_t column;
  19:./Hardware/mt6816.c **** 
  20:./Hardware/mt6816.c **** int32_t test_rawdata = 0;
  21:./Hardware/mt6816.c **** void* mt6816_read(void)
  22:./Hardware/mt6816.c **** {
  29              		.loc 1 22 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  23:./Hardware/mt6816.c ****     unsigned int AngleIn17bits = 0;
  34              		.loc 1 23 5 view .LVU1
  35              	.LVL0:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 2


  24:./Hardware/mt6816.c ****     // HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_RESET);  
  25:./Hardware/mt6816.c ****     // HAL_SPI_TransmitReceive(&hspi1, &Spi_TxData[0], &Spi_pRxData[0],0x03,0xFF);
  26:./Hardware/mt6816.c ****     // HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_SET);
  27:./Hardware/mt6816.c **** 
  28:./Hardware/mt6816.c ****     AngleIn17bits =(((Spi_pRxData[1]&0x00ff)<<8) | (Spi_pRxData[2]&0x00fc))>>2;
  36              		.loc 1 28 5 view .LVU2
  37              		.loc 1 28 34 is_stmt 0 view .LVU3
  38 0000 094A     		ldr	r2, .L2
  39 0002 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
  40              		.loc 1 28 64 view .LVU4
  41 0004 9378     		ldrb	r3, [r2, #2]	@ zero_extendqisi2
  42              		.loc 1 28 67 view .LVU5
  43 0006 03F0FC03 		and	r3, r3, #252
  44              		.loc 1 28 50 view .LVU6
  45 000a 43EA0123 		orr	r3, r3, r1, lsl #8
  46              		.loc 1 28 76 view .LVU7
  47 000e 9B10     		asrs	r3, r3, #2
  48              	.LVL1:
  29:./Hardware/mt6816.c ****     // AngleIn17bits = 16384 - AngleIn17bits;
  30:./Hardware/mt6816.c ****     
  31:./Hardware/mt6816.c ****     rawdata = AngleIn17bits;
  49              		.loc 1 31 5 is_stmt 1 view .LVU8
  50              		.loc 1 31 13 is_stmt 0 view .LVU9
  51 0010 064A     		ldr	r2, .L2+4
  52 0012 1360     		str	r3, [r2]
  32:./Hardware/mt6816.c ****     test_rawdata = AngleIn17bits;
  53              		.loc 1 32 5 is_stmt 1 view .LVU10
  54              		.loc 1 32 18 is_stmt 0 view .LVU11
  55 0014 064A     		ldr	r2, .L2+8
  56 0016 1360     		str	r3, [r2]
  33:./Hardware/mt6816.c ****     // covdata = (AngleIn17bits * 0.00038349f) * (1<<20);
  34:./Hardware/mt6816.c ****     covdata = (AngleIn17bits * 402);
  57              		.loc 1 34 5 is_stmt 1 view .LVU12
  58              		.loc 1 34 30 is_stmt 0 view .LVU13
  59 0018 4FF4C972 		mov	r2, #402
  60 001c 02FB03F3 		mul	r3, r2, r3
  61              	.LVL2:
  62              		.loc 1 34 13 view .LVU14
  63 0020 044A     		ldr	r2, .L2+12
  64 0022 1360     		str	r3, [r2]
  35:./Hardware/mt6816.c ****     return (void*)&sg_mt6816data;
  65              		.loc 1 35 5 is_stmt 1 view .LVU15
  36:./Hardware/mt6816.c **** }
  66              		.loc 1 36 1 is_stmt 0 view .LVU16
  67 0024 0448     		ldr	r0, .L2+16
  68 0026 7047     		bx	lr
  69              	.L3:
  70              		.align	2
  71              	.L2:
  72 0028 00000000 		.word	.LANCHOR0
  73 002c 00000000 		.word	.LANCHOR1
  74 0030 00000000 		.word	.LANCHOR2
  75 0034 00000000 		.word	.LANCHOR3
  76 0038 00000000 		.word	.LANCHOR4
  77              		.cfi_endproc
  78              	.LFE329:
  80              		.section	.text.mt6816_init,"ax",%progbits
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 3


  81              		.align	1
  82              		.global	mt6816_init
  83              		.syntax unified
  84              		.thumb
  85              		.thumb_func
  87              	mt6816_init:
  88              	.LFB330:
  37:./Hardware/mt6816.c **** 
  38:./Hardware/mt6816.c **** void mt6816_init(void)
  39:./Hardware/mt6816.c **** {
  89              		.loc 1 39 1 is_stmt 1 view -0
  90              		.cfi_startproc
  91              		@ args = 0, pretend = 0, frame = 0
  92              		@ frame_needed = 0, uses_anonymous_args = 0
  93 0000 10B5     		push	{r4, lr}
  94              	.LCFI0:
  95              		.cfi_def_cfa_offset 8
  96              		.cfi_offset 4, -8
  97              		.cfi_offset 14, -4
  98 0002 82B0     		sub	sp, sp, #8
  99              	.LCFI1:
 100              		.cfi_def_cfa_offset 16
  40:./Hardware/mt6816.c ****     for (uint8_t i = 0; i < 10; i++)
 101              		.loc 1 40 5 view .LVU18
 102              	.LBB2:
 103              		.loc 1 40 10 view .LVU19
 104              	.LVL3:
 105              		.loc 1 40 18 is_stmt 0 view .LVU20
 106 0004 0024     		movs	r4, #0
 107              		.loc 1 40 5 view .LVU21
 108 0006 18E0     		b	.L5
 109              	.LVL4:
 110              	.L6:
  41:./Hardware/mt6816.c ****     {    
  42:./Hardware/mt6816.c ****         /*mt6816 首次上电读取数据错误*/
  43:./Hardware/mt6816.c ****         HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_RESET);  
 111              		.loc 1 43 9 is_stmt 1 discriminator 3 view .LVU22
 112 0008 0022     		movs	r2, #0
 113 000a 4FF40041 		mov	r1, #32768
 114 000e 4FF09040 		mov	r0, #1207959552
 115 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 116              	.LVL5:
  44:./Hardware/mt6816.c ****         HAL_SPI_TransmitReceive(&hspi1, &Spi_TxData[0], &Spi_pRxData[0],0x03,0xffff);
 117              		.loc 1 44 9 discriminator 3 view .LVU23
 118 0016 4FF6FF73 		movw	r3, #65535
 119 001a 0093     		str	r3, [sp]
 120 001c 0323     		movs	r3, #3
 121 001e 0F4A     		ldr	r2, .L8
 122 0020 0F49     		ldr	r1, .L8+4
 123 0022 1048     		ldr	r0, .L8+8
 124 0024 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 125              	.LVL6:
  45:./Hardware/mt6816.c ****         HAL_GPIO_WritePin(MT68XX_CSN_GPIO_Port, MT68XX_CSN_Pin, GPIO_PIN_SET);
 126              		.loc 1 45 9 discriminator 3 view .LVU24
 127 0028 0122     		movs	r2, #1
 128 002a 4FF40041 		mov	r1, #32768
 129 002e 4FF09040 		mov	r0, #1207959552
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 4


 130 0032 FFF7FEFF 		bl	HAL_GPIO_WritePin
 131              	.LVL7:
  40:./Hardware/mt6816.c ****     {    
 132              		.loc 1 40 33 discriminator 3 view .LVU25
  40:./Hardware/mt6816.c ****     {    
 133              		.loc 1 40 34 is_stmt 0 discriminator 3 view .LVU26
 134 0036 0134     		adds	r4, r4, #1
 135              	.LVL8:
  40:./Hardware/mt6816.c ****     {    
 136              		.loc 1 40 34 discriminator 3 view .LVU27
 137 0038 E4B2     		uxtb	r4, r4
 138              	.LVL9:
 139              	.L5:
  40:./Hardware/mt6816.c ****     {    
 140              		.loc 1 40 25 is_stmt 1 discriminator 1 view .LVU28
  40:./Hardware/mt6816.c ****     {    
 141              		.loc 1 40 5 is_stmt 0 discriminator 1 view .LVU29
 142 003a 092C     		cmp	r4, #9
 143 003c E4D9     		bls	.L6
 144              	.LBE2:
  46:./Hardware/mt6816.c ****     }
  47:./Hardware/mt6816.c ****     sg_mt6816data.raw_buf = &rawdata;
 145              		.loc 1 47 5 is_stmt 1 view .LVU30
 146              		.loc 1 47 27 is_stmt 0 view .LVU31
 147 003e 0A4B     		ldr	r3, .L8+12
 148 0040 0A4A     		ldr	r2, .L8+16
 149 0042 1A60     		str	r2, [r3]
  48:./Hardware/mt6816.c ****     sg_mt6816data.covdata_buf = &covdata;
 150              		.loc 1 48 5 is_stmt 1 view .LVU32
 151              		.loc 1 48 31 is_stmt 0 view .LVU33
 152 0044 0A4A     		ldr	r2, .L8+20
 153 0046 5A60     		str	r2, [r3, #4]
  49:./Hardware/mt6816.c ****     sg_mt6816data.filterdata_buf = &filterdata;
 154              		.loc 1 49 5 is_stmt 1 view .LVU34
 155              		.loc 1 49 34 is_stmt 0 view .LVU35
 156 0048 0A4A     		ldr	r2, .L8+24
 157 004a 9A60     		str	r2, [r3, #8]
  50:./Hardware/mt6816.c **** 
  51:./Hardware/mt6816.c ****     lowfilter_init(&sg_anglefilter,99);
 158              		.loc 1 51 5 is_stmt 1 view .LVU36
 159 004c 9FED0A0A 		vldr.32	s0, .L8+28
 160 0050 0A48     		ldr	r0, .L8+32
 161 0052 FFF7FEFF 		bl	lowfilter_init
 162              	.LVL10:
  52:./Hardware/mt6816.c **** }
 163              		.loc 1 52 1 is_stmt 0 view .LVU37
 164 0056 02B0     		add	sp, sp, #8
 165              	.LCFI2:
 166              		.cfi_def_cfa_offset 8
 167              		@ sp needed
 168 0058 10BD     		pop	{r4, pc}
 169              	.LVL11:
 170              	.L9:
 171              		.loc 1 52 1 view .LVU38
 172 005a 00BF     		.align	2
 173              	.L8:
 174 005c 00000000 		.word	.LANCHOR0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 5


 175 0060 00000000 		.word	.LANCHOR5
 176 0064 00000000 		.word	hspi1
 177 0068 00000000 		.word	.LANCHOR4
 178 006c 00000000 		.word	.LANCHOR1
 179 0070 00000000 		.word	.LANCHOR3
 180 0074 00000000 		.word	.LANCHOR6
 181 0078 0000C642 		.word	1120272384
 182 007c 00000000 		.word	.LANCHOR7
 183              		.cfi_endproc
 184              	.LFE330:
 186              		.global	test_rawdata
 187              		.global	filterdata
 188              		.global	covdata
 189              		.global	rawdata
 190              		.global	Spi_pRxData
 191              		.global	Spi_TxData
 192              		.section	.bss.Spi_pRxData,"aw",%nobits
 193              		.align	2
 194              		.set	.LANCHOR0,. + 0
 197              	Spi_pRxData:
 198 0000 00000000 		.space	4
 199              		.section	.bss.covdata,"aw",%nobits
 200              		.align	2
 201              		.set	.LANCHOR3,. + 0
 204              	covdata:
 205 0000 00000000 		.space	4
 206              		.section	.bss.filterdata,"aw",%nobits
 207              		.align	2
 208              		.set	.LANCHOR6,. + 0
 211              	filterdata:
 212 0000 00000000 		.space	4
 213              		.section	.bss.rawdata,"aw",%nobits
 214              		.align	2
 215              		.set	.LANCHOR1,. + 0
 218              	rawdata:
 219 0000 00000000 		.space	4
 220              		.section	.bss.sg_anglefilter,"aw",%nobits
 221              		.align	2
 222              		.set	.LANCHOR7,. + 0
 225              	sg_anglefilter:
 226 0000 00000000 		.space	8
 226      00000000 
 227              		.section	.bss.sg_mt6816data,"aw",%nobits
 228              		.align	2
 229              		.set	.LANCHOR4,. + 0
 232              	sg_mt6816data:
 233 0000 00000000 		.space	16
 233      00000000 
 233      00000000 
 233      00000000 
 234              		.section	.bss.test_rawdata,"aw",%nobits
 235              		.align	2
 236              		.set	.LANCHOR2,. + 0
 239              	test_rawdata:
 240 0000 00000000 		.space	4
 241              		.section	.data.Spi_TxData,"aw"
 242              		.align	2
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 6


 243              		.set	.LANCHOR5,. + 0
 246              	Spi_TxData:
 247 0000 83848500 		.ascii	"\203\204\205\000"
 248              		.text
 249              	.Letext0:
 250              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 251              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 252              		.file 4 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 253              		.file 5 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 254              		.file 6 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_gpio.h"
 255              		.file 7 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 256              		.file 8 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 257              		.file 9 "../Common/method/filter.h"
 258              		.file 10 "Inc/spi.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccnaZTch.s 			page 7


DEFINED SYMBOLS
                            *ABS*:00000000 mt6816.c
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:20     .text.mt6816_read:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:26     .text.mt6816_read:00000000 mt6816_read
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:72     .text.mt6816_read:00000028 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:81     .text.mt6816_init:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:87     .text.mt6816_init:00000000 mt6816_init
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:174    .text.mt6816_init:0000005c $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:239    .bss.test_rawdata:00000000 test_rawdata
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:211    .bss.filterdata:00000000 filterdata
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:204    .bss.covdata:00000000 covdata
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:218    .bss.rawdata:00000000 rawdata
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:197    .bss.Spi_pRxData:00000000 Spi_pRxData
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:246    .data.Spi_TxData:00000000 Spi_TxData
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:193    .bss.Spi_pRxData:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:200    .bss.covdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:207    .bss.filterdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:214    .bss.rawdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:221    .bss.sg_anglefilter:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:225    .bss.sg_anglefilter:00000000 sg_anglefilter
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:228    .bss.sg_mt6816data:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:232    .bss.sg_mt6816data:00000000 sg_mt6816data
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:235    .bss.test_rawdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccnaZTch.s:242    .data.Spi_TxData:00000000 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_TransmitReceive
lowfilter_init
hspi1
