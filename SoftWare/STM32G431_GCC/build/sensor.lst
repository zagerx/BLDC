ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"sensor.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.sensor_process,"ax",%progbits
  20              		.align	1
  21              		.global	sensor_process
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	sensor_process:
  27              	.LFB0:
  28              		.file 1 "../Sensor/sensor.c"
   1:../Sensor/sensor.c **** #include "sensor.h"
   2:../Sensor/sensor.c **** #include "debuglog.h"
   3:../Sensor/sensor.c **** 
   4:../Sensor/sensor.c **** #undef NULL
   5:../Sensor/sensor.c **** #define NULL 0
   6:../Sensor/sensor.c **** #define SENSORE_PERCI            (1)
   7:../Sensor/sensor.c **** 
   8:../Sensor/sensor.c **** static float g_filtedata_arry[SENSOR_NUMBER + 1];        //‰º†ÊÑüÂô®Êª§Ê≥¢ÁöÑÊï∞ÊçÆ
   9:../Sensor/sensor.c **** static sensor_data_t g_data_arry[SENSOR_NUMBER + 1];     //‰º†ÊÑüÂô®Êï∞ÊçÆ
  10:../Sensor/sensor.c **** 
  11:../Sensor/sensor.c **** /*-------------------Ê≥®ÂÜå‰º†ÊÑüÂô®------------------------*/
  12:../Sensor/sensor.c **** static sensor_t g_sensor_arry[SENSOR_NUMBER + 1] = \
  13:../Sensor/sensor.c **** {
  14:../Sensor/sensor.c **** #if(ANGLE_SENSOR)
  15:../Sensor/sensor.c ****     [SENSOR_01] = {
  16:../Sensor/sensor.c ****         .pf_read = angle_read,
  17:../Sensor/sensor.c ****         .pf_write = NULL,
  18:../Sensor/sensor.c ****         .pf_init = NULL,
  19:../Sensor/sensor.c ****         .cycle = 0x00,
  20:../Sensor/sensor.c ****         .status = EN_SENSOR_NORMAL
  21:../Sensor/sensor.c ****     },
  22:../Sensor/sensor.c **** #endif
  23:../Sensor/sensor.c **** 
  24:../Sensor/sensor.c ****     [SENSOR_NUMBER] = {
  25:../Sensor/sensor.c ****         .pf_read = NULL,
  26:../Sensor/sensor.c ****         .pf_write = NULL,
  27:../Sensor/sensor.c ****         .cycle = 0
  28:../Sensor/sensor.c ****     },
  29:../Sensor/sensor.c **** };          //‰º†ÊÑüÂô®Êï∞ÁªÑ
  30:../Sensor/sensor.c **** 
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 2


  31:../Sensor/sensor.c **** 
  32:../Sensor/sensor.c **** enum{
  33:../Sensor/sensor.c ****     SENSOR_INIT,
  34:../Sensor/sensor.c ****     SENSOR_IDLE,
  35:../Sensor/sensor.c ****     SENSOR_OPEN,
  36:../Sensor/sensor.c ****     SENSOR_UPDATE,
  37:../Sensor/sensor.c ****     SENSOR_CLOSE,
  38:../Sensor/sensor.c **** };
  39:../Sensor/sensor.c **** typedef struct
  40:../Sensor/sensor.c **** {
  41:../Sensor/sensor.c ****     unsigned int tim;
  42:../Sensor/sensor.c ****     unsigned char state;
  43:../Sensor/sensor.c **** }sensor_arry_t;
  44:../Sensor/sensor.c **** 
  45:../Sensor/sensor.c **** sensor_arry_t g_sensor = {
  46:../Sensor/sensor.c ****     .tim = 0,
  47:../Sensor/sensor.c ****     .state = SENSOR_INIT,
  48:../Sensor/sensor.c **** };
  49:../Sensor/sensor.c **** /*-------------ÂàùÂßãÂåñ„ÄÅÊõ¥Êñ∞‰º†ÊÑüÂô®ÁªÑ----------------*/
  50:../Sensor/sensor.c **** void sensor_process(void)
  51:../Sensor/sensor.c **** {
  29              		.loc 1 51 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 38B5     		push	{r3, r4, r5, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36              		.cfi_offset 3, -16
  37              		.cfi_offset 4, -12
  38              		.cfi_offset 5, -8
  39              		.cfi_offset 14, -4
  52:../Sensor/sensor.c ****     switch (g_sensor.state)
  40              		.loc 1 52 5 view .LVU1
  41              		.loc 1 52 21 is_stmt 0 view .LVU2
  42 0002 184B     		ldr	r3, .L9
  43 0004 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
  44              		.loc 1 52 5 view .LVU3
  45 0006 13B1     		cbz	r3, .L2
  46 0008 032B     		cmp	r3, #3
  47 000a 04D0     		beq	.L3
  48              	.L1:
  53:../Sensor/sensor.c ****     {
  54:../Sensor/sensor.c ****     case SENSOR_INIT:
  55:../Sensor/sensor.c ****         g_sensor.state = SENSOR_UPDATE;
  56:../Sensor/sensor.c ****         break;
  57:../Sensor/sensor.c ****     case SENSOR_UPDATE:
  58:../Sensor/sensor.c ****         g_sensor.tim++;
  59:../Sensor/sensor.c ****         for (ENUM_SENSOR sensor_id = 0; sensor_id < SENSOR_NUMBER; sensor_id++) //ÈÅçÂéÜÊï¥‰∏™‰º†ÊÑ
  60:../Sensor/sensor.c ****         {
  61:../Sensor/sensor.c ****             if (!g_sensor_arry[sensor_id].pf_read || !g_sensor_arry[sensor_id].cycle)
  62:../Sensor/sensor.c ****             {
  63:../Sensor/sensor.c ****                 continue;
  64:../Sensor/sensor.c ****             }
  65:../Sensor/sensor.c ****             
  66:../Sensor/sensor.c ****             /*----Êõ¥Êñ∞Âë®ÊúüÊòØÂê¶Êª°Ë∂≥----*/
  67:../Sensor/sensor.c ****             if (!(g_sensor.tim % g_sensor_arry[sensor_id].cycle))
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 3


  68:../Sensor/sensor.c ****             {
  69:../Sensor/sensor.c ****                 g_data_arry[sensor_id] = *(sensor_data_t *)g_sensor_arry[sensor_id].pf_read();
  70:../Sensor/sensor.c ****             }
  71:../Sensor/sensor.c ****             // USER_DEBUG_NORMAL("data %d %d\r\n",g_data_arry[sensor_id].raw,\
  72:../Sensor/sensor.c ****             //                                         (int)(g_data_arry[sensor_id].cov_data * 1000
  73:../Sensor/sensor.c **** 
  74:../Sensor/sensor.c ****             /*----Êª§Ê≥¢Â§ÑÁêÜÊòØÂê¶ÈúÄË¶Å----*/
  75:../Sensor/sensor.c ****         }
  76:../Sensor/sensor.c ****         break;    
  77:../Sensor/sensor.c ****     default:
  78:../Sensor/sensor.c ****         break;
  79:../Sensor/sensor.c ****     }
  80:../Sensor/sensor.c **** }
  49              		.loc 1 80 1 view .LVU4
  50 000c 38BD     		pop	{r3, r4, r5, pc}
  51              	.L2:
  55:../Sensor/sensor.c ****         break;
  52              		.loc 1 55 9 is_stmt 1 view .LVU5
  55:../Sensor/sensor.c ****         break;
  53              		.loc 1 55 24 is_stmt 0 view .LVU6
  54 000e 154B     		ldr	r3, .L9
  55 0010 0322     		movs	r2, #3
  56 0012 1A71     		strb	r2, [r3, #4]
  56:../Sensor/sensor.c ****     case SENSOR_UPDATE:
  57              		.loc 1 56 9 is_stmt 1 view .LVU7
  58 0014 FAE7     		b	.L1
  59              	.L3:
  58:../Sensor/sensor.c ****         for (ENUM_SENSOR sensor_id = 0; sensor_id < SENSOR_NUMBER; sensor_id++) //ÈÅçÂéÜÊï¥‰∏™‰º†ÊÑ
  60              		.loc 1 58 9 view .LVU8
  58:../Sensor/sensor.c ****         for (ENUM_SENSOR sensor_id = 0; sensor_id < SENSOR_NUMBER; sensor_id++) //ÈÅçÂéÜÊï¥‰∏™‰º†ÊÑ
  61              		.loc 1 58 17 is_stmt 0 view .LVU9
  62 0016 134A     		ldr	r2, .L9
  63 0018 1368     		ldr	r3, [r2]
  58:../Sensor/sensor.c ****         for (ENUM_SENSOR sensor_id = 0; sensor_id < SENSOR_NUMBER; sensor_id++) //ÈÅçÂéÜÊï¥‰∏™‰º†ÊÑ
  64              		.loc 1 58 21 view .LVU10
  65 001a 0133     		adds	r3, r3, #1
  66 001c 1360     		str	r3, [r2]
  59:../Sensor/sensor.c ****         {
  67              		.loc 1 59 9 is_stmt 1 view .LVU11
  68              	.LBB2:
  59:../Sensor/sensor.c ****         {
  69              		.loc 1 59 14 view .LVU12
  70              	.LVL0:
  59:../Sensor/sensor.c ****         {
  71              		.loc 1 59 26 is_stmt 0 view .LVU13
  72 001e 0024     		movs	r4, #0
  59:../Sensor/sensor.c ****         {
  73              		.loc 1 59 9 view .LVU14
  74 0020 01E0     		b	.L5
  75              	.LVL1:
  76              	.L6:
  59:../Sensor/sensor.c ****         {
  77              		.loc 1 59 68 is_stmt 1 discriminator 2 view .LVU15
  59:../Sensor/sensor.c ****         {
  78              		.loc 1 59 77 is_stmt 0 discriminator 2 view .LVU16
  79 0022 0134     		adds	r4, r4, #1
  80              	.LVL2:
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 4


  59:../Sensor/sensor.c ****         {
  81              		.loc 1 59 77 discriminator 2 view .LVU17
  82 0024 64B2     		sxtb	r4, r4
  83              	.LVL3:
  84              	.L5:
  59:../Sensor/sensor.c ****         {
  85              		.loc 1 59 41 is_stmt 1 discriminator 1 view .LVU18
  59:../Sensor/sensor.c ****         {
  86              		.loc 1 59 9 is_stmt 0 discriminator 1 view .LVU19
  87 0026 002C     		cmp	r4, #0
  88 0028 F0DC     		bgt	.L1
  61:../Sensor/sensor.c ****             {
  89              		.loc 1 61 13 is_stmt 1 view .LVU20
  61:../Sensor/sensor.c ****             {
  90              		.loc 1 61 42 is_stmt 0 view .LVU21
  91 002a 0F4B     		ldr	r3, .L9+4
  92 002c 03EB0413 		add	r3, r3, r4, lsl #4
  93 0030 5968     		ldr	r1, [r3, #4]
  61:../Sensor/sensor.c ****             {
  94              		.loc 1 61 16 view .LVU22
  95 0032 0029     		cmp	r1, #0
  96 0034 F5D0     		beq	.L6
  61:../Sensor/sensor.c ****             {
  97              		.loc 1 61 79 discriminator 1 view .LVU23
  98 0036 2301     		lsls	r3, r4, #4
  99 0038 0B4A     		ldr	r2, .L9+4
 100 003a D25A     		ldrh	r2, [r2, r3]
  61:../Sensor/sensor.c ****             {
 101              		.loc 1 61 51 discriminator 1 view .LVU24
 102 003c 002A     		cmp	r2, #0
 103 003e F0D0     		beq	.L6
  67:../Sensor/sensor.c ****             {
 104              		.loc 1 67 13 is_stmt 1 view .LVU25
  67:../Sensor/sensor.c ****             {
 105              		.loc 1 67 27 is_stmt 0 view .LVU26
 106 0040 084B     		ldr	r3, .L9
 107 0042 1B68     		ldr	r3, [r3]
  67:../Sensor/sensor.c ****             {
 108              		.loc 1 67 32 view .LVU27
 109 0044 B3FBF2F0 		udiv	r0, r3, r2
 110 0048 02FB1033 		mls	r3, r2, r0, r3
  67:../Sensor/sensor.c ****             {
 111              		.loc 1 67 16 view .LVU28
 112 004c 002B     		cmp	r3, #0
 113 004e E8D1     		bne	.L6
  69:../Sensor/sensor.c ****             }
 114              		.loc 1 69 17 is_stmt 1 view .LVU29
  69:../Sensor/sensor.c ****             }
 115              		.loc 1 69 60 is_stmt 0 view .LVU30
 116 0050 8847     		blx	r1
 117              	.LVL4:
  69:../Sensor/sensor.c ****             }
 118              		.loc 1 69 40 view .LVU31
 119 0052 04EB4405 		add	r5, r4, r4, lsl #1
 120 0056 054B     		ldr	r3, .L9+8
 121 0058 03EB8505 		add	r5, r3, r5, lsl #2
 122 005c 07C8     		ldm	r0, {r0, r1, r2}
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 5


 123 005e 85E80700 		stm	r5, {r0, r1, r2}
 124 0062 DEE7     		b	.L6
 125              	.L10:
 126              		.align	2
 127              	.L9:
 128 0064 00000000 		.word	.LANCHOR0
 129 0068 00000000 		.word	.LANCHOR1
 130 006c 00000000 		.word	.LANCHOR2
 131              	.LBE2:
 132              		.cfi_endproc
 133              	.LFE0:
 135              		.section	.text.sensor_user_read,"ax",%progbits
 136              		.align	1
 137              		.global	sensor_user_read
 138              		.syntax unified
 139              		.thumb
 140              		.thumb_func
 142              	sensor_user_read:
 143              	.LVL5:
 144              	.LFB1:
  81:../Sensor/sensor.c **** 
  82:../Sensor/sensor.c **** /*-------------Áî®Êà∑ËØªÂèñÊåáÂÆö‰º†ÊÑüÂô®-----------*/
  83:../Sensor/sensor.c **** void* sensor_user_read(ENUM_SENSOR sensor_id)
  84:../Sensor/sensor.c **** {
 145              		.loc 1 84 1 is_stmt 1 view -0
 146              		.cfi_startproc
 147              		@ args = 0, pretend = 0, frame = 0
 148              		@ frame_needed = 0, uses_anonymous_args = 0
 149              		.loc 1 84 1 is_stmt 0 view .LVU33
 150 0000 08B5     		push	{r3, lr}
 151              	.LCFI1:
 152              		.cfi_def_cfa_offset 8
 153              		.cfi_offset 3, -8
 154              		.cfi_offset 14, -4
  85:../Sensor/sensor.c ****     static volatile sensor_data_t rawdata;
 155              		.loc 1 85 5 is_stmt 1 view .LVU34
  86:../Sensor/sensor.c ****     if (sensor_id <= SENSOR_NONE || sensor_id > SENSOR_NUMBER)
 156              		.loc 1 86 5 view .LVU35
 157              		.loc 1 86 34 is_stmt 0 view .LVU36
 158 0002 C3B2     		uxtb	r3, r0
 159              		.loc 1 86 8 view .LVU37
 160 0004 012B     		cmp	r3, #1
 161 0006 18D8     		bhi	.L14
  87:../Sensor/sensor.c ****     {
  88:../Sensor/sensor.c ****         /* err state */
  89:../Sensor/sensor.c ****         return 0;
  90:../Sensor/sensor.c ****     }
  91:../Sensor/sensor.c ****     sensor_t *pcursensor;
 162              		.loc 1 91 5 is_stmt 1 view .LVU38
  92:../Sensor/sensor.c ****     pcursensor = &g_sensor_arry[sensor_id];
 163              		.loc 1 92 5 view .LVU39
 164              	.LVL6:
  93:../Sensor/sensor.c **** 
  94:../Sensor/sensor.c ****     if (!pcursensor->cycle)
 165              		.loc 1 94 5 view .LVU40
 166              		.loc 1 94 20 is_stmt 0 view .LVU41
 167 0008 0301     		lsls	r3, r0, #4
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 6


 168 000a 0D4A     		ldr	r2, .L16
 169 000c D35A     		ldrh	r3, [r2, r3]
 170              		.loc 1 94 8 view .LVU42
 171 000e 4BB9     		cbnz	r3, .L13
  95:../Sensor/sensor.c ****     {
  96:../Sensor/sensor.c ****         rawdata = *(sensor_data_t *)pcursensor->pf_read();
 172              		.loc 1 96 9 is_stmt 1 view .LVU43
 173              		.loc 1 96 47 is_stmt 0 view .LVU44
 174 0010 02EB0010 		add	r0, r2, r0, lsl #4
 175              	.LVL7:
 176              		.loc 1 96 47 view .LVU45
 177 0014 4368     		ldr	r3, [r0, #4]
 178              		.loc 1 96 37 view .LVU46
 179 0016 9847     		blx	r3
 180              	.LVL8:
 181              		.loc 1 96 17 view .LVU47
 182 0018 0A4B     		ldr	r3, .L16+4
 183 001a 07C8     		ldm	r0, {r0, r1, r2}
 184 001c 83E80700 		stm	r3, {r0, r1, r2}
  97:../Sensor/sensor.c ****     }else{
  98:../Sensor/sensor.c ****         rawdata = g_data_arry[sensor_id];        
  99:../Sensor/sensor.c ****     }
 100:../Sensor/sensor.c ****     return &rawdata;
 185              		.loc 1 100 12 view .LVU48
 186 0020 1846     		mov	r0, r3
 187              	.L11:
 101:../Sensor/sensor.c **** }
 188              		.loc 1 101 1 view .LVU49
 189 0022 08BD     		pop	{r3, pc}
 190              	.LVL9:
 191              	.L13:
  98:../Sensor/sensor.c ****     }
 192              		.loc 1 98 9 is_stmt 1 view .LVU50
  98:../Sensor/sensor.c ****     }
 193              		.loc 1 98 17 is_stmt 0 view .LVU51
 194 0024 074B     		ldr	r3, .L16+4
 195 0026 00EB4000 		add	r0, r0, r0, lsl #1
 196              	.LVL10:
  98:../Sensor/sensor.c ****     }
 197              		.loc 1 98 17 view .LVU52
 198 002a 074A     		ldr	r2, .L16+8
 199 002c 02EB8000 		add	r0, r2, r0, lsl #2
 200 0030 07C8     		ldm	r0, {r0, r1, r2}
 201 0032 83E80700 		stm	r3, {r0, r1, r2}
 100:../Sensor/sensor.c **** }
 202              		.loc 1 100 12 view .LVU53
 203 0036 1846     		mov	r0, r3
 204 0038 F3E7     		b	.L11
 205              	.LVL11:
 206              	.L14:
  89:../Sensor/sensor.c ****     }
 207              		.loc 1 89 16 view .LVU54
 208 003a 0020     		movs	r0, #0
 209              	.LVL12:
  89:../Sensor/sensor.c ****     }
 210              		.loc 1 89 16 view .LVU55
 211 003c F1E7     		b	.L11
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 7


 212              	.L17:
 213 003e 00BF     		.align	2
 214              	.L16:
 215 0040 00000000 		.word	.LANCHOR1
 216 0044 00000000 		.word	.LANCHOR3
 217 0048 00000000 		.word	.LANCHOR2
 218              		.cfi_endproc
 219              	.LFE1:
 221              		.global	g_sensor
 222              		.section	.bss.g_data_arry,"aw",%nobits
 223              		.align	2
 224              		.set	.LANCHOR2,. + 0
 227              	g_data_arry:
 228 0000 00000000 		.space	24
 228      00000000 
 228      00000000 
 228      00000000 
 228      00000000 
 229              		.section	.bss.g_sensor,"aw",%nobits
 230              		.align	2
 231              		.set	.LANCHOR0,. + 0
 234              	g_sensor:
 235 0000 00000000 		.space	8
 235      00000000 
 236              		.section	.bss.rawdata.0,"aw",%nobits
 237              		.align	2
 238              		.set	.LANCHOR3,. + 0
 241              	rawdata.0:
 242 0000 00000000 		.space	12
 242      00000000 
 242      00000000 
 243              		.section	.rodata.g_sensor_arry,"a"
 244              		.align	2
 245              		.set	.LANCHOR1,. + 0
 248              	g_sensor_arry:
 249 0000 0000     		.short	0
 250 0002 01       		.byte	1
 251 0003 00       		.space	1
 252 0004 00000000 		.word	angle_read
 253 0008 00000000 		.word	0
 254 000c 00000000 		.word	0
 255 0010 0000     		.short	0
 256 0012 0000     		.space	2
 257 0014 00000000 		.word	0
 258 0018 00000000 		.word	0
 259 001c 00000000 		.space	4
 260              		.text
 261              	.Letext0:
 262              		.file 2 "../Sensor/sensor_cfg.h"
 263              		.file 3 "../Sensor/sensor.h"
ARM GAS  C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 sensor.c
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:20     .text.sensor_process:00000000 $t
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:26     .text.sensor_process:00000000 sensor_process
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:128    .text.sensor_process:00000064 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:136    .text.sensor_user_read:00000000 $t
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:142    .text.sensor_user_read:00000000 sensor_user_read
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:215    .text.sensor_user_read:00000040 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:234    .bss.g_sensor:00000000 g_sensor
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:223    .bss.g_data_arry:00000000 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:227    .bss.g_data_arry:00000000 g_data_arry
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:230    .bss.g_sensor:00000000 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:237    .bss.rawdata.0:00000000 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:241    .bss.rawdata.0:00000000 rawdata.0
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:244    .rodata.g_sensor_arry:00000000 $d
C:\Users\zhangge\AppData\Local\Temp\ccHy2GFQ.s:248    .rodata.g_sensor_arry:00000000 g_sensor_arry

UNDEFINED SYMBOLS
angle_read
