ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"protocol.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.protocol_reciverdata_tofifo,"ax",%progbits
  18              		.align	1
  19              		.global	protocol_reciverdata_tofifo
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	protocol_reciverdata_tofifo:
  27              	.LVL0:
  28              	.LFB0:
  29              		.file 1 "../Protocol/protocol.c"
   1:../Protocol/protocol.c **** /*-----------------------------模块提交说明--------------------------------------
   2:../Protocol/protocol.c **** 优化了消息地图的命名
   3:../Protocol/protocol.c ****     1、复位之后，发送第一条测试指令，如果0B指令先响应，则有内存断言失败情况出现
   4:../Protocol/protocol.c ****         但不会死机。
   5:../Protocol/protocol.c **** 
   6:../Protocol/protocol.c **** 1、测试协议重发流程
   7:../Protocol/protocol.c ****     1、使用串口助手发送
   8:../Protocol/protocol.c ****         5A A5 00 01 00 27 92 FE FE指令，触发数据重发功能
   9:../Protocol/protocol.c ****     2、观察串口助手的打印数据    
  10:../Protocol/protocol.c ****         可以观察到有两组命令同时在发送
  11:../Protocol/protocol.c **** 
  12:../Protocol/protocol.c ****         1、使用串口助手发送5A A5 02 0A 00 08 CD CC CC 40 33 33 13 40 44 71 FE FE/5A A5 00 0B 00 08 
  13:../Protocol/protocol.c ****             可观察到对应的命令停止发送
  14:../Protocol/protocol.c **** 
  15:../Protocol/protocol.c **** 2、存在的问题点 1、申请内存失败存在
  16:../Protocol/protocol.c ****                2、状态机调度过程中会发生hardfalt
  17:../Protocol/protocol.c **** 3、结论：
  18:../Protocol/protocol.c ****     该例程基本上可以实现消息的非阻塞式重发功能，但还需继续优化
  19:../Protocol/protocol.c **** */
  20:../Protocol/protocol.c **** #include "protocol_comment.h"
  21:../Protocol/protocol.c **** #include "protocol_cfg.h"
  22:../Protocol/protocol.c **** #include "protocol.h"
  23:../Protocol/protocol.c **** /*-------------------------------FIFO组件------------------------------------------*/
  24:../Protocol/protocol.c **** static unsigned char fifo_receive_buff[PRO_FIFO_SIZE];//fifo数据缓存区
  25:../Protocol/protocol.c **** static byte_fifo_t protocol_fifo_handle;//fifo控制块
  26:../Protocol/protocol.c **** 
  27:../Protocol/protocol.c **** _list_t *gtransmit_list;
  28:../Protocol/protocol.c **** unsigned short g_protocol_event;
  29:../Protocol/protocol.c **** /*-------------------------------协议间同步事件-----------------------------*/
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 2


  30:../Protocol/protocol.c **** 
  31:../Protocol/protocol.c **** /**************************************************************************************************
  32:../Protocol/protocol.c **** ** Function name(函数名称):				protocol_reciverdata_tofifo()
  33:../Protocol/protocol.c **** **
  34:../Protocol/protocol.c **** ** Descriptions（描述）:				接收一帧数据给FIFO组件
  35:../Protocol/protocol.c **** **
  36:../Protocol/protocol.c **** ** input parameters（输入参数）:		len:一帧数据长度(包含帧头、帧尾)
  37:../Protocol/protocol.c **** ** Returned value（返回值）:				0:成功
  38:../Protocol/protocol.c **** **
  39:../Protocol/protocol.c **** ** Calling modules（调用模块）:			fifo.c/h
  40:../Protocol/protocol.c **** ***************************************************************************************************
  41:../Protocol/protocol.c **** unsigned char protocol_reciverdata_tofifo(unsigned char *pdata,unsigned short len)
  42:../Protocol/protocol.c **** {
  30              		.loc 1 42 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 42 1 is_stmt 0 view .LVU1
  35 0000 08B5     		push	{r3, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 8
  38              		.cfi_offset 3, -8
  39              		.cfi_offset 14, -4
  40 0002 0A46     		mov	r2, r1
  43:../Protocol/protocol.c **** 	bytefifo_writemulitebyge(&protocol_fifo_handle,pdata,len);
  41              		.loc 1 43 2 is_stmt 1 view .LVU2
  42 0004 0146     		mov	r1, r0
  43              	.LVL1:
  44              		.loc 1 43 2 is_stmt 0 view .LVU3
  45 0006 0248     		ldr	r0, .L3
  46              	.LVL2:
  47              		.loc 1 43 2 view .LVU4
  48 0008 FFF7FEFF 		bl	bytefifo_writemulitebyge
  49              	.LVL3:
  44:../Protocol/protocol.c **** 	return 0;
  50              		.loc 1 44 2 is_stmt 1 view .LVU5
  45:../Protocol/protocol.c **** }
  51              		.loc 1 45 1 is_stmt 0 view .LVU6
  52 000c 0020     		movs	r0, #0
  53 000e 08BD     		pop	{r3, pc}
  54              	.L4:
  55              		.align	2
  56              	.L3:
  57 0010 00000000 		.word	.LANCHOR0
  58              		.cfi_endproc
  59              	.LFE0:
  61              		.section	.text._get_framedata_fromfifo,"ax",%progbits
  62              		.align	1
  63              		.global	_get_framedata_fromfifo
  64              		.syntax unified
  65              		.thumb
  66              		.thumb_func
  67              		.fpu fpv4-sp-d16
  69              	_get_framedata_fromfifo:
  70              	.LVL4:
  71              	.LFB1:
  46:../Protocol/protocol.c **** char _get_framedata_fromfifo(unsigned char *pbuf,unsigned short *pframe_len)
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 3


  47:../Protocol/protocol.c **** {
  72              		.loc 1 47 1 is_stmt 1 view -0
  73              		.cfi_startproc
  74              		@ args = 0, pretend = 0, frame = 8
  75              		@ frame_needed = 0, uses_anonymous_args = 0
  76              		.loc 1 47 1 is_stmt 0 view .LVU8
  77 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  78              	.LCFI1:
  79              		.cfi_def_cfa_offset 20
  80              		.cfi_offset 4, -20
  81              		.cfi_offset 5, -16
  82              		.cfi_offset 6, -12
  83              		.cfi_offset 7, -8
  84              		.cfi_offset 14, -4
  85 0002 83B0     		sub	sp, sp, #12
  86              	.LCFI2:
  87              		.cfi_def_cfa_offset 32
  88 0004 0646     		mov	r6, r0
  89 0006 0F46     		mov	r7, r1
  48:../Protocol/protocol.c ****     enum {
  90              		.loc 1 48 5 is_stmt 1 view .LVU9
  49:../Protocol/protocol.c ****         START,
  50:../Protocol/protocol.c ****         FIRST ,
  51:../Protocol/protocol.c ****         SECOND,
  52:../Protocol/protocol.c ****         IDLE ,			
  53:../Protocol/protocol.c ****     };
  54:../Protocol/protocol.c ****     unsigned short index = 0;	
  91              		.loc 1 54 5 view .LVU10
  92              	.LVL5:
  55:../Protocol/protocol.c ****     unsigned char data;
  93              		.loc 1 55 5 view .LVU11
  56:../Protocol/protocol.c ****     unsigned char chState = START;
  94              		.loc 1 56 5 view .LVU12
  57:../Protocol/protocol.c ****            
  58:../Protocol/protocol.c ****     switch (chState)
  95              		.loc 1 58 5 view .LVU13
  59:../Protocol/protocol.c ****     {
  60:../Protocol/protocol.c ****     case START:
  61:../Protocol/protocol.c ****         chState = FIRST;
  96              		.loc 1 61 9 view .LVU14
  62:../Protocol/protocol.c ****     case FIRST:
  63:../Protocol/protocol.c ****         bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
  97              		.loc 1 63 9 view .LVU15
  98 0008 0122     		movs	r2, #1
  99 000a 0DF10701 		add	r1, sp, #7
 100              	.LVL6:
 101              		.loc 1 63 9 is_stmt 0 view .LVU16
 102 000e 2248     		ldr	r0, .L17
 103              	.LVL7:
 104              		.loc 1 63 9 view .LVU17
 105 0010 FFF7FEFF 		bl	bytefifo_readmulintebyte
 106              	.LVL8:
  64:../Protocol/protocol.c ****         if(data == (unsigned char)(PRO_FRAME_HEAD>>8))
 107              		.loc 1 64 9 is_stmt 1 view .LVU18
 108              		.loc 1 64 17 is_stmt 0 view .LVU19
 109 0014 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 110              		.loc 1 64 11 view .LVU20
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 4


 111 0018 5A2B     		cmp	r3, #90
 112 001a 02D0     		beq	.L14
  65:../Protocol/protocol.c ****         {
  66:../Protocol/protocol.c ****             pbuf[index++] = data;
  67:../Protocol/protocol.c ****             data = 0;
  68:../Protocol/protocol.c ****             chState = SECOND;
  69:../Protocol/protocol.c ****         }else{
  70:../Protocol/protocol.c ****             index = 0;
  71:../Protocol/protocol.c ****             chState = START;
  72:../Protocol/protocol.c ****             break;
  73:../Protocol/protocol.c ****         }
  74:../Protocol/protocol.c ****     case SECOND:
  75:../Protocol/protocol.c ****         bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
  76:../Protocol/protocol.c ****         if(data == (unsigned char)(PRO_FRAME_HEAD))
  77:../Protocol/protocol.c ****         {
  78:../Protocol/protocol.c ****             chState = IDLE;
  79:../Protocol/protocol.c ****             pbuf[index++] = data;
  80:../Protocol/protocol.c ****         }else{
  81:../Protocol/protocol.c ****             chState = START;
  82:../Protocol/protocol.c ****             break;
  83:../Protocol/protocol.c ****         }
  84:../Protocol/protocol.c ****         case IDLE:
  85:../Protocol/protocol.c ****             do
  86:../Protocol/protocol.c ****             {
  87:../Protocol/protocol.c ****                 if(index >= PRO_FRAME_MAX_SIZE)
  88:../Protocol/protocol.c ****                 {
  89:../Protocol/protocol.c ****                     /* code */
  90:../Protocol/protocol.c ****                     *pframe_len = 0;
  91:../Protocol/protocol.c ****                     index = 0;
  92:../Protocol/protocol.c ****                     chState = START;//获取到完整的数据帧  复位状态机
  93:../Protocol/protocol.c ****                     return 1;
  94:../Protocol/protocol.c ****                 }
  95:../Protocol/protocol.c ****                 bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
  96:../Protocol/protocol.c ****                 pbuf[index++] = data;
  97:../Protocol/protocol.c ****                 if(data == (unsigned char)(PRO_FRAME_TAIL>>8))
  98:../Protocol/protocol.c ****                 {
  99:../Protocol/protocol.c ****                     data = 0;
 100:../Protocol/protocol.c ****                     bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
 101:../Protocol/protocol.c ****                     pbuf[index++] = data;
 102:../Protocol/protocol.c ****                     if (data == (unsigned char)(PRO_FRAME_TAIL>>8))
 103:../Protocol/protocol.c ****                     {
 104:../Protocol/protocol.c ****                         /* code */
 105:../Protocol/protocol.c ****                         *pframe_len = index;
 106:../Protocol/protocol.c ****                         index = 0;
 107:../Protocol/protocol.c ****                         chState = START;//获取到完整的数据帧  复位状态机
 108:../Protocol/protocol.c ****                         return 0;
 109:../Protocol/protocol.c ****                     }
 110:../Protocol/protocol.c ****                 }
 111:../Protocol/protocol.c ****             } while (1);
 112:../Protocol/protocol.c ****             break;
 113:../Protocol/protocol.c ****     default:
 114:../Protocol/protocol.c ****         break;
 115:../Protocol/protocol.c ****     }
 116:../Protocol/protocol.c ****     return 1;
 113              		.loc 1 116 12 view .LVU21
 114 001c 0120     		movs	r0, #1
 115              	.LVL9:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 5


 116              	.L6:
 117:../Protocol/protocol.c **** }
 117              		.loc 1 117 1 view .LVU22
 118 001e 03B0     		add	sp, sp, #12
 119              	.LCFI3:
 120              		.cfi_remember_state
 121              		.cfi_def_cfa_offset 20
 122              		@ sp needed
 123 0020 F0BD     		pop	{r4, r5, r6, r7, pc}
 124              	.LVL10:
 125              	.L14:
 126              	.LCFI4:
 127              		.cfi_restore_state
  66:../Protocol/protocol.c ****             data = 0;
 128              		.loc 1 66 13 is_stmt 1 view .LVU23
  66:../Protocol/protocol.c ****             data = 0;
 129              		.loc 1 66 27 is_stmt 0 view .LVU24
 130 0022 3370     		strb	r3, [r6]
  67:../Protocol/protocol.c ****             chState = SECOND;
 131              		.loc 1 67 13 is_stmt 1 view .LVU25
  67:../Protocol/protocol.c ****             chState = SECOND;
 132              		.loc 1 67 18 is_stmt 0 view .LVU26
 133 0024 0023     		movs	r3, #0
 134 0026 8DF80730 		strb	r3, [sp, #7]
  68:../Protocol/protocol.c ****         }else{
 135              		.loc 1 68 13 is_stmt 1 view .LVU27
 136              	.LVL11:
  75:../Protocol/protocol.c ****         if(data == (unsigned char)(PRO_FRAME_HEAD))
 137              		.loc 1 75 9 view .LVU28
 138 002a 0122     		movs	r2, #1
 139 002c 0DF10701 		add	r1, sp, #7
 140 0030 1948     		ldr	r0, .L17
 141 0032 FFF7FEFF 		bl	bytefifo_readmulintebyte
 142              	.LVL12:
  76:../Protocol/protocol.c ****         {
 143              		.loc 1 76 9 view .LVU29
  76:../Protocol/protocol.c ****         {
 144              		.loc 1 76 17 is_stmt 0 view .LVU30
 145 0036 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
  76:../Protocol/protocol.c ****         {
 146              		.loc 1 76 11 view .LVU31
 147 003a A52B     		cmp	r3, #165
 148 003c 01D0     		beq	.L15
 116:../Protocol/protocol.c **** }
 149              		.loc 1 116 12 view .LVU32
 150 003e 0120     		movs	r0, #1
 151 0040 EDE7     		b	.L6
 152              	.L15:
  78:../Protocol/protocol.c ****             pbuf[index++] = data;
 153              		.loc 1 78 13 is_stmt 1 view .LVU33
 154              	.LVL13:
  79:../Protocol/protocol.c ****         }else{
 155              		.loc 1 79 13 view .LVU34
  79:../Protocol/protocol.c ****         }else{
 156              		.loc 1 79 27 is_stmt 0 view .LVU35
 157 0042 7370     		strb	r3, [r6, #1]
 158 0044 0224     		movs	r4, #2
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 6


 159 0046 00E0     		b	.L8
 160              	.LVL14:
 161              	.L12:
  96:../Protocol/protocol.c ****                 if(data == (unsigned char)(PRO_FRAME_TAIL>>8))
 162              		.loc 1 96 27 view .LVU36
 163 0048 2C46     		mov	r4, r5
 164              	.LVL15:
 165              	.L8:
  85:../Protocol/protocol.c ****             {
 166              		.loc 1 85 13 is_stmt 1 view .LVU37
  87:../Protocol/protocol.c ****                 {
 167              		.loc 1 87 17 view .LVU38
  87:../Protocol/protocol.c ****                 {
 168              		.loc 1 87 19 is_stmt 0 view .LVU39
 169 004a FF2C     		cmp	r4, #255
 170 004c 1FD8     		bhi	.L16
  95:../Protocol/protocol.c ****                 pbuf[index++] = data;
 171              		.loc 1 95 17 is_stmt 1 view .LVU40
 172 004e 0122     		movs	r2, #1
 173 0050 0DF10701 		add	r1, sp, #7
 174 0054 1048     		ldr	r0, .L17
 175 0056 FFF7FEFF 		bl	bytefifo_readmulintebyte
 176              	.LVL16:
  96:../Protocol/protocol.c ****                 if(data == (unsigned char)(PRO_FRAME_TAIL>>8))
 177              		.loc 1 96 17 view .LVU41
  96:../Protocol/protocol.c ****                 if(data == (unsigned char)(PRO_FRAME_TAIL>>8))
 178              		.loc 1 96 27 is_stmt 0 view .LVU42
 179 005a 651C     		adds	r5, r4, #1
 180 005c ADB2     		uxth	r5, r5
 181              	.LVL17:
  96:../Protocol/protocol.c ****                 if(data == (unsigned char)(PRO_FRAME_TAIL>>8))
 182              		.loc 1 96 31 view .LVU43
 183 005e 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 184 0062 3355     		strb	r3, [r6, r4]
  97:../Protocol/protocol.c ****                 {
 185              		.loc 1 97 17 is_stmt 1 view .LVU44
  97:../Protocol/protocol.c ****                 {
 186              		.loc 1 97 19 is_stmt 0 view .LVU45
 187 0064 FE2B     		cmp	r3, #254
 188 0066 EFD1     		bne	.L12
  99:../Protocol/protocol.c ****                     bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
 189              		.loc 1 99 21 is_stmt 1 view .LVU46
  99:../Protocol/protocol.c ****                     bytefifo_readmulintebyte(&protocol_fifo_handle,&data,1);
 190              		.loc 1 99 26 is_stmt 0 view .LVU47
 191 0068 0023     		movs	r3, #0
 192 006a 8DF80730 		strb	r3, [sp, #7]
 100:../Protocol/protocol.c ****                     pbuf[index++] = data;
 193              		.loc 1 100 21 is_stmt 1 view .LVU48
 194 006e 0122     		movs	r2, #1
 195 0070 0DF10701 		add	r1, sp, #7
 196 0074 0848     		ldr	r0, .L17
 197 0076 FFF7FEFF 		bl	bytefifo_readmulintebyte
 198              	.LVL18:
 101:../Protocol/protocol.c ****                     if (data == (unsigned char)(PRO_FRAME_TAIL>>8))
 199              		.loc 1 101 21 view .LVU49
 101:../Protocol/protocol.c ****                     if (data == (unsigned char)(PRO_FRAME_TAIL>>8))
 200              		.loc 1 101 31 is_stmt 0 view .LVU50
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 7


 201 007a 0234     		adds	r4, r4, #2
 202 007c A4B2     		uxth	r4, r4
 203              	.LVL19:
 101:../Protocol/protocol.c ****                     if (data == (unsigned char)(PRO_FRAME_TAIL>>8))
 204              		.loc 1 101 35 view .LVU51
 205 007e 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 206 0082 7355     		strb	r3, [r6, r5]
 102:../Protocol/protocol.c ****                     {
 207              		.loc 1 102 21 is_stmt 1 view .LVU52
 102:../Protocol/protocol.c ****                     {
 208              		.loc 1 102 24 is_stmt 0 view .LVU53
 209 0084 FE2B     		cmp	r3, #254
 210 0086 E0D1     		bne	.L8
 105:../Protocol/protocol.c ****                         index = 0;
 211              		.loc 1 105 25 is_stmt 1 view .LVU54
 105:../Protocol/protocol.c ****                         index = 0;
 212              		.loc 1 105 37 is_stmt 0 view .LVU55
 213 0088 3C80     		strh	r4, [r7]	@ movhi
 106:../Protocol/protocol.c ****                         chState = START;//获取到完整的数据帧  复位状态机
 214              		.loc 1 106 25 is_stmt 1 view .LVU56
 215              	.LVL20:
 107:../Protocol/protocol.c ****                         return 0;
 216              		.loc 1 107 25 view .LVU57
 108:../Protocol/protocol.c ****                     }
 217              		.loc 1 108 25 view .LVU58
 108:../Protocol/protocol.c ****                     }
 218              		.loc 1 108 32 is_stmt 0 view .LVU59
 219 008a 0020     		movs	r0, #0
 220 008c C7E7     		b	.L6
 221              	.LVL21:
 222              	.L16:
  90:../Protocol/protocol.c ****                     index = 0;
 223              		.loc 1 90 21 is_stmt 1 view .LVU60
  90:../Protocol/protocol.c ****                     index = 0;
 224              		.loc 1 90 33 is_stmt 0 view .LVU61
 225 008e 0023     		movs	r3, #0
 226 0090 3B80     		strh	r3, [r7]	@ movhi
  91:../Protocol/protocol.c ****                     chState = START;//获取到完整的数据帧  复位状态机
 227              		.loc 1 91 21 is_stmt 1 view .LVU62
 228              	.LVL22:
  92:../Protocol/protocol.c ****                     return 1;
 229              		.loc 1 92 21 view .LVU63
  93:../Protocol/protocol.c ****                 }
 230              		.loc 1 93 21 view .LVU64
  93:../Protocol/protocol.c ****                 }
 231              		.loc 1 93 28 is_stmt 0 view .LVU65
 232 0092 0120     		movs	r0, #1
 233 0094 C3E7     		b	.L6
 234              	.L18:
 235 0096 00BF     		.align	2
 236              	.L17:
 237 0098 00000000 		.word	.LANCHOR0
 238              		.cfi_endproc
 239              	.LFE1:
 241              		.section	.text._packet_propack,"ax",%progbits
 242              		.align	1
 243              		.global	_packet_propack
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 8


 244              		.syntax unified
 245              		.thumb
 246              		.thumb_func
 247              		.fpu fpv4-sp-d16
 249              	_packet_propack:
 250              	.LVL23:
 251              	.LFB2:
 118:../Protocol/protocol.c **** 
 119:../Protocol/protocol.c **** 
 120:../Protocol/protocol.c **** /*----------------------------封包协议包----------------------------------------------------------*
 121:../Protocol/protocol.c **** pro_pack_t* _packet_propack(pro_frame_t *frame,unsigned int timeout,unsigned char recnt)
 122:../Protocol/protocol.c **** {   
 252              		.loc 1 122 1 is_stmt 1 view -0
 253              		.cfi_startproc
 254              		@ args = 0, pretend = 0, frame = 8
 255              		@ frame_needed = 0, uses_anonymous_args = 0
 256              		.loc 1 122 1 is_stmt 0 view .LVU67
 257 0000 70B5     		push	{r4, r5, r6, lr}
 258              	.LCFI5:
 259              		.cfi_def_cfa_offset 16
 260              		.cfi_offset 4, -16
 261              		.cfi_offset 5, -12
 262              		.cfi_offset 6, -8
 263              		.cfi_offset 14, -4
 264 0002 82B0     		sub	sp, sp, #8
 265              	.LCFI6:
 266              		.cfi_def_cfa_offset 24
 267 0004 0546     		mov	r5, r0
 123:../Protocol/protocol.c ****     fsm_cb_t fsmcb;
 268              		.loc 1 123 5 is_stmt 1 view .LVU68
 124:../Protocol/protocol.c ****     pro_pack_t* p_propack = heap_malloc(sizeof(pro_pack_t));
 269              		.loc 1 124 5 view .LVU69
 270              		.loc 1 124 29 is_stmt 0 view .LVU70
 271 0006 1420     		movs	r0, #20
 272              	.LVL24:
 273              		.loc 1 124 29 view .LVU71
 274 0008 FFF7FEFF 		bl	heap_malloc
 275              	.LVL25:
 276              		.loc 1 124 29 view .LVU72
 277 000c 0446     		mov	r4, r0
 278              	.LVL26:
 125:../Protocol/protocol.c ****     fsm_init(&fsmcb,1,(fsm_t *)_trancemit_statemach);
 279              		.loc 1 125 5 is_stmt 1 view .LVU73
 280 000e 6E46     		mov	r6, sp
 281 0010 084A     		ldr	r2, .L21
 282 0012 0121     		movs	r1, #1
 283 0014 3046     		mov	r0, r6
 284              	.LVL27:
 285              		.loc 1 125 5 is_stmt 0 view .LVU74
 286 0016 FFF7FEFF 		bl	fsm_init
 287              	.LVL28:
 126:../Protocol/protocol.c ****     p_propack->statemach_cb = fsmcb;
 288              		.loc 1 126 5 is_stmt 1 view .LVU75
 289              		.loc 1 126 29 is_stmt 0 view .LVU76
 290 001a 96E80300 		ldm	r6, {r0, r1}
 291 001e 84E80300 		stm	r4, {r0, r1}
 127:../Protocol/protocol.c ****     p_propack->timeout = 0;
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 9


 292              		.loc 1 127 5 is_stmt 1 view .LVU77
 293              		.loc 1 127 24 is_stmt 0 view .LVU78
 294 0022 0023     		movs	r3, #0
 295 0024 A360     		str	r3, [r4, #8]
 128:../Protocol/protocol.c ****     p_propack->recnt = 0;
 296              		.loc 1 128 5 is_stmt 1 view .LVU79
 297              		.loc 1 128 22 is_stmt 0 view .LVU80
 298 0026 A381     		strh	r3, [r4, #12]	@ movhi
 129:../Protocol/protocol.c ****     p_propack->t0 = 0;
 299              		.loc 1 129 5 is_stmt 1 view .LVU81
 300              		.loc 1 129 19 is_stmt 0 view .LVU82
 301 0028 E381     		strh	r3, [r4, #14]	@ movhi
 130:../Protocol/protocol.c ****     p_propack->frame = frame;   
 302              		.loc 1 130 5 is_stmt 1 view .LVU83
 303              		.loc 1 130 22 is_stmt 0 view .LVU84
 304 002a 2561     		str	r5, [r4, #16]
 131:../Protocol/protocol.c ****     return p_propack;
 305              		.loc 1 131 5 is_stmt 1 view .LVU85
 132:../Protocol/protocol.c **** }
 306              		.loc 1 132 1 is_stmt 0 view .LVU86
 307 002c 2046     		mov	r0, r4
 308 002e 02B0     		add	sp, sp, #8
 309              	.LCFI7:
 310              		.cfi_def_cfa_offset 16
 311              		@ sp needed
 312 0030 70BD     		pop	{r4, r5, r6, pc}
 313              	.LVL29:
 314              	.L22:
 315              		.loc 1 132 1 view .LVU87
 316 0032 00BF     		.align	2
 317              	.L21:
 318 0034 00000000 		.word	_trancemit_statemach
 319              		.cfi_endproc
 320              	.LFE2:
 322              		.section	.text._packet_proframe,"ax",%progbits
 323              		.align	1
 324              		.global	_packet_proframe
 325              		.syntax unified
 326              		.thumb
 327              		.thumb_func
 328              		.fpu fpv4-sp-d16
 330              	_packet_proframe:
 331              	.LVL30:
 332              	.LFB3:
 133:../Protocol/protocol.c **** 
 134:../Protocol/protocol.c **** /*-----------------------------封包协议帧-------------------------------------------------------
 135:../Protocol/protocol.c **** **return       一段连续的内存
 136:../Protocol/protocol.c **** */
 137:../Protocol/protocol.c **** pro_frame_t* _packet_proframe(unsigned short cmd,void *pdata,unsigned short len)
 138:../Protocol/protocol.c **** {
 333              		.loc 1 138 1 is_stmt 1 view -0
 334              		.cfi_startproc
 335              		@ args = 0, pretend = 0, frame = 0
 336              		@ frame_needed = 0, uses_anonymous_args = 0
 337              		.loc 1 138 1 is_stmt 0 view .LVU89
 338 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 339              	.LCFI8:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 10


 340              		.cfi_def_cfa_offset 24
 341              		.cfi_offset 3, -24
 342              		.cfi_offset 4, -20
 343              		.cfi_offset 5, -16
 344              		.cfi_offset 6, -12
 345              		.cfi_offset 7, -8
 346              		.cfi_offset 14, -4
 347 0002 0646     		mov	r6, r0
 348 0004 0F46     		mov	r7, r1
 349 0006 1546     		mov	r5, r2
 139:../Protocol/protocol.c ****     unsigned char *puctemp;
 350              		.loc 1 139 5 is_stmt 1 view .LVU90
 140:../Protocol/protocol.c ****     pro_frame_t *pfram;
 351              		.loc 1 140 5 view .LVU91
 141:../Protocol/protocol.c ****     puctemp = heap_malloc(sizeof(pro_frame_t) + len);
 352              		.loc 1 141 5 view .LVU92
 353              		.loc 1 141 15 is_stmt 0 view .LVU93
 354 0008 02F11000 		add	r0, r2, #16
 355              	.LVL31:
 356              		.loc 1 141 15 view .LVU94
 357 000c FFF7FEFF 		bl	heap_malloc
 358              	.LVL32:
 142:../Protocol/protocol.c ****     if(!puctemp)
 359              		.loc 1 142 5 is_stmt 1 view .LVU95
 360              		.loc 1 142 7 is_stmt 0 view .LVU96
 361 0010 0446     		mov	r4, r0
 362 0012 C8B1     		cbz	r0, .L27
 143:../Protocol/protocol.c ****     {
 144:../Protocol/protocol.c ****         heap_free(puctemp);
 145:../Protocol/protocol.c ****         return NULL;
 146:../Protocol/protocol.c ****     }
 147:../Protocol/protocol.c ****     pfram = (pro_frame_t *)puctemp;
 363              		.loc 1 147 5 is_stmt 1 view .LVU97
 364              	.LVL33:
 148:../Protocol/protocol.c ****     pfram->_x_x = 0x00;
 365              		.loc 1 148 5 view .LVU98
 366              		.loc 1 148 17 is_stmt 0 view .LVU99
 367 0014 0023     		movs	r3, #0
 368 0016 0380     		strh	r3, [r0]	@ movhi
 149:../Protocol/protocol.c ****     pfram->head = __SWP16(PRO_FRAME_HEAD);
 369              		.loc 1 149 5 is_stmt 1 view .LVU100
 370              		.loc 1 149 17 is_stmt 0 view .LVU101
 371 0018 4AF25A53 		movw	r3, #42330
 372 001c 4380     		strh	r3, [r0, #2]	@ movhi
 150:../Protocol/protocol.c ****     pfram->tail = __SWP16(PRO_FRAME_TAIL);
 373              		.loc 1 150 5 is_stmt 1 view .LVU102
 374              		.loc 1 150 17 is_stmt 0 view .LVU103
 375 001e 4FF6FE63 		movw	r3, #65278
 376 0022 C381     		strh	r3, [r0, #14]	@ movhi
 151:../Protocol/protocol.c ****     pfram->func_c = __SWP16(cmd);
 377              		.loc 1 151 5 is_stmt 1 view .LVU104
 378              		.loc 1 151 21 is_stmt 0 view .LVU105
 379 0024 3002     		lsls	r0, r6, #8
 380              	.LVL34:
 381              		.loc 1 151 21 view .LVU106
 382 0026 40EA1626 		orr	r6, r0, r6, lsr #8
 383              		.loc 1 151 19 view .LVU107
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 11


 384 002a A680     		strh	r6, [r4, #4]	@ movhi
 152:../Protocol/protocol.c ****     pfram->len = __SWP16(len);
 385              		.loc 1 152 5 is_stmt 1 view .LVU108
 386              		.loc 1 152 18 is_stmt 0 view .LVU109
 387 002c 2B02     		lsls	r3, r5, #8
 388 002e 43EA1523 		orr	r3, r3, r5, lsr #8
 389              		.loc 1 152 16 view .LVU110
 390 0032 E380     		strh	r3, [r4, #6]	@ movhi
 153:../Protocol/protocol.c ****     pfram->pdata = &puctemp[sizeof(pro_frame_t)];
 391              		.loc 1 153 5 is_stmt 1 view .LVU111
 392              		.loc 1 153 20 is_stmt 0 view .LVU112
 393 0034 04F11000 		add	r0, r4, #16
 394              		.loc 1 153 18 view .LVU113
 395 0038 A060     		str	r0, [r4, #8]
 154:../Protocol/protocol.c ****     if(pdata != 0)
 396              		.loc 1 154 5 is_stmt 1 view .LVU114
 397              		.loc 1 154 7 is_stmt 0 view .LVU115
 398 003a 1FB1     		cbz	r7, .L23
 155:../Protocol/protocol.c ****     {
 156:../Protocol/protocol.c ****         memcpy((unsigned char*)&puctemp[sizeof(pro_frame_t)],(unsigned char*)pdata,len);
 399              		.loc 1 156 9 is_stmt 1 view .LVU116
 400 003c 2A46     		mov	r2, r5
 401 003e 3946     		mov	r1, r7
 402 0040 FFF7FEFF 		bl	memcpy
 403              	.LVL35:
 404              	.L23:
 157:../Protocol/protocol.c ****     }    
 158:../Protocol/protocol.c ****     return pfram;
 159:../Protocol/protocol.c **** }
 405              		.loc 1 159 1 is_stmt 0 view .LVU117
 406 0044 2046     		mov	r0, r4
 407 0046 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 408              	.LVL36:
 409              	.L27:
 144:../Protocol/protocol.c ****         return NULL;
 410              		.loc 1 144 9 is_stmt 1 view .LVU118
 411 0048 FFF7FEFF 		bl	heap_free
 412              	.LVL37:
 145:../Protocol/protocol.c ****     }
 413              		.loc 1 145 9 view .LVU119
 145:../Protocol/protocol.c ****     }
 414              		.loc 1 145 16 is_stmt 0 view .LVU120
 415 004c FAE7     		b	.L23
 416              		.cfi_endproc
 417              	.LFE3:
 419              		.section	.rodata._unpack_proframe.str1.4,"aMS",%progbits,1
 420              		.align	2
 421              	.LC0:
 422 0000 43524331 		.ascii	"CRC16 Err 0x%2x\015\012\000"
 422      36204572 
 422      72203078 
 422      2532780D 
 422      0A00
 423              		.section	.text._unpack_proframe,"ax",%progbits
 424              		.align	1
 425              		.global	_unpack_proframe
 426              		.syntax unified
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 12


 427              		.thumb
 428              		.thumb_func
 429              		.fpu fpv4-sp-d16
 431              	_unpack_proframe:
 432              	.LVL38:
 433              	.LFB4:
 160:../Protocol/protocol.c **** /*-----------------------------解包协议帧-------------------------------------------------------
 161:../Protocol/protocol.c **** return 一段连续的内存
 162:../Protocol/protocol.c **** */
 163:../Protocol/protocol.c **** pro_frame_t* _unpack_proframe(unsigned char *pdata,unsigned short len)
 164:../Protocol/protocol.c **** {
 434              		.loc 1 164 1 is_stmt 1 view -0
 435              		.cfi_startproc
 436              		@ args = 0, pretend = 0, frame = 0
 437              		@ frame_needed = 0, uses_anonymous_args = 0
 438              		.loc 1 164 1 is_stmt 0 view .LVU122
 439 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 440              	.LCFI9:
 441              		.cfi_def_cfa_offset 24
 442              		.cfi_offset 3, -24
 443              		.cfi_offset 4, -20
 444              		.cfi_offset 5, -16
 445              		.cfi_offset 6, -12
 446              		.cfi_offset 7, -8
 447              		.cfi_offset 14, -4
 448 0002 0646     		mov	r6, r0
 449 0004 0D46     		mov	r5, r1
 165:../Protocol/protocol.c ****     /*申请内存*/
 166:../Protocol/protocol.c ****     unsigned char *pr_buf_1;
 450              		.loc 1 166 5 is_stmt 1 view .LVU123
 167:../Protocol/protocol.c ****     unsigned short r_fram_len;
 451              		.loc 1 167 5 view .LVU124
 168:../Protocol/protocol.c ****     unsigned short r_data_len;
 452              		.loc 1 168 5 view .LVU125
 169:../Protocol/protocol.c ****     unsigned short r_crc_16;
 453              		.loc 1 169 5 view .LVU126
 170:../Protocol/protocol.c ****     r_fram_len = len;
 454              		.loc 1 170 5 view .LVU127
 171:../Protocol/protocol.c ****     pr_buf_1 = heap_malloc(r_fram_len);
 455              		.loc 1 171 5 view .LVU128
 456              		.loc 1 171 16 is_stmt 0 view .LVU129
 457 0006 0846     		mov	r0, r1
 458              	.LVL39:
 459              		.loc 1 171 16 view .LVU130
 460 0008 FFF7FEFF 		bl	heap_malloc
 461              	.LVL40:
 462              		.loc 1 171 16 view .LVU131
 463 000c 0446     		mov	r4, r0
 464              	.LVL41:
 172:../Protocol/protocol.c ****     memcpy(pr_buf_1,pdata,r_fram_len);
 465              		.loc 1 172 5 is_stmt 1 view .LVU132
 466 000e 2A46     		mov	r2, r5
 467 0010 3146     		mov	r1, r6
 468 0012 FFF7FEFF 		bl	memcpy
 469              	.LVL42:
 173:../Protocol/protocol.c ****     r_crc_16 = CRC16_Subsection((unsigned char *)pr_buf_1,0xFFFF,r_fram_len-4);
 470              		.loc 1 173 5 view .LVU133
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 13


 471              		.loc 1 173 16 is_stmt 0 view .LVU134
 472 0016 2A1F     		subs	r2, r5, #4
 473 0018 4FF6FF71 		movw	r1, #65535
 474 001c 2046     		mov	r0, r4
 475 001e FFF7FEFF 		bl	CRC16_Subsection
 476              	.LVL43:
 477 0022 0246     		mov	r2, r0
 478              	.LVL44:
 174:../Protocol/protocol.c ****     if(r_crc_16 != (pr_buf_1[r_fram_len-4]<<8 | pr_buf_1[r_fram_len-3]))
 479              		.loc 1 174 5 is_stmt 1 view .LVU135
 480              		.loc 1 174 29 is_stmt 0 view .LVU136
 481 0024 6119     		adds	r1, r4, r5
 482 0026 11F8040C 		ldrb	r0, [r1, #-4]	@ zero_extendqisi2
 483              		.loc 1 174 57 view .LVU137
 484 002a 11F8033C 		ldrb	r3, [r1, #-3]	@ zero_extendqisi2
 485              		.loc 1 174 47 view .LVU138
 486 002e 43EA0023 		orr	r3, r3, r0, lsl #8
 487              		.loc 1 174 7 view .LVU139
 488 0032 9A42     		cmp	r2, r3
 489 0034 2CD1     		bne	.L33
 175:../Protocol/protocol.c ****     {
 176:../Protocol/protocol.c ****         USER_DEBUG_NORMAL("CRC16 Err 0x%2x\r\n",r_crc_16);
 177:../Protocol/protocol.c ****         heap_free(pr_buf_1);
 178:../Protocol/protocol.c ****         return NULL;
 179:../Protocol/protocol.c ****     }
 180:../Protocol/protocol.c ****     /*校验成功*/
 181:../Protocol/protocol.c ****     r_data_len =  pr_buf_1[4]<<8 | pr_buf_1[5];   //获取数据长度
 490              		.loc 1 181 5 is_stmt 1 view .LVU140
 491              		.loc 1 181 27 is_stmt 0 view .LVU141
 492 0036 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
 493              		.loc 1 181 44 view .LVU142
 494 0038 6779     		ldrb	r7, [r4, #5]	@ zero_extendqisi2
 495              		.loc 1 181 16 view .LVU143
 496 003a 47EA0327 		orr	r7, r7, r3, lsl #8
 497              	.LVL45:
 182:../Protocol/protocol.c ****     unsigned char *pr_buf_2;
 498              		.loc 1 182 5 is_stmt 1 view .LVU144
 183:../Protocol/protocol.c ****     pr_buf_2 = 0;
 499              		.loc 1 183 5 view .LVU145
 184:../Protocol/protocol.c ****     pr_buf_2 = heap_malloc(sizeof(pro_frame_t)+r_data_len);//申请数据帧内存
 500              		.loc 1 184 5 view .LVU146
 501              		.loc 1 184 16 is_stmt 0 view .LVU147
 502 003e 07F11000 		add	r0, r7, #16
 503 0042 FFF7FEFF 		bl	heap_malloc
 504              	.LVL46:
 505              		.loc 1 184 16 view .LVU148
 506 0046 0646     		mov	r6, r0
 507              	.LVL47:
 185:../Protocol/protocol.c ****     memcpy(&pr_buf_2[2],pr_buf_1,r_fram_len);
 508              		.loc 1 185 5 is_stmt 1 view .LVU149
 509 0048 2A46     		mov	r2, r5
 510 004a 2146     		mov	r1, r4
 511 004c 0230     		adds	r0, r0, #2
 512              	.LVL48:
 513              		.loc 1 185 5 is_stmt 0 view .LVU150
 514 004e FFF7FEFF 		bl	memcpy
 515              	.LVL49:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 14


 186:../Protocol/protocol.c ****     heap_free(pr_buf_1);
 516              		.loc 1 186 5 is_stmt 1 view .LVU151
 517 0052 2046     		mov	r0, r4
 518 0054 FFF7FEFF 		bl	heap_free
 519              	.LVL50:
 187:../Protocol/protocol.c **** 
 188:../Protocol/protocol.c ****     unsigned char *pr_buf_data;
 520              		.loc 1 188 5 view .LVU152
 189:../Protocol/protocol.c ****     pr_buf_data = heap_malloc(r_data_len);
 521              		.loc 1 189 5 view .LVU153
 522              		.loc 1 189 19 is_stmt 0 view .LVU154
 523 0058 3846     		mov	r0, r7
 524 005a FFF7FEFF 		bl	heap_malloc
 525              	.LVL51:
 190:../Protocol/protocol.c ****     if (pr_buf_data==NULL && r_data_len!=0)
 526              		.loc 1 190 5 is_stmt 1 view .LVU155
 527              		.loc 1 190 8 is_stmt 0 view .LVU156
 528 005e 0546     		mov	r5, r0
 529 0060 F8B1     		cbz	r0, .L34
 530              	.L31:
 191:../Protocol/protocol.c ****     {
 192:../Protocol/protocol.c ****         heap_free(pr_buf_2);
 193:../Protocol/protocol.c ****         heap_free(pr_buf_data);
 194:../Protocol/protocol.c ****         return NULL;
 195:../Protocol/protocol.c ****     }
 196:../Protocol/protocol.c ****     memcpy(pr_buf_data,&pr_buf_2[FRAM_PDATA_OFFSET],r_data_len);   
 531              		.loc 1 196 5 is_stmt 1 view .LVU157
 532 0062 3A46     		mov	r2, r7
 533 0064 06F10801 		add	r1, r6, #8
 534 0068 2846     		mov	r0, r5
 535              	.LVL52:
 536              		.loc 1 196 5 is_stmt 0 view .LVU158
 537 006a FFF7FEFF 		bl	memcpy
 538              	.LVL53:
 197:../Protocol/protocol.c ****     memcpy(&pr_buf_2[FRAM_CRC_OFFSET],&pr_buf_2[FRAM_PDATA_OFFSET+r_data_len],4);
 539              		.loc 1 197 5 is_stmt 1 view .LVU159
 540              		.loc 1 197 66 is_stmt 0 view .LVU160
 541 006e 07F10803 		add	r3, r7, #8
 542 0072 F358     		ldr	r3, [r6, r3]	@ unaligned
 543              		.loc 1 197 5 view .LVU161
 544 0074 F360     		str	r3, [r6, #12]	@ unaligned
 198:../Protocol/protocol.c ****     memcpy(&pr_buf_2[FRAM_BUF_OFFSET],pr_buf_data,r_data_len);    
 545              		.loc 1 198 5 is_stmt 1 view .LVU162
 546              		.loc 1 198 12 is_stmt 0 view .LVU163
 547 0076 06F11004 		add	r4, r6, #16
 548              	.LVL54:
 549              		.loc 1 198 5 view .LVU164
 550 007a 3A46     		mov	r2, r7
 551 007c 2946     		mov	r1, r5
 552 007e 2046     		mov	r0, r4
 553 0080 FFF7FEFF 		bl	memcpy
 554              	.LVL55:
 199:../Protocol/protocol.c ****     heap_free(pr_buf_data);
 555              		.loc 1 199 5 is_stmt 1 view .LVU165
 556 0084 2846     		mov	r0, r5
 557 0086 FFF7FEFF 		bl	heap_free
 558              	.LVL56:
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 15


 200:../Protocol/protocol.c **** 
 201:../Protocol/protocol.c ****     pro_frame_t *p_r_fram;
 559              		.loc 1 201 5 view .LVU166
 202:../Protocol/protocol.c ****     p_r_fram = (pro_frame_t *)pr_buf_2;
 560              		.loc 1 202 5 view .LVU167
 203:../Protocol/protocol.c ****     p_r_fram->pdata = &pr_buf_2[FRAM_BUF_OFFSET];
 561              		.loc 1 203 5 view .LVU168
 562              		.loc 1 203 21 is_stmt 0 view .LVU169
 563 008a B460     		str	r4, [r6, #8]
 204:../Protocol/protocol.c **** 
 205:../Protocol/protocol.c ****     return p_r_fram;
 564              		.loc 1 205 5 is_stmt 1 view .LVU170
 565              	.LVL57:
 566              	.L28:
 206:../Protocol/protocol.c **** }
 567              		.loc 1 206 1 is_stmt 0 view .LVU171
 568 008c 3046     		mov	r0, r6
 569 008e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 570              	.LVL58:
 571              	.L33:
 176:../Protocol/protocol.c ****         heap_free(pr_buf_1);
 572              		.loc 1 176 9 is_stmt 1 view .LVU172
 573 0090 0949     		ldr	r1, .L35
 574 0092 0020     		movs	r0, #0
 575 0094 FFF7FEFF 		bl	SEGGER_RTT_printf
 576              	.LVL59:
 177:../Protocol/protocol.c ****         return NULL;
 577              		.loc 1 177 9 view .LVU173
 578 0098 2046     		mov	r0, r4
 579 009a FFF7FEFF 		bl	heap_free
 580              	.LVL60:
 178:../Protocol/protocol.c ****     }
 581              		.loc 1 178 9 view .LVU174
 178:../Protocol/protocol.c ****     }
 582              		.loc 1 178 16 is_stmt 0 view .LVU175
 583 009e 0026     		movs	r6, #0
 584              	.LVL61:
 178:../Protocol/protocol.c ****     }
 585              		.loc 1 178 16 view .LVU176
 586 00a0 F4E7     		b	.L28
 587              	.LVL62:
 588              	.L34:
 190:../Protocol/protocol.c ****     {
 589              		.loc 1 190 27 discriminator 1 view .LVU177
 590 00a2 002F     		cmp	r7, #0
 591 00a4 DDD0     		beq	.L31
 192:../Protocol/protocol.c ****         heap_free(pr_buf_data);
 592              		.loc 1 192 9 is_stmt 1 view .LVU178
 593 00a6 3046     		mov	r0, r6
 594              	.LVL63:
 192:../Protocol/protocol.c ****         heap_free(pr_buf_data);
 595              		.loc 1 192 9 is_stmt 0 view .LVU179
 596 00a8 FFF7FEFF 		bl	heap_free
 597              	.LVL64:
 193:../Protocol/protocol.c ****         return NULL;
 598              		.loc 1 193 9 is_stmt 1 view .LVU180
 599 00ac 2846     		mov	r0, r5
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 16


 600 00ae FFF7FEFF 		bl	heap_free
 601              	.LVL65:
 194:../Protocol/protocol.c ****     }
 602              		.loc 1 194 9 view .LVU181
 194:../Protocol/protocol.c ****     }
 603              		.loc 1 194 16 is_stmt 0 view .LVU182
 604 00b2 2E46     		mov	r6, r5
 605              	.LVL66:
 194:../Protocol/protocol.c ****     }
 606              		.loc 1 194 16 view .LVU183
 607 00b4 EAE7     		b	.L28
 608              	.L36:
 609 00b6 00BF     		.align	2
 610              	.L35:
 611 00b8 00000000 		.word	.LC0
 612              		.cfi_endproc
 613              	.LFE4:
 615              		.section	.text.protocol_init,"ax",%progbits
 616              		.align	1
 617              		.global	protocol_init
 618              		.syntax unified
 619              		.thumb
 620              		.thumb_func
 621              		.fpu fpv4-sp-d16
 623              	protocol_init:
 624              	.LFB5:
 207:../Protocol/protocol.c **** 
 208:../Protocol/protocol.c **** void protocol_init(void)
 209:../Protocol/protocol.c **** {
 625              		.loc 1 209 1 is_stmt 1 view -0
 626              		.cfi_startproc
 627              		@ args = 0, pretend = 0, frame = 0
 628              		@ frame_needed = 0, uses_anonymous_args = 0
 629 0000 08B5     		push	{r3, lr}
 630              	.LCFI10:
 631              		.cfi_def_cfa_offset 8
 632              		.cfi_offset 3, -8
 633              		.cfi_offset 14, -4
 210:../Protocol/protocol.c ****     bytefifo_init(&protocol_fifo_handle,fifo_receive_buff,sizeof(fifo_receive_buff));
 634              		.loc 1 210 5 view .LVU185
 635 0002 4FF48062 		mov	r2, #1024
 636 0006 0449     		ldr	r1, .L39
 637 0008 0448     		ldr	r0, .L39+4
 638 000a FFF7FEFF 		bl	bytefifo_init
 639              	.LVL67:
 211:../Protocol/protocol.c ****     /*创建一个消息发送链表*/
 212:../Protocol/protocol.c ****     gtransmit_list = list_creat();
 640              		.loc 1 212 5 view .LVU186
 641              		.loc 1 212 22 is_stmt 0 view .LVU187
 642 000e FFF7FEFF 		bl	list_creat
 643              	.LVL68:
 644              		.loc 1 212 20 view .LVU188
 645 0012 034B     		ldr	r3, .L39+8
 646 0014 1860     		str	r0, [r3]
 213:../Protocol/protocol.c **** }
 647              		.loc 1 213 1 view .LVU189
 648 0016 08BD     		pop	{r3, pc}
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 17


 649              	.L40:
 650              		.align	2
 651              	.L39:
 652 0018 00000000 		.word	.LANCHOR1
 653 001c 00000000 		.word	.LANCHOR0
 654 0020 00000000 		.word	.LANCHOR2
 655              		.cfi_endproc
 656              	.LFE5:
 658              		.section	.text.protocol_process,"ax",%progbits
 659              		.align	1
 660              		.global	protocol_process
 661              		.syntax unified
 662              		.thumb
 663              		.thumb_func
 664              		.fpu fpv4-sp-d16
 666              	protocol_process:
 667              	.LFB6:
 214:../Protocol/protocol.c **** 
 215:../Protocol/protocol.c **** /*
 216:../Protocol/protocol.c **** process:线程
 217:../Protocol/protocol.c **** parse:解析
 218:../Protocol/protocol.c **** */
 219:../Protocol/protocol.c **** void protocol_process(void)
 220:../Protocol/protocol.c **** {
 668              		.loc 1 220 1 is_stmt 1 view -0
 669              		.cfi_startproc
 670              		@ args = 0, pretend = 0, frame = 0
 671              		@ frame_needed = 0, uses_anonymous_args = 0
 672 0000 08B5     		push	{r3, lr}
 673              	.LCFI11:
 674              		.cfi_def_cfa_offset 8
 675              		.cfi_offset 3, -8
 676              		.cfi_offset 14, -4
 221:../Protocol/protocol.c ****     protocol_parse();
 677              		.loc 1 221 5 view .LVU191
 678 0002 FFF7FEFF 		bl	protocol_parse
 679              	.LVL69:
 222:../Protocol/protocol.c ****     protocol_transmitprocess();
 680              		.loc 1 222 5 view .LVU192
 681 0006 FFF7FEFF 		bl	protocol_transmitprocess
 682              	.LVL70:
 223:../Protocol/protocol.c **** }
 683              		.loc 1 223 1 is_stmt 0 view .LVU193
 684 000a 08BD     		pop	{r3, pc}
 685              		.cfi_endproc
 686              	.LFE6:
 688              		.global	g_protocol_event
 689              		.global	gtransmit_list
 690              		.section	.bss.fifo_receive_buff,"aw",%nobits
 691              		.align	2
 692              		.set	.LANCHOR1,. + 0
 695              	fifo_receive_buff:
 696 0000 00000000 		.space	1024
 696      00000000 
 696      00000000 
 696      00000000 
 696      00000000 
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 18


 697              		.section	.bss.g_protocol_event,"aw",%nobits
 698              		.align	1
 701              	g_protocol_event:
 702 0000 0000     		.space	2
 703              		.section	.bss.gtransmit_list,"aw",%nobits
 704              		.align	2
 705              		.set	.LANCHOR2,. + 0
 708              	gtransmit_list:
 709 0000 00000000 		.space	4
 710              		.section	.bss.protocol_fifo_handle,"aw",%nobits
 711              		.align	2
 712              		.set	.LANCHOR0,. + 0
 715              	protocol_fifo_handle:
 716 0000 00000000 		.space	16
 716      00000000 
 716      00000000 
 716      00000000 
 717              		.text
 718              	.Letext0:
 719              		.file 2 "../Common/data_structures/fifo.h"
 720              		.file 3 "../Common/data_structures/list.h"
 721              		.file 4 "../Common/Fsm/fsm.h"
 722              		.file 5 "../Protocol/protocol_comment.h"
 723              		.file 6 "../Protocol/protocol.h"
 724              		.file 7 "../Common/data_structures/heap.h"
 725              		.file 8 "../Common/method/crc.h"
 726              		.file 9 "../Common/debuglog/SEGGER_RTT_V792h/RTT/SEGGER_RTT.h"
 727              		.file 10 "<built-in>"
ARM GAS  C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s 			page 19


DEFINED SYMBOLS
                            *ABS*:00000000 protocol.c
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:18     .text.protocol_reciverdata_tofifo:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:26     .text.protocol_reciverdata_tofifo:00000000 protocol_reciverdata_tofifo
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:57     .text.protocol_reciverdata_tofifo:00000010 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:62     .text._get_framedata_fromfifo:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:69     .text._get_framedata_fromfifo:00000000 _get_framedata_fromfifo
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:237    .text._get_framedata_fromfifo:00000098 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:242    .text._packet_propack:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:249    .text._packet_propack:00000000 _packet_propack
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:318    .text._packet_propack:00000034 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:323    .text._packet_proframe:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:330    .text._packet_proframe:00000000 _packet_proframe
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:420    .rodata._unpack_proframe.str1.4:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:424    .text._unpack_proframe:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:431    .text._unpack_proframe:00000000 _unpack_proframe
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:611    .text._unpack_proframe:000000b8 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:616    .text.protocol_init:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:623    .text.protocol_init:00000000 protocol_init
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:652    .text.protocol_init:00000018 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:659    .text.protocol_process:00000000 $t
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:666    .text.protocol_process:00000000 protocol_process
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:701    .bss.g_protocol_event:00000000 g_protocol_event
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:708    .bss.gtransmit_list:00000000 gtransmit_list
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:691    .bss.fifo_receive_buff:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:695    .bss.fifo_receive_buff:00000000 fifo_receive_buff
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:698    .bss.g_protocol_event:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:704    .bss.gtransmit_list:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:711    .bss.protocol_fifo_handle:00000000 $d
C:\Users\ADMINI~1\AppData\Local\Temp\ccGrVOn2.s:715    .bss.protocol_fifo_handle:00000000 protocol_fifo_handle

UNDEFINED SYMBOLS
bytefifo_writemulitebyge
bytefifo_readmulintebyte
heap_malloc
fsm_init
_trancemit_statemach
memcpy
heap_free
CRC16_Subsection
SEGGER_RTT_printf
bytefifo_init
list_creat
protocol_parse
protocol_transmitprocess
