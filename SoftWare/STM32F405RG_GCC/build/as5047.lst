ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"as5047.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.ams_parity,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	ams_parity:
  26              	.LVL0:
  27              	.LFB244:
  28              		.file 1 "./Hardware/as5047.c"
   1:./Hardware/as5047.c **** #include "as5047.h"
   2:./Hardware/as5047.c **** #include "spi.h"
   3:./Hardware/as5047.c **** #include "gpio.h"
   4:./Hardware/as5047.c **** 
   5:./Hardware/as5047.c **** 
   6:./Hardware/as5047.c **** #include "stdbool.h"
   7:./Hardware/as5047.c **** #include "math.h"
   8:./Hardware/as5047.c **** typedef struct as5047_data
   9:./Hardware/as5047.c **** {
  10:./Hardware/as5047.c ****     int32_t *raw_buf;
  11:./Hardware/as5047.c ****     int32_t *covdata_buf;
  12:./Hardware/as5047.c ****     int32_t *filterdata_buf;
  13:./Hardware/as5047.c ****     int16_t buf_column;
  14:./Hardware/as5047.c **** }as5047_data_t;
  15:./Hardware/as5047.c **** static as5047_data_t sg_as5047data = {0};
  16:./Hardware/as5047.c **** int32_t rawdata,covdata,filterdata;
  17:./Hardware/as5047.c **** static int16_t column;
  18:./Hardware/as5047.c **** // typedef enum
  19:./Hardware/as5047.c **** // {
  20:./Hardware/as5047.c **** // 	MODE_INCREMENTAL = 0,
  21:./Hardware/as5047.c **** // 	MODE_SPI_AS5047P,
  22:./Hardware/as5047.c **** // 	MODE_SPI_MT6701,
  23:./Hardware/as5047.c **** // 	MODE_SPI_MA730,
  24:./Hardware/as5047.c **** // 	MODE_SPI_TLE5012B,
  25:./Hardware/as5047.c **** // } ENCODER_enum;
  26:./Hardware/as5047.c **** 
  27:./Hardware/as5047.c **** typedef struct 
  28:./Hardware/as5047.c **** {
  29:./Hardware/as5047.c **** 	// ENCODER_enum  mode;
  30:./Hardware/as5047.c **** 	// float  calib_range;        // Accuracy required to pass encoder cpr check
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 2


  31:./Hardware/as5047.c **** 	// float  calib_scan_distance;// rad electrical
  32:./Hardware/as5047.c **** 	// float  calib_scan_omega;   // rad/s electrical
  33:./Hardware/as5047.c **** 	float  bandwidth;          //ç¼–ç å™¨å¸¦å®½ï¼Œå’Œcpræˆæ­£æ¯”
  34:./Hardware/as5047.c **** 	int32_t  phase_offset;     //ç¼–ç å™¨å’Œè½¬å­ç”µè§’åº¦ä¹‹é—´çš„ç›¸ä½å·®ï¼Œrun_offset_calibratio
  35:./Hardware/as5047.c **** 	float  phase_offset_float; //ç¼–ç å™¨å’Œè½¬å­ç”µè§’åº¦ä¹‹é—´çš„ç›¸ä½å·®æµ®ç‚¹éƒ¨åˆ†ï¼Œrun_offse
  36:./Hardware/as5047.c **** 	int32_t  cpr;              //æ¯åœˆç¼–ç å™¨çš„è„‰å†²æ•°
  37:./Hardware/as5047.c **** 	// float  index_offset;
  38:./Hardware/as5047.c **** 	// bool  use_index;           //æ˜¯å¦ä½¿ç”¨ç¼–ç å™¨ç´¢å¼•ä¿¡å·
  39:./Hardware/as5047.c **** 	// bool  pre_calibrated;      // If true, this means the offset stored in
  40:./Hardware/as5047.c **** 	                           // configuration is valid and does not need
  41:./Hardware/as5047.c ****                              // be determined by run_offset_calibration.
  42:./Hardware/as5047.c ****                              // In this case the encoder will enter ready
  43:./Hardware/as5047.c ****                              // state as soon as the index is found.
  44:./Hardware/as5047.c **** 	int32_t  direction;        //ç”µæœºè½¬åŠ¨æ–¹å‘ï¼Œrun_offset_calibration()æ ¡å‡†è¿™ä¸ªå‚æ•°
  45:./Hardware/as5047.c **** 	// bool  use_index_offset;
  46:./Hardware/as5047.c **** 	bool  enable_phase_interpolation; // Use velocity to interpolate inside the count state
  47:./Hardware/as5047.c **** 	// bool find_idx_on_lockin_only;     // Only be sensitive during lockin scan constant vel state
  48:./Hardware/as5047.c **** 	float phase_;              //æœ€ç»ˆç”¨äºè®¡ç®—çš„å½“å‰ç”µè§’åº¦ï¼ŒèŒƒå›´-Pi~Piã€‚
  49:./Hardware/as5047.c **** 	float phase_vel_;          //æœ€ç»ˆç”¨äºè®¡ç®—çš„å½“å‰ç”µè§’é€Ÿåº¦ï¼Œå•ä½rad/sã€‚
  50:./Hardware/as5047.c **** } ENCODER_CONFIG;
  51:./Hardware/as5047.c **** 
  52:./Hardware/as5047.c **** #define TIM_1_8_CLOCK_HZ 168000000
  53:./Hardware/as5047.c **** #define TIM_1_8_PERIOD_CLOCKS 3500
  54:./Hardware/as5047.c **** #define TIM_1_8_DEADTIME_CLOCKS 100  //100=595ns
  55:./Hardware/as5047.c **** #define TIM_APB1_CLOCK_HZ 84000000
  56:./Hardware/as5047.c **** #define TIM_APB1_PERIOD_CLOCKS 4096
  57:./Hardware/as5047.c **** #define TIM_APB1_DEADTIME_CLOCKS 50  //50=595ns
  58:./Hardware/as5047.c **** #define TIM_1_8_RCR 2
  59:./Hardware/as5047.c **** #define  ENCODER_mode        MODE_SPI_AS5047P    //ç¼–ç å™¨ç±»å‹ï¼Œå…±å››ç§:MODE_INCREMENTAL,MOD
  60:./Hardware/as5047.c **** #define  ENCODER_cpr                   16384     //AS5047P=MT6701=16384,TLE5012B=32768, MODE_INCREM
  61:./Hardware/as5047.c **** #define  ENCODER_bandwidth             1000      //é»˜è®¤1000ï¼Œhallç”µæœºçš„cpræ¯”è¾ƒå°ï¼Œå¯è®¾ç
  62:./Hardware/as5047.c **** #define M_PI  3.14159265358979323846f
  63:./Hardware/as5047.c **** #define  MOTOR_pole_pairs                          1    //ç”µæœºæå¯¹æ•°
  64:./Hardware/as5047.c **** #define CURRENT_MEAS_PERIOD ( (float)2*TIM_1_8_PERIOD_CLOCKS*(TIM_1_8_RCR+1) / (float)TIM_1_8_CLOCK
  65:./Hardware/as5047.c **** //  const float current_meas_period = CURRENT_MEAS_PERIOD;
  66:./Hardware/as5047.c **** const float current_meas_period = 0.0001f;
  67:./Hardware/as5047.c **** ENCODER_CONFIG   encoder_config;
  68:./Hardware/as5047.c **** 
  69:./Hardware/as5047.c **** static float pll_kp_ = 0.0f;   // [count/s / count]
  70:./Hardware/as5047.c **** static float pll_ki_ = 0.0f;   // [(count/s^2) / count]
  71:./Hardware/as5047.c **** 
  72:./Hardware/as5047.c **** bool pos_estimate_valid_ = false;   //ä½ç½®ä¼°ç®—æ˜¯å¦å¯ç”¨
  73:./Hardware/as5047.c **** bool vel_estimate_valid_ = false;   //é€Ÿåº¦ä¼°ç®—æ˜¯å¦å¯ç”¨
  74:./Hardware/as5047.c **** 
  75:./Hardware/as5047.c **** float pos_estimate_ = 0.0f; //å½“å‰ä¼°ç®—çš„ä½ç½®å€¼ï¼Œå•ä½[turn]
  76:./Hardware/as5047.c **** float vel_estimate_ = 0.0f; //å½“å‰ä¼°ç®—è½¬é€Ÿï¼Œå•ä½[turn/s]
  77:./Hardware/as5047.c **** 
  78:./Hardware/as5047.c **** /*****************************************************************************/
  79:./Hardware/as5047.c **** /*****************************************************************************/
  80:./Hardware/as5047.c **** static inline float wrap_pm(float x, float y) {
  81:./Hardware/as5047.c **** #ifdef FPU_FPV4
  82:./Hardware/as5047.c **** 	float intval = (float)round(x / y);  //round_int
  83:./Hardware/as5047.c **** #else
  84:./Hardware/as5047.c **** 	float intval = nearbyintf(x / y);
  85:./Hardware/as5047.c **** #endif
  86:./Hardware/as5047.c **** 	return x - intval * y;
  87:./Hardware/as5047.c **** }
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 3


  88:./Hardware/as5047.c **** static inline float fmodf_pos(float x, float y) {
  89:./Hardware/as5047.c **** 	float res = wrap_pm(x, y);
  90:./Hardware/as5047.c **** 	if (res < 0) res += y;
  91:./Hardware/as5047.c **** 	return res;
  92:./Hardware/as5047.c **** }
  93:./Hardware/as5047.c **** 
  94:./Hardware/as5047.c **** static inline float wrap_pm_pi(float x) {
  95:./Hardware/as5047.c **** 	return wrap_pm(x, 2 * M_PI);
  96:./Hardware/as5047.c **** }
  97:./Hardware/as5047.c **** 
  98:./Hardware/as5047.c **** // Modulo (as opposed to remainder), per https://stackoverflow.com/a/19288271
  99:./Hardware/as5047.c **** static inline int mod(const int dividend, const int divisor)
 100:./Hardware/as5047.c **** {
 101:./Hardware/as5047.c **** 	int r = dividend % divisor;
 102:./Hardware/as5047.c **** 	if (r < 0) r += divisor;
 103:./Hardware/as5047.c **** 	return r;
 104:./Hardware/as5047.c **** }
 105:./Hardware/as5047.c **** 
 106:./Hardware/as5047.c **** 
 107:./Hardware/as5047.c **** void encoder_set_error(uint32_t error) 
 108:./Hardware/as5047.c **** {
 109:./Hardware/as5047.c **** 	vel_estimate_valid_ = false;
 110:./Hardware/as5047.c **** 	pos_estimate_valid_ = false;
 111:./Hardware/as5047.c **** 	// set_error(error);
 112:./Hardware/as5047.c **** }
 113:./Hardware/as5047.c **** /*****************************************************************************/
 114:./Hardware/as5047.c **** void update_pll_gains(void)
 115:./Hardware/as5047.c **** {
 116:./Hardware/as5047.c **** 	pll_kp_ = 2.0f * encoder_config.bandwidth;  // basic conversion to discrete time
 117:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 118:./Hardware/as5047.c **** 	// Check that we don't get problems with discrete time approximation
 119:./Hardware/as5047.c **** 	// if (!(current_meas_period * pll_kp_ < 1.0f))
 120:./Hardware/as5047.c **** 		// encoder_set_error(ERROR_UNSTABLE_GAIN);
 121:./Hardware/as5047.c **** }
 122:./Hardware/as5047.c **** /*****************************************************************************/
 123:./Hardware/as5047.c **** 
 124:./Hardware/as5047.c **** /*****************************************************************************/
 125:./Hardware/as5047.c **** /*****************************************************************************/
 126:./Hardware/as5047.c **** // @brief Turns the motor in one direction for a bit and then in the other
 127:./Hardware/as5047.c **** // direction in order to find the offset between the electrical phase 0
 128:./Hardware/as5047.c **** // and the encoder state 0.
 129:./Hardware/as5047.c **** bool run_offset_calibration(void)
 130:./Hardware/as5047.c **** {
 131:./Hardware/as5047.c **** 	uint32_t  i;
 132:./Hardware/as5047.c **** 	const float start_lock_duration = 1.0f;	
 133:./Hardware/as5047.c **** 
 134:./Hardware/as5047.c **** 	return true;
 135:./Hardware/as5047.c **** }
 136:./Hardware/as5047.c **** //åˆå§‹åŒ–ä¸‰ç§SPIæ¥å£çš„ç¼–ç å™¨çš„å‚æ•°, åˆå§‹åŒ–I2Cæ¥å£æˆ–è€…SPIæ¥å£
 137:./Hardware/as5047.c **** void MagneticSensor_Init(void)
 138:./Hardware/as5047.c **** {
 139:./Hardware/as5047.c **** 	//è¯»å–flashå†…ä¿å­˜çš„å‚æ•°
 140:./Hardware/as5047.c **** 	// encoder_config.mode = ENCODER_mode;  //é€‰æ‹©ç¼–ç å™¨å‹å·ï¼Œå‚æ•°è®¾ç½®å®å®šä¹‰åœ¨MyProjec
 141:./Hardware/as5047.c **** 	// ENCODER_cpr = ENCODER_cpr;    //ç¼–ç å™¨cpr
 142:./Hardware/as5047.c **** 	encoder_config.bandwidth = ENCODER_bandwidth;   //ç¼–ç å™¨å¸¦å®½
 143:./Hardware/as5047.c **** 	// encoder_config.calib_range = 0.02f; // Accuracy required to pass encoder cpr check  2%è¯¯å·®
 144:./Hardware/as5047.c **** 	// encoder_config.calib_scan_distance = 16.0f * M_PI; // rad electrical    æ ¡å‡†çš„æ—¶å€™æ­£åè½
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 4


 145:./Hardware/as5047.c **** 	// encoder_config.calib_scan_omega = 4.0f * M_PI;     // rad/s electrical  è½¬é€Ÿ2ä¸ªæå¯¹æ•°/ç§’
 146:./Hardware/as5047.c **** 
 147:./Hardware/as5047.c **** 	encoder_config.phase_offset = 0;        // Offset between encoder count and rotor electrical phase
 148:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.0f; // Sub-count phase alignment offset
 149:./Hardware/as5047.c **** 	encoder_config.enable_phase_interpolation = true; // Use velocity to interpolate inside the count 
 150:./Hardware/as5047.c **** 
 151:./Hardware/as5047.c **** 	encoder_config.direction = 1;
 152:./Hardware/as5047.c **** 	encoder_config.phase_offset = 23406;
 153:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.56f;
 154:./Hardware/as5047.c **** 
 155:./Hardware/as5047.c **** 
 156:./Hardware/as5047.c **** 	pll_kp_ = 2.0f * ENCODER_bandwidth;  // basic conversion to discrete time
 157:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 158:./Hardware/as5047.c **** 
 159:./Hardware/as5047.c **** 	// update_pll_gains();    //é”ç›¸ç¯å‚æ•°æ•´å®š
 160:./Hardware/as5047.c **** 	// run_offset_calibration();
 161:./Hardware/as5047.c **** 
 162:./Hardware/as5047.c **** }
 163:./Hardware/as5047.c **** 
 164:./Hardware/as5047.c **** 
 165:./Hardware/as5047.c **** /****************************************************************************/
 166:./Hardware/as5047.c **** bool encoder_update(int32_t raw)
 167:./Hardware/as5047.c **** {
 168:./Hardware/as5047.c **** 	int32_t delta_enc = 0;
 169:./Hardware/as5047.c **** 	int32_t pos_abs_latched; //LATCH
 170:./Hardware/as5047.c **** 	static int32_t shadow_count_ = 0;   //ç¼–ç å™¨ç´¯è®¡è®¡æ•°ã€‚
 171:./Hardware/as5047.c ****     int32_t count_in_cpr_ = 0;   //ç¼–ç å™¨å½“å‰è®¡æ•°å€¼ã€‚
 172:./Hardware/as5047.c ****     float interpolation_ = 0.0f; //ç¼–ç å™¨å½“å‰æ’è¡¥å€¼ã€‚
 173:./Hardware/as5047.c **** 	static float pos_estimate_counts_ = 0.0f;  //å½“å‰ä¼°ç®—çš„ä½ç½®å€¼ï¼Œå•ä½[count]   
 174:./Hardware/as5047.c **** 	static float pos_cpr_counts_ = 0.0f;       //å½“å‰çº¦æŸåœ¨cprèŒƒå›´å†…çš„ä½ç½®å€¼ï¼Œå•ä½[coun
 175:./Hardware/as5047.c **** 	static float vel_estimate_counts_ = 0.0f;  //å½“å‰ä¼°ç®—è½¬é€Ÿï¼Œå•ä½[count/s]
 176:./Hardware/as5047.c **** 
 177:./Hardware/as5047.c **** 	pos_abs_latched = raw;
 178:./Hardware/as5047.c **** 
 179:./Hardware/as5047.c **** 	delta_enc = pos_abs_latched - count_in_cpr_; //LATCH
 180:./Hardware/as5047.c **** 	delta_enc = mod(delta_enc, encoder_config.cpr);
 181:./Hardware/as5047.c **** 	if(delta_enc > encoder_config.cpr/2)
 182:./Hardware/as5047.c **** 	{
 183:./Hardware/as5047.c ****         delta_enc -= encoder_config.cpr;
 184:./Hardware/as5047.c ****     }
 185:./Hardware/as5047.c ****     shadow_count_ += delta_enc;
 186:./Hardware/as5047.c ****     count_in_cpr_ = pos_abs_latched;
 187:./Hardware/as5047.c **** 	
 188:./Hardware/as5047.c **** 	// Memory for pos_circular
 189:./Hardware/as5047.c **** 	float pos_cpr_counts_last = pos_cpr_counts_;
 190:./Hardware/as5047.c **** 	
 191:./Hardware/as5047.c **** 	// run pll (for now pll is in units of encoder counts)
 192:./Hardware/as5047.c **** 	// Predict current pos
 193:./Hardware/as5047.c **** 	pos_estimate_counts_ += current_meas_period * vel_estimate_counts_;
 194:./Hardware/as5047.c **** 	pos_cpr_counts_      += current_meas_period * vel_estimate_counts_;
 195:./Hardware/as5047.c **** 	
 196:./Hardware/as5047.c **** 	// discrete phase detector
 197:./Hardware/as5047.c **** 	float delta_pos_counts = (float)(shadow_count_ - (int32_t)pos_estimate_counts_);
 198:./Hardware/as5047.c **** 	float delta_pos_cpr_counts = (float)(count_in_cpr_ - (int32_t)pos_cpr_counts_);
 199:./Hardware/as5047.c **** 	delta_pos_cpr_counts = wrap_pm(delta_pos_cpr_counts, (float)(ENCODER_cpr));
 200:./Hardware/as5047.c **** 	// pll feedback
 201:./Hardware/as5047.c **** 	pos_estimate_counts_ += current_meas_period * pll_kp_ * delta_pos_counts;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 5


 202:./Hardware/as5047.c **** 	pos_cpr_counts_ += current_meas_period * pll_kp_ * delta_pos_cpr_counts;
 203:./Hardware/as5047.c **** 	pos_cpr_counts_ = fmodf_pos(pos_cpr_counts_, (float)(ENCODER_cpr));
 204:./Hardware/as5047.c **** 	vel_estimate_counts_ += current_meas_period * pll_ki_ * delta_pos_cpr_counts;
 205:./Hardware/as5047.c **** 	uint8_t snap_to_zero_vel = false;
 206:./Hardware/as5047.c **** 	if (fabsf(vel_estimate_counts_) < 0.5f * current_meas_period * pll_ki_)
 207:./Hardware/as5047.c **** 	{
 208:./Hardware/as5047.c **** 		vel_estimate_counts_ = 0.0f;  //align delta-sigma on zero to prevent jitter
 209:./Hardware/as5047.c **** 		snap_to_zero_vel = true;
 210:./Hardware/as5047.c **** 	}
 211:./Hardware/as5047.c **** 	
 212:./Hardware/as5047.c **** 	// Outputs from Encoder for Controller
 213:./Hardware/as5047.c **** 	pos_estimate_ = pos_estimate_counts_ / (float)ENCODER_cpr;
 214:./Hardware/as5047.c **** 	vel_estimate_ = vel_estimate_counts_ / (float)ENCODER_cpr;
 215:./Hardware/as5047.c **** 
 216:./Hardware/as5047.c **** 	//// run encoder count interpolation
 217:./Hardware/as5047.c **** 	int32_t corrected_enc = count_in_cpr_ - encoder_config.phase_offset;
 218:./Hardware/as5047.c **** 	// if we are stopped, make sure we don't randomly drift
 219:./Hardware/as5047.c **** 	if(snap_to_zero_vel || !encoder_config.enable_phase_interpolation)
 220:./Hardware/as5047.c **** 	{
 221:./Hardware/as5047.c **** 		interpolation_ = 0.5f;
 222:./Hardware/as5047.c **** 		// reset interpolation if encoder edge comes
 223:./Hardware/as5047.c ****     // TODO: This isn't correct. At high velocities the first phase in this count may very well not
 224:./Hardware/as5047.c **** 	}
 225:./Hardware/as5047.c **** 	else if(delta_enc > 0){
 226:./Hardware/as5047.c **** 		interpolation_ = 0.0f;
 227:./Hardware/as5047.c **** 	}else if(delta_enc < 0){
 228:./Hardware/as5047.c **** 		interpolation_ = 1.0f;
 229:./Hardware/as5047.c **** 	}
 230:./Hardware/as5047.c **** 	else {
 231:./Hardware/as5047.c **** 		// Interpolate (predict) between encoder counts using vel_estimate,
 232:./Hardware/as5047.c **** 		interpolation_ += current_meas_period * vel_estimate_counts_;
 233:./Hardware/as5047.c **** 		// don't allow interpolation indicated position outside of [enc, enc+1)
 234:./Hardware/as5047.c **** 		if (interpolation_ > 1.0f) interpolation_ = 1.0f;
 235:./Hardware/as5047.c **** 		if (interpolation_ < 0.0f) interpolation_ = 0.0f;
 236:./Hardware/as5047.c **** 	}
 237:./Hardware/as5047.c **** 	float interpolated_enc = corrected_enc + interpolation_;
 238:./Hardware/as5047.c **** 	
 239:./Hardware/as5047.c **** 	//// compute electrical phase
 240:./Hardware/as5047.c **** 	//TODO avoid recomputing elec_rad_per_enc every time
 241:./Hardware/as5047.c **** 	float elec_rad_per_enc = MOTOR_pole_pairs  * 2 * M_PI * (1.0f / (float)(ENCODER_cpr));
 242:./Hardware/as5047.c **** 	float ph = elec_rad_per_enc * (interpolated_enc - encoder_config.phase_offset_float);
 243:./Hardware/as5047.c **** 
 244:./Hardware/as5047.c **** 	encoder_config.phase_ = wrap_pm_pi(ph) * encoder_config.direction;
 245:./Hardware/as5047.c **** 	encoder_config.phase_vel_ = (2*M_PI) * vel_estimate_ * MOTOR_pole_pairs  * encoder_config.directio
 246:./Hardware/as5047.c **** 
 247:./Hardware/as5047.c **** 	return 1;
 248:./Hardware/as5047.c **** }
 249:./Hardware/as5047.c **** /****************************************************************************/
 250:./Hardware/as5047.c **** //SPIå‘é€è¯»å–å‡½æ•°
 251:./Hardware/as5047.c **** static uint8_t ams_parity(uint16_t v)
 252:./Hardware/as5047.c **** {
  29              		.loc 1 252 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
 253:./Hardware/as5047.c **** 	v ^= v >> 8;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 6


  34              		.loc 1 253 2 view .LVU1
  35              		.loc 1 253 4 is_stmt 0 view .LVU2
  36 0000 80EA1020 		eor	r0, r0, r0, lsr #8
  37              	.LVL1:
 254:./Hardware/as5047.c **** 	v ^= v >> 4;
  38              		.loc 1 254 2 is_stmt 1 view .LVU3
  39              		.loc 1 254 4 is_stmt 0 view .LVU4
  40 0004 80EA1010 		eor	r0, r0, r0, lsr #4
  41              	.LVL2:
 255:./Hardware/as5047.c **** 	v ^= v >> 2;
  42              		.loc 1 255 2 is_stmt 1 view .LVU5
  43              		.loc 1 255 4 is_stmt 0 view .LVU6
  44 0008 80EA9000 		eor	r0, r0, r0, lsr #2
  45              	.LVL3:
 256:./Hardware/as5047.c **** 	v ^= v >> 1;
  46              		.loc 1 256 2 is_stmt 1 view .LVU7
  47              		.loc 1 256 4 is_stmt 0 view .LVU8
  48 000c 80EA5000 		eor	r0, r0, r0, lsr #1
  49              	.LVL4:
 257:./Hardware/as5047.c **** 	return v & 1;
  50              		.loc 1 257 2 is_stmt 1 view .LVU9
 258:./Hardware/as5047.c **** }
  51              		.loc 1 258 1 is_stmt 0 view .LVU10
  52 0010 00F00100 		and	r0, r0, #1
  53              	.LVL5:
  54              		.loc 1 258 1 view .LVU11
  55 0014 7047     		bx	lr
  56              		.cfi_endproc
  57              	.LFE244:
  59              		.section	.text.encoder_set_error,"ax",%progbits
  60              		.align	1
  61              		.global	encoder_set_error
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  66              	encoder_set_error:
  67              	.LVL6:
  68              	.LFB239:
 108:./Hardware/as5047.c **** 	vel_estimate_valid_ = false;
  69              		.loc 1 108 1 is_stmt 1 view -0
  70              		.cfi_startproc
  71              		@ args = 0, pretend = 0, frame = 0
  72              		@ frame_needed = 0, uses_anonymous_args = 0
  73              		@ link register save eliminated.
 109:./Hardware/as5047.c **** 	pos_estimate_valid_ = false;
  74              		.loc 1 109 2 view .LVU13
 109:./Hardware/as5047.c **** 	pos_estimate_valid_ = false;
  75              		.loc 1 109 22 is_stmt 0 view .LVU14
  76 0000 0023     		movs	r3, #0
  77 0002 024A     		ldr	r2, .L3
  78 0004 1370     		strb	r3, [r2]
 110:./Hardware/as5047.c **** 	// set_error(error);
  79              		.loc 1 110 2 is_stmt 1 view .LVU15
 110:./Hardware/as5047.c **** 	// set_error(error);
  80              		.loc 1 110 22 is_stmt 0 view .LVU16
  81 0006 024A     		ldr	r2, .L3+4
  82 0008 1370     		strb	r3, [r2]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 7


 112:./Hardware/as5047.c **** /*****************************************************************************/
  83              		.loc 1 112 1 view .LVU17
  84 000a 7047     		bx	lr
  85              	.L4:
  86              		.align	2
  87              	.L3:
  88 000c 00000000 		.word	.LANCHOR0
  89 0010 00000000 		.word	.LANCHOR1
  90              		.cfi_endproc
  91              	.LFE239:
  93              		.section	.text.update_pll_gains,"ax",%progbits
  94              		.align	1
  95              		.global	update_pll_gains
  96              		.syntax unified
  97              		.thumb
  98              		.thumb_func
 100              	update_pll_gains:
 101              	.LFB240:
 115:./Hardware/as5047.c **** 	pll_kp_ = 2.0f * encoder_config.bandwidth;  // basic conversion to discrete time
 102              		.loc 1 115 1 is_stmt 1 view -0
 103              		.cfi_startproc
 104              		@ args = 0, pretend = 0, frame = 0
 105              		@ frame_needed = 0, uses_anonymous_args = 0
 106              		@ link register save eliminated.
 116:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 107              		.loc 1 116 2 view .LVU19
 116:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 108              		.loc 1 116 33 is_stmt 0 view .LVU20
 109 0000 084B     		ldr	r3, .L6
 110 0002 D3ED007A 		vldr.32	s15, [r3]
 116:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 111              		.loc 1 116 17 view .LVU21
 112 0006 77EEA77A 		vadd.f32	s15, s15, s15
 116:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 113              		.loc 1 116 10 view .LVU22
 114 000a 074B     		ldr	r3, .L6+4
 115 000c C3ED007A 		vstr.32	s15, [r3]
 117:./Hardware/as5047.c **** 	// Check that we don't get problems with discrete time approximation
 116              		.loc 1 117 2 is_stmt 1 view .LVU23
 117:./Hardware/as5047.c **** 	// Check that we don't get problems with discrete time approximation
 117              		.loc 1 117 29 is_stmt 0 view .LVU24
 118 0010 67EEA77A 		vmul.f32	s15, s15, s15
 117:./Hardware/as5047.c **** 	// Check that we don't get problems with discrete time approximation
 119              		.loc 1 117 18 view .LVU25
 120 0014 B5EE007A 		vmov.f32	s14, #2.5e-1
 121 0018 67EE877A 		vmul.f32	s15, s15, s14
 117:./Hardware/as5047.c **** 	// Check that we don't get problems with discrete time approximation
 122              		.loc 1 117 10 view .LVU26
 123 001c 034B     		ldr	r3, .L6+8
 124 001e C3ED007A 		vstr.32	s15, [r3]
 121:./Hardware/as5047.c **** /*****************************************************************************/
 125              		.loc 1 121 1 view .LVU27
 126 0022 7047     		bx	lr
 127              	.L7:
 128              		.align	2
 129              	.L6:
 130 0024 00000000 		.word	.LANCHOR2
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 8


 131 0028 00000000 		.word	.LANCHOR3
 132 002c 00000000 		.word	.LANCHOR4
 133              		.cfi_endproc
 134              	.LFE240:
 136              		.section	.text.run_offset_calibration,"ax",%progbits
 137              		.align	1
 138              		.global	run_offset_calibration
 139              		.syntax unified
 140              		.thumb
 141              		.thumb_func
 143              	run_offset_calibration:
 144              	.LFB241:
 130:./Hardware/as5047.c **** 	uint32_t  i;
 145              		.loc 1 130 1 is_stmt 1 view -0
 146              		.cfi_startproc
 147              		@ args = 0, pretend = 0, frame = 0
 148              		@ frame_needed = 0, uses_anonymous_args = 0
 149              		@ link register save eliminated.
 131:./Hardware/as5047.c **** 	const float start_lock_duration = 1.0f;	
 150              		.loc 1 131 2 view .LVU29
 132:./Hardware/as5047.c **** 
 151              		.loc 1 132 2 view .LVU30
 152              	.LVL7:
 134:./Hardware/as5047.c **** }
 153              		.loc 1 134 2 view .LVU31
 135:./Hardware/as5047.c **** //åˆå§‹åŒ–ä¸‰ç§SPIæ¥å£çš„ç¼–ç å™¨çš„å‚æ•°, åˆå§‹åŒ–I2Cæ¥å£æˆ–è€…SPIæ¥å£
 154              		.loc 1 135 1 is_stmt 0 view .LVU32
 155 0000 0120     		movs	r0, #1
 156 0002 7047     		bx	lr
 157              		.cfi_endproc
 158              	.LFE241:
 160              		.section	.text.MagneticSensor_Init,"ax",%progbits
 161              		.align	1
 162              		.global	MagneticSensor_Init
 163              		.syntax unified
 164              		.thumb
 165              		.thumb_func
 167              	MagneticSensor_Init:
 168              	.LFB242:
 138:./Hardware/as5047.c **** 	//è¯»å–flashå†…ä¿å­˜çš„å‚æ•°
 169              		.loc 1 138 1 is_stmt 1 view -0
 170              		.cfi_startproc
 171              		@ args = 0, pretend = 0, frame = 0
 172              		@ frame_needed = 0, uses_anonymous_args = 0
 173              		@ link register save eliminated.
 142:./Hardware/as5047.c **** 	// encoder_config.calib_range = 0.02f; // Accuracy required to pass encoder cpr check  2%è¯¯å·®
 174              		.loc 1 142 2 view .LVU34
 142:./Hardware/as5047.c **** 	// encoder_config.calib_range = 0.02f; // Accuracy required to pass encoder cpr check  2%è¯¯å·®
 175              		.loc 1 142 27 is_stmt 0 view .LVU35
 176 0000 0A4B     		ldr	r3, .L10
 177 0002 0B4A     		ldr	r2, .L10+4
 178 0004 1A60     		str	r2, [r3]	@ float
 147:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.0f; // Sub-count phase alignment offset
 179              		.loc 1 147 2 is_stmt 1 view .LVU36
 147:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.0f; // Sub-count phase alignment offset
 180              		.loc 1 147 30 is_stmt 0 view .LVU37
 181 0006 0022     		movs	r2, #0
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 9


 182 0008 5A60     		str	r2, [r3, #4]
 148:./Hardware/as5047.c **** 	encoder_config.enable_phase_interpolation = true; // Use velocity to interpolate inside the count 
 183              		.loc 1 148 2 is_stmt 1 view .LVU38
 148:./Hardware/as5047.c **** 	encoder_config.enable_phase_interpolation = true; // Use velocity to interpolate inside the count 
 184              		.loc 1 148 36 is_stmt 0 view .LVU39
 185 000a 0022     		movs	r2, #0
 186 000c 9A60     		str	r2, [r3, #8]	@ float
 149:./Hardware/as5047.c **** 
 187              		.loc 1 149 2 is_stmt 1 view .LVU40
 149:./Hardware/as5047.c **** 
 188              		.loc 1 149 44 is_stmt 0 view .LVU41
 189 000e 0122     		movs	r2, #1
 190 0010 1A75     		strb	r2, [r3, #20]
 151:./Hardware/as5047.c **** 	encoder_config.phase_offset = 23406;
 191              		.loc 1 151 2 is_stmt 1 view .LVU42
 151:./Hardware/as5047.c **** 	encoder_config.phase_offset = 23406;
 192              		.loc 1 151 27 is_stmt 0 view .LVU43
 193 0012 1A61     		str	r2, [r3, #16]
 152:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.56f;
 194              		.loc 1 152 2 is_stmt 1 view .LVU44
 152:./Hardware/as5047.c **** 	encoder_config.phase_offset_float = 0.56f;
 195              		.loc 1 152 30 is_stmt 0 view .LVU45
 196 0014 45F66E32 		movw	r2, #23406
 197 0018 5A60     		str	r2, [r3, #4]
 153:./Hardware/as5047.c **** 
 198              		.loc 1 153 2 is_stmt 1 view .LVU46
 153:./Hardware/as5047.c **** 
 199              		.loc 1 153 36 is_stmt 0 view .LVU47
 200 001a 064A     		ldr	r2, .L10+8
 201 001c 9A60     		str	r2, [r3, #8]	@ float
 156:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 202              		.loc 1 156 2 is_stmt 1 view .LVU48
 156:./Hardware/as5047.c **** 	pll_ki_ = 0.25f * (pll_kp_ * pll_kp_); // Critically damped
 203              		.loc 1 156 10 is_stmt 0 view .LVU49
 204 001e 064B     		ldr	r3, .L10+12
 205 0020 064A     		ldr	r2, .L10+16
 206 0022 1A60     		str	r2, [r3]	@ float
 157:./Hardware/as5047.c **** 
 207              		.loc 1 157 2 is_stmt 1 view .LVU50
 157:./Hardware/as5047.c **** 
 208              		.loc 1 157 10 is_stmt 0 view .LVU51
 209 0024 064B     		ldr	r3, .L10+20
 210 0026 074A     		ldr	r2, .L10+24
 211 0028 1A60     		str	r2, [r3]	@ float
 162:./Hardware/as5047.c **** 
 212              		.loc 1 162 1 view .LVU52
 213 002a 7047     		bx	lr
 214              	.L11:
 215              		.align	2
 216              	.L10:
 217 002c 00000000 		.word	.LANCHOR2
 218 0030 00007A44 		.word	1148846080
 219 0034 295C0F3F 		.word	1057971241
 220 0038 00000000 		.word	.LANCHOR3
 221 003c 0000FA44 		.word	1157234688
 222 0040 00000000 		.word	.LANCHOR4
 223 0044 00247449 		.word	1232348160
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 10


 224              		.cfi_endproc
 225              	.LFE242:
 227              		.section	.text.encoder_update,"ax",%progbits
 228              		.align	1
 229              		.global	encoder_update
 230              		.syntax unified
 231              		.thumb
 232              		.thumb_func
 234              	encoder_update:
 235              	.LVL8:
 236              	.LFB243:
 167:./Hardware/as5047.c **** 	int32_t delta_enc = 0;
 237              		.loc 1 167 1 is_stmt 1 view -0
 238              		.cfi_startproc
 239              		@ args = 0, pretend = 0, frame = 0
 240              		@ frame_needed = 0, uses_anonymous_args = 0
 167:./Hardware/as5047.c **** 	int32_t delta_enc = 0;
 241              		.loc 1 167 1 is_stmt 0 view .LVU54
 242 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 243              	.LCFI0:
 244              		.cfi_def_cfa_offset 24
 245              		.cfi_offset 3, -24
 246              		.cfi_offset 4, -20
 247              		.cfi_offset 5, -16
 248              		.cfi_offset 6, -12
 249              		.cfi_offset 7, -8
 250              		.cfi_offset 14, -4
 251 0002 2DED0A8B 		vpush.64	{d8, d9, d10, d11, d12}
 252              	.LCFI1:
 253              		.cfi_def_cfa_offset 64
 254              		.cfi_offset 80, -64
 255              		.cfi_offset 81, -60
 256              		.cfi_offset 82, -56
 257              		.cfi_offset 83, -52
 258              		.cfi_offset 84, -48
 259              		.cfi_offset 85, -44
 260              		.cfi_offset 86, -40
 261              		.cfi_offset 87, -36
 262              		.cfi_offset 88, -32
 263              		.cfi_offset 89, -28
 264 0006 0446     		mov	r4, r0
 168:./Hardware/as5047.c **** 	int32_t pos_abs_latched; //LATCH
 265              		.loc 1 168 2 is_stmt 1 view .LVU55
 266              	.LVL9:
 169:./Hardware/as5047.c **** 	static int32_t shadow_count_ = 0;   //ç¼–ç å™¨ç´¯è®¡è®¡æ•°ã€‚
 267              		.loc 1 169 2 view .LVU56
 170:./Hardware/as5047.c ****     int32_t count_in_cpr_ = 0;   //ç¼–ç å™¨å½“å‰è®¡æ•°å€¼ã€‚
 268              		.loc 1 170 2 view .LVU57
 171:./Hardware/as5047.c ****     float interpolation_ = 0.0f; //ç¼–ç å™¨å½“å‰æ’è¡¥å€¼ã€‚
 269              		.loc 1 171 5 view .LVU58
 172:./Hardware/as5047.c **** 	static float pos_estimate_counts_ = 0.0f;  //å½“å‰ä¼°ç®—çš„ä½ç½®å€¼ï¼Œå•ä½[count]   
 270              		.loc 1 172 5 view .LVU59
 173:./Hardware/as5047.c **** 	static float pos_cpr_counts_ = 0.0f;       //å½“å‰çº¦æŸåœ¨cprèŒƒå›´å†…çš„ä½ç½®å€¼ï¼Œå•ä½[coun
 271              		.loc 1 173 2 view .LVU60
 174:./Hardware/as5047.c **** 	static float vel_estimate_counts_ = 0.0f;  //å½“å‰ä¼°ç®—è½¬é€Ÿï¼Œå•ä½[count/s]
 272              		.loc 1 174 2 view .LVU61
 175:./Hardware/as5047.c **** 
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 11


 273              		.loc 1 175 2 view .LVU62
 177:./Hardware/as5047.c **** 
 274              		.loc 1 177 2 view .LVU63
 179:./Hardware/as5047.c **** 	delta_enc = mod(delta_enc, encoder_config.cpr);
 275              		.loc 1 179 2 view .LVU64
 180:./Hardware/as5047.c **** 	if(delta_enc > encoder_config.cpr/2)
 276              		.loc 1 180 2 view .LVU65
 180:./Hardware/as5047.c **** 	if(delta_enc > encoder_config.cpr/2)
 277              		.loc 1 180 43 is_stmt 0 view .LVU66
 278 0008 784B     		ldr	r3, .L35
 279 000a DB68     		ldr	r3, [r3, #12]
 280              	.LVL10:
 281              	.LBB25:
 282              	.LBI25:
  99:./Hardware/as5047.c **** {
 283              		.loc 1 99 19 is_stmt 1 view .LVU67
 284              	.LBB26:
 101:./Hardware/as5047.c **** 	if (r < 0) r += divisor;
 285              		.loc 1 101 2 view .LVU68
 101:./Hardware/as5047.c **** 	if (r < 0) r += divisor;
 286              		.loc 1 101 6 is_stmt 0 view .LVU69
 287 000c 90FBF3F5 		sdiv	r5, r0, r3
 288 0010 03FB1505 		mls	r5, r3, r5, r0
 289              	.LVL11:
 102:./Hardware/as5047.c **** 	return r;
 290              		.loc 1 102 2 is_stmt 1 view .LVU70
 102:./Hardware/as5047.c **** 	return r;
 291              		.loc 1 102 5 is_stmt 0 view .LVU71
 292 0014 002D     		cmp	r5, #0
 293 0016 7ADB     		blt	.L32
 294              	.L13:
 103:./Hardware/as5047.c **** }
 295              		.loc 1 103 2 is_stmt 1 view .LVU72
 296              	.LVL12:
 103:./Hardware/as5047.c **** }
 297              		.loc 1 103 2 is_stmt 0 view .LVU73
 298              	.LBE26:
 299              	.LBE25:
 181:./Hardware/as5047.c **** 	{
 300              		.loc 1 181 2 is_stmt 1 view .LVU74
 181:./Hardware/as5047.c **** 	{
 301              		.loc 1 181 35 is_stmt 0 view .LVU75
 302 0018 03EBD372 		add	r2, r3, r3, lsr #31
 181:./Hardware/as5047.c **** 	{
 303              		.loc 1 181 4 view .LVU76
 304 001c B5EB620F 		cmp	r5, r2, asr #1
 305 0020 00DD     		ble	.L14
 183:./Hardware/as5047.c ****     }
 306              		.loc 1 183 9 is_stmt 1 view .LVU77
 183:./Hardware/as5047.c ****     }
 307              		.loc 1 183 19 is_stmt 0 view .LVU78
 308 0022 ED1A     		subs	r5, r5, r3
 309              	.LVL13:
 310              	.L14:
 185:./Hardware/as5047.c ****     count_in_cpr_ = pos_abs_latched;
 311              		.loc 1 185 5 is_stmt 1 view .LVU79
 185:./Hardware/as5047.c ****     count_in_cpr_ = pos_abs_latched;
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 12


 312              		.loc 1 185 19 is_stmt 0 view .LVU80
 313 0024 724A     		ldr	r2, .L35+4
 314 0026 1368     		ldr	r3, [r2]
 315 0028 2B44     		add	r3, r3, r5
 316 002a 1360     		str	r3, [r2]
 186:./Hardware/as5047.c **** 	
 317              		.loc 1 186 5 is_stmt 1 view .LVU81
 318              	.LVL14:
 189:./Hardware/as5047.c **** 	
 319              		.loc 1 189 2 view .LVU82
 189:./Hardware/as5047.c **** 	
 320              		.loc 1 189 8 is_stmt 0 view .LVU83
 321 002c 714E     		ldr	r6, .L35+8
 322 002e D6ED007A 		vldr.32	s15, [r6]
 323              	.LVL15:
 193:./Hardware/as5047.c **** 	pos_cpr_counts_      += current_meas_period * vel_estimate_counts_;
 324              		.loc 1 193 2 is_stmt 1 view .LVU84
 193:./Hardware/as5047.c **** 	pos_cpr_counts_      += current_meas_period * vel_estimate_counts_;
 325              		.loc 1 193 46 is_stmt 0 view .LVU85
 326 0032 714A     		ldr	r2, .L35+12
 327 0034 D2ED00AA 		vldr.32	s21, [r2]
 328 0038 9FED70CA 		vldr.32	s24, .L35+16
 329 003c 2AEE8C8A 		vmul.f32	s16, s21, s24
 193:./Hardware/as5047.c **** 	pos_cpr_counts_      += current_meas_period * vel_estimate_counts_;
 330              		.loc 1 193 23 view .LVU86
 331 0040 6F4F     		ldr	r7, .L35+20
 332 0042 D7ED008A 		vldr.32	s17, [r7]
 333 0046 78EE288A 		vadd.f32	s17, s16, s17
 334 004a C7ED008A 		vstr.32	s17, [r7]
 194:./Hardware/as5047.c **** 	
 335              		.loc 1 194 2 is_stmt 1 view .LVU87
 194:./Hardware/as5047.c **** 	
 336              		.loc 1 194 23 is_stmt 0 view .LVU88
 337 004e 38EE278A 		vadd.f32	s16, s16, s15
 338 0052 86ED008A 		vstr.32	s16, [r6]
 197:./Hardware/as5047.c **** 	float delta_pos_cpr_counts = (float)(count_in_cpr_ - (int32_t)pos_cpr_counts_);
 339              		.loc 1 197 2 is_stmt 1 view .LVU89
 197:./Hardware/as5047.c **** 	float delta_pos_cpr_counts = (float)(count_in_cpr_ - (int32_t)pos_cpr_counts_);
 340              		.loc 1 197 51 is_stmt 0 view .LVU90
 341 0056 BDEEE89A 		vcvt.s32.f32	s18, s17
 197:./Hardware/as5047.c **** 	float delta_pos_cpr_counts = (float)(count_in_cpr_ - (int32_t)pos_cpr_counts_);
 342              		.loc 1 197 49 view .LVU91
 343 005a 19EE102A 		vmov	r2, s18	@ int
 344 005e 9B1A     		subs	r3, r3, r2
 345 0060 09EE103A 		vmov	s18, r3	@ int
 197:./Hardware/as5047.c **** 	float delta_pos_cpr_counts = (float)(count_in_cpr_ - (int32_t)pos_cpr_counts_);
 346              		.loc 1 197 8 view .LVU92
 347 0064 B8EEC99A 		vcvt.f32.s32	s18, s18
 348              	.LVL16:
 198:./Hardware/as5047.c **** 	delta_pos_cpr_counts = wrap_pm(delta_pos_cpr_counts, (float)(ENCODER_cpr));
 349              		.loc 1 198 2 is_stmt 1 view .LVU93
 198:./Hardware/as5047.c **** 	delta_pos_cpr_counts = wrap_pm(delta_pos_cpr_counts, (float)(ENCODER_cpr));
 350              		.loc 1 198 55 is_stmt 0 view .LVU94
 351 0068 FDEEC89A 		vcvt.s32.f32	s19, s16
 198:./Hardware/as5047.c **** 	delta_pos_cpr_counts = wrap_pm(delta_pos_cpr_counts, (float)(ENCODER_cpr));
 352              		.loc 1 198 53 view .LVU95
 353 006c 19EE903A 		vmov	r3, s19	@ int
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 13


 354 0070 E31A     		subs	r3, r4, r3
 355 0072 09EE903A 		vmov	s19, r3	@ int
 198:./Hardware/as5047.c **** 	delta_pos_cpr_counts = wrap_pm(delta_pos_cpr_counts, (float)(ENCODER_cpr));
 356              		.loc 1 198 8 view .LVU96
 357 0076 B8EEE9AA 		vcvt.f32.s32	s20, s19
 358              	.LVL17:
 199:./Hardware/as5047.c **** 	// pll feedback
 359              		.loc 1 199 2 is_stmt 1 view .LVU97
 360              	.LBB28:
 361              	.LBI28:
  80:./Hardware/as5047.c **** #ifdef FPU_FPV4
 362              		.loc 1 80 21 view .LVU98
 363              	.LBB29:
  84:./Hardware/as5047.c **** #endif
 364              		.loc 1 84 2 view .LVU99
  84:./Hardware/as5047.c **** #endif
 365              		.loc 1 84 17 is_stmt 0 view .LVU100
 366 007a DFED62BA 		vldr.32	s23, .L35+24
 367 007e 2AEE2B0A 		vmul.f32	s0, s20, s23
 368 0082 FFF7FEFF 		bl	nearbyintf
 369              	.LVL18:
  86:./Hardware/as5047.c **** }
 370              		.loc 1 86 2 is_stmt 1 view .LVU101
  86:./Hardware/as5047.c **** }
 371              		.loc 1 86 20 is_stmt 0 view .LVU102
 372 0086 9FED60BA 		vldr.32	s22, .L35+28
 373 008a 60EE0B9A 		vmul.f32	s19, s0, s22
  86:./Hardware/as5047.c **** }
 374              		.loc 1 86 11 view .LVU103
 375 008e 7AEE699A 		vsub.f32	s19, s20, s19
 376              	.LVL19:
  86:./Hardware/as5047.c **** }
 377              		.loc 1 86 11 view .LVU104
 378              	.LBE29:
 379              	.LBE28:
 201:./Hardware/as5047.c **** 	pos_cpr_counts_ += current_meas_period * pll_kp_ * delta_pos_cpr_counts;
 380              		.loc 1 201 2 is_stmt 1 view .LVU105
 201:./Hardware/as5047.c **** 	pos_cpr_counts_ += current_meas_period * pll_kp_ * delta_pos_cpr_counts;
 381              		.loc 1 201 46 is_stmt 0 view .LVU106
 382 0092 5E4B     		ldr	r3, .L35+32
 383 0094 D3ED007A 		vldr.32	s15, [r3]
 384 0098 67EE8C7A 		vmul.f32	s15, s15, s24
 201:./Hardware/as5047.c **** 	pos_cpr_counts_ += current_meas_period * pll_kp_ * delta_pos_cpr_counts;
 385              		.loc 1 201 56 view .LVU107
 386 009c 27EE899A 		vmul.f32	s18, s15, s18
 387              	.LVL20:
 201:./Hardware/as5047.c **** 	pos_cpr_counts_ += current_meas_period * pll_kp_ * delta_pos_cpr_counts;
 388              		.loc 1 201 23 view .LVU108
 389 00a0 78EE898A 		vadd.f32	s17, s17, s18
 390 00a4 C7ED008A 		vstr.32	s17, [r7]
 202:./Hardware/as5047.c **** 	pos_cpr_counts_ = fmodf_pos(pos_cpr_counts_, (float)(ENCODER_cpr));
 391              		.loc 1 202 2 is_stmt 1 view .LVU109
 202:./Hardware/as5047.c **** 	pos_cpr_counts_ = fmodf_pos(pos_cpr_counts_, (float)(ENCODER_cpr));
 392              		.loc 1 202 51 is_stmt 0 view .LVU110
 393 00a8 67EEA97A 		vmul.f32	s15, s15, s19
 202:./Hardware/as5047.c **** 	pos_cpr_counts_ = fmodf_pos(pos_cpr_counts_, (float)(ENCODER_cpr));
 394              		.loc 1 202 18 view .LVU111
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 14


 395 00ac 38EE278A 		vadd.f32	s16, s16, s15
 396 00b0 86ED008A 		vstr.32	s16, [r6]
 203:./Hardware/as5047.c **** 	vel_estimate_counts_ += current_meas_period * pll_ki_ * delta_pos_cpr_counts;
 397              		.loc 1 203 2 is_stmt 1 view .LVU112
 398              	.LVL21:
 399              	.LBB30:
 400              	.LBI30:
  88:./Hardware/as5047.c **** 	float res = wrap_pm(x, y);
 401              		.loc 1 88 21 view .LVU113
 402              	.LBB31:
  89:./Hardware/as5047.c **** 	if (res < 0) res += y;
 403              		.loc 1 89 2 view .LVU114
 404              	.LBB32:
 405              	.LBI32:
  80:./Hardware/as5047.c **** #ifdef FPU_FPV4
 406              		.loc 1 80 21 view .LVU115
 407              	.LBB33:
  84:./Hardware/as5047.c **** #endif
 408              		.loc 1 84 2 view .LVU116
  84:./Hardware/as5047.c **** #endif
 409              		.loc 1 84 17 is_stmt 0 view .LVU117
 410 00b4 28EE2B0A 		vmul.f32	s0, s16, s23
 411 00b8 FFF7FEFF 		bl	nearbyintf
 412              	.LVL22:
  86:./Hardware/as5047.c **** }
 413              		.loc 1 86 2 is_stmt 1 view .LVU118
  86:./Hardware/as5047.c **** }
 414              		.loc 1 86 20 is_stmt 0 view .LVU119
 415 00bc 20EE0B0A 		vmul.f32	s0, s0, s22
 416              	.LVL23:
  86:./Hardware/as5047.c **** }
 417              		.loc 1 86 11 view .LVU120
 418 00c0 38EE408A 		vsub.f32	s16, s16, s0
 419              	.LVL24:
  86:./Hardware/as5047.c **** }
 420              		.loc 1 86 11 view .LVU121
 421              	.LBE33:
 422              	.LBE32:
  90:./Hardware/as5047.c **** 	return res;
 423              		.loc 1 90 2 is_stmt 1 view .LVU122
  90:./Hardware/as5047.c **** 	return res;
 424              		.loc 1 90 5 is_stmt 0 view .LVU123
 425 00c4 B5EEC08A 		vcmpe.f32	s16, #0
 426 00c8 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 427 00cc 21D4     		bmi	.L33
 428              	.L15:
  91:./Hardware/as5047.c **** }
 429              		.loc 1 91 2 is_stmt 1 view .LVU124
 430              	.LVL25:
  91:./Hardware/as5047.c **** }
 431              		.loc 1 91 2 is_stmt 0 view .LVU125
 432              	.LBE31:
 433              	.LBE30:
 203:./Hardware/as5047.c **** 	vel_estimate_counts_ += current_meas_period * pll_ki_ * delta_pos_cpr_counts;
 434              		.loc 1 203 18 view .LVU126
 435 00ce 494B     		ldr	r3, .L35+8
 436 00d0 83ED008A 		vstr.32	s16, [r3]
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 15


 204:./Hardware/as5047.c **** 	uint8_t snap_to_zero_vel = false;
 437              		.loc 1 204 2 is_stmt 1 view .LVU127
 204:./Hardware/as5047.c **** 	uint8_t snap_to_zero_vel = false;
 438              		.loc 1 204 46 is_stmt 0 view .LVU128
 439 00d4 4E4B     		ldr	r3, .L35+36
 440 00d6 D3ED007A 		vldr.32	s15, [r3]
 441 00da 9FED480A 		vldr.32	s0, .L35+16
 442 00de 27EE800A 		vmul.f32	s0, s15, s0
 204:./Hardware/as5047.c **** 	uint8_t snap_to_zero_vel = false;
 443              		.loc 1 204 56 view .LVU129
 444 00e2 60EE299A 		vmul.f32	s19, s0, s19
 445              	.LVL26:
 204:./Hardware/as5047.c **** 	uint8_t snap_to_zero_vel = false;
 446              		.loc 1 204 23 view .LVU130
 447 00e6 7AEEA99A 		vadd.f32	s19, s21, s19
 448 00ea 434B     		ldr	r3, .L35+12
 449 00ec C3ED009A 		vstr.32	s19, [r3]
 205:./Hardware/as5047.c **** 	if (fabsf(vel_estimate_counts_) < 0.5f * current_meas_period * pll_ki_)
 450              		.loc 1 205 2 is_stmt 1 view .LVU131
 451              	.LVL27:
 206:./Hardware/as5047.c **** 	{
 452              		.loc 1 206 2 view .LVU132
 206:./Hardware/as5047.c **** 	{
 453              		.loc 1 206 6 is_stmt 0 view .LVU133
 454 00f0 F0EEE99A 		vabs.f32	s19, s19
 206:./Hardware/as5047.c **** 	{
 455              		.loc 1 206 63 view .LVU134
 456 00f4 9FED477A 		vldr.32	s14, .L35+40
 457 00f8 67EE877A 		vmul.f32	s15, s15, s14
 206:./Hardware/as5047.c **** 	{
 458              		.loc 1 206 5 view .LVU135
 459 00fc F4EEE79A 		vcmpe.f32	s19, s15
 460 0100 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 461 0104 08D5     		bpl	.L30
 208:./Hardware/as5047.c **** 		snap_to_zero_vel = true;
 462              		.loc 1 208 3 is_stmt 1 view .LVU136
 208:./Hardware/as5047.c **** 		snap_to_zero_vel = true;
 463              		.loc 1 208 24 is_stmt 0 view .LVU137
 464 0106 0022     		movs	r2, #0
 465 0108 1A60     		str	r2, [r3]	@ float
 209:./Hardware/as5047.c **** 	}
 466              		.loc 1 209 3 is_stmt 1 view .LVU138
 467              	.LVL28:
 209:./Hardware/as5047.c **** 	}
 468              		.loc 1 209 20 is_stmt 0 view .LVU139
 469 010a 0123     		movs	r3, #1
 470 010c 05E0     		b	.L17
 471              	.LVL29:
 472              	.L32:
 473              	.LBB35:
 474              	.LBB27:
 102:./Hardware/as5047.c **** 	return r;
 475              		.loc 1 102 13 is_stmt 1 view .LVU140
 102:./Hardware/as5047.c **** 	return r;
 476              		.loc 1 102 15 is_stmt 0 view .LVU141
 477 010e 1D44     		add	r5, r5, r3
 478              	.LVL30:
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 16


 102:./Hardware/as5047.c **** 	return r;
 479              		.loc 1 102 15 view .LVU142
 480 0110 82E7     		b	.L13
 481              	.LVL31:
 482              	.L33:
 102:./Hardware/as5047.c **** 	return r;
 483              		.loc 1 102 15 view .LVU143
 484              	.LBE27:
 485              	.LBE35:
 486              	.LBB36:
 487              	.LBB34:
  90:./Hardware/as5047.c **** 	return res;
 488              		.loc 1 90 15 is_stmt 1 view .LVU144
  90:./Hardware/as5047.c **** 	return res;
 489              		.loc 1 90 19 is_stmt 0 view .LVU145
 490 0112 38EE0B8A 		vadd.f32	s16, s16, s22
 491              	.LVL32:
  90:./Hardware/as5047.c **** 	return res;
 492              		.loc 1 90 19 view .LVU146
 493 0116 DAE7     		b	.L15
 494              	.LVL33:
 495              	.L30:
  90:./Hardware/as5047.c **** 	return res;
 496              		.loc 1 90 19 view .LVU147
 497              	.LBE34:
 498              	.LBE36:
 205:./Hardware/as5047.c **** 	if (fabsf(vel_estimate_counts_) < 0.5f * current_meas_period * pll_ki_)
 499              		.loc 1 205 10 view .LVU148
 500 0118 0023     		movs	r3, #0
 501              	.LVL34:
 502              	.L17:
 213:./Hardware/as5047.c **** 	vel_estimate_ = vel_estimate_counts_ / (float)ENCODER_cpr;
 503              		.loc 1 213 2 is_stmt 1 view .LVU149
 213:./Hardware/as5047.c **** 	vel_estimate_ = vel_estimate_counts_ / (float)ENCODER_cpr;
 504              		.loc 1 213 39 is_stmt 0 view .LVU150
 505 011a 9FED3A7A 		vldr.32	s14, .L35+24
 506 011e 68EE877A 		vmul.f32	s15, s17, s14
 213:./Hardware/as5047.c **** 	vel_estimate_ = vel_estimate_counts_ / (float)ENCODER_cpr;
 507              		.loc 1 213 16 view .LVU151
 508 0122 3D4A     		ldr	r2, .L35+44
 509 0124 C2ED007A 		vstr.32	s15, [r2]
 214:./Hardware/as5047.c **** 
 510              		.loc 1 214 2 is_stmt 1 view .LVU152
 214:./Hardware/as5047.c **** 
 511              		.loc 1 214 39 is_stmt 0 view .LVU153
 512 0128 334A     		ldr	r2, .L35+12
 513 012a D2ED007A 		vldr.32	s15, [r2]
 514 012e 67EE878A 		vmul.f32	s17, s15, s14
 214:./Hardware/as5047.c **** 
 515              		.loc 1 214 16 view .LVU154
 516 0132 3A4A     		ldr	r2, .L35+48
 517 0134 C2ED008A 		vstr.32	s17, [r2]
 217:./Hardware/as5047.c **** 	// if we are stopped, make sure we don't randomly drift
 518              		.loc 1 217 2 is_stmt 1 view .LVU155
 217:./Hardware/as5047.c **** 	// if we are stopped, make sure we don't randomly drift
 519              		.loc 1 217 56 is_stmt 0 view .LVU156
 520 0138 2C4A     		ldr	r2, .L35
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 17


 521 013a 5068     		ldr	r0, [r2, #4]
 217:./Hardware/as5047.c **** 	// if we are stopped, make sure we don't randomly drift
 522              		.loc 1 217 10 view .LVU157
 523 013c 221A     		subs	r2, r4, r0
 524 013e 08EE102A 		vmov	s16, r2	@ int
 525              	.LVL35:
 219:./Hardware/as5047.c **** 	{
 526              		.loc 1 219 2 is_stmt 1 view .LVU158
 219:./Hardware/as5047.c **** 	{
 527              		.loc 1 219 4 is_stmt 0 view .LVU159
 528 0142 13BB     		cbnz	r3, .L22
 219:./Hardware/as5047.c **** 	{
 529              		.loc 1 219 40 discriminator 1 view .LVU160
 530 0144 294B     		ldr	r3, .L35
 531              	.LVL36:
 219:./Hardware/as5047.c **** 	{
 532              		.loc 1 219 40 discriminator 1 view .LVU161
 533 0146 1B7D     		ldrb	r3, [r3, #20]	@ zero_extendqisi2
 219:./Hardware/as5047.c **** 	{
 534              		.loc 1 219 22 discriminator 1 view .LVU162
 535 0148 002B     		cmp	r3, #0
 536 014a 49D0     		beq	.L23
 225:./Hardware/as5047.c **** 		interpolation_ = 0.0f;
 537              		.loc 1 225 7 is_stmt 1 view .LVU163
 225:./Hardware/as5047.c **** 		interpolation_ = 0.0f;
 538              		.loc 1 225 9 is_stmt 0 view .LVU164
 539 014c 002D     		cmp	r5, #0
 540 014e 02DD     		ble	.L34
 226:./Hardware/as5047.c **** 	}else if(delta_enc < 0){
 541              		.loc 1 226 18 view .LVU165
 542 0150 DFED337A 		vldr.32	s15, .L35+52
 543 0154 1BE0     		b	.L19
 544              	.L34:
 227:./Hardware/as5047.c **** 		interpolation_ = 1.0f;
 545              		.loc 1 227 8 is_stmt 1 view .LVU166
 227:./Hardware/as5047.c **** 		interpolation_ = 1.0f;
 546              		.loc 1 227 10 is_stmt 0 view .LVU167
 547 0156 46DB     		blt	.L25
 232:./Hardware/as5047.c **** 		// don't allow interpolation indicated position outside of [enc, enc+1)
 548              		.loc 1 232 3 is_stmt 1 view .LVU168
 232:./Hardware/as5047.c **** 		// don't allow interpolation indicated position outside of [enc, enc+1)
 549              		.loc 1 232 41 is_stmt 0 view .LVU169
 550 0158 9FED287A 		vldr.32	s14, .L35+16
 551 015c 67EE877A 		vmul.f32	s15, s15, s14
 232:./Hardware/as5047.c **** 		// don't allow interpolation indicated position outside of [enc, enc+1)
 552              		.loc 1 232 18 view .LVU170
 553 0160 9FED2F7A 		vldr.32	s14, .L35+52
 554 0164 77EE877A 		vadd.f32	s15, s15, s14
 555              	.LVL37:
 234:./Hardware/as5047.c **** 		if (interpolation_ < 0.0f) interpolation_ = 0.0f;
 556              		.loc 1 234 3 is_stmt 1 view .LVU171
 234:./Hardware/as5047.c **** 		if (interpolation_ < 0.0f) interpolation_ = 0.0f;
 557              		.loc 1 234 6 is_stmt 0 view .LVU172
 558 0168 B7EE007A 		vmov.f32	s14, #1.0e+0
 559 016c F4EEC77A 		vcmpe.f32	s15, s14
 560 0170 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 561 0174 01DD     		ble	.L20
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 18


 234:./Hardware/as5047.c **** 		if (interpolation_ < 0.0f) interpolation_ = 0.0f;
 562              		.loc 1 234 45 view .LVU173
 563 0176 F0EE477A 		vmov.f32	s15, s14
 564              	.LVL38:
 565              	.L20:
 235:./Hardware/as5047.c **** 	}
 566              		.loc 1 235 3 is_stmt 1 view .LVU174
 235:./Hardware/as5047.c **** 	}
 567              		.loc 1 235 6 is_stmt 0 view .LVU175
 568 017a F5EEC07A 		vcmpe.f32	s15, #0
 569 017e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 570 0182 04D5     		bpl	.L19
 235:./Hardware/as5047.c **** 	}
 571              		.loc 1 235 45 view .LVU176
 572 0184 DFED267A 		vldr.32	s15, .L35+52
 573              	.LVL39:
 235:./Hardware/as5047.c **** 	}
 574              		.loc 1 235 45 view .LVU177
 575 0188 01E0     		b	.L19
 576              	.LVL40:
 577              	.L22:
 221:./Hardware/as5047.c **** 		// reset interpolation if encoder edge comes
 578              		.loc 1 221 18 view .LVU178
 579 018a F6EE007A 		vmov.f32	s15, #5.0e-1
 580              	.LVL41:
 581              	.L19:
 237:./Hardware/as5047.c **** 	
 582              		.loc 1 237 2 is_stmt 1 view .LVU179
 237:./Hardware/as5047.c **** 	
 583              		.loc 1 237 41 is_stmt 0 view .LVU180
 584 018e B8EEC88A 		vcvt.f32.s32	s16, s16
 237:./Hardware/as5047.c **** 	
 585              		.loc 1 237 8 view .LVU181
 586 0192 38EE278A 		vadd.f32	s16, s16, s15
 587              	.LVL42:
 241:./Hardware/as5047.c **** 	float ph = elec_rad_per_enc * (interpolated_enc - encoder_config.phase_offset_float);
 588              		.loc 1 241 2 is_stmt 1 view .LVU182
 242:./Hardware/as5047.c **** 
 589              		.loc 1 242 2 view .LVU183
 242:./Hardware/as5047.c **** 
 590              		.loc 1 242 66 is_stmt 0 view .LVU184
 591 0196 154C     		ldr	r4, .L35
 592              	.LVL43:
 242:./Hardware/as5047.c **** 
 593              		.loc 1 242 66 view .LVU185
 594 0198 D4ED027A 		vldr.32	s15, [r4, #8]
 595              	.LVL44:
 242:./Hardware/as5047.c **** 
 596              		.loc 1 242 50 view .LVU186
 597 019c 38EE678A 		vsub.f32	s16, s16, s15
 598              	.LVL45:
 242:./Hardware/as5047.c **** 
 599              		.loc 1 242 8 view .LVU187
 600 01a0 DFED207A 		vldr.32	s15, .L35+56
 601 01a4 28EE278A 		vmul.f32	s16, s16, s15
 602              	.LVL46:
 244:./Hardware/as5047.c **** 	encoder_config.phase_vel_ = (2*M_PI) * vel_estimate_ * MOTOR_pole_pairs  * encoder_config.directio
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 19


 603              		.loc 1 244 2 is_stmt 1 view .LVU188
 604              	.LBB37:
 605              	.LBI37:
  94:./Hardware/as5047.c **** 	return wrap_pm(x, 2 * M_PI);
 606              		.loc 1 94 21 view .LVU189
 607              	.LBE37:
  95:./Hardware/as5047.c **** }
 608              		.loc 1 95 2 view .LVU190
 609              	.LBB40:
 610              	.LBB38:
 611              	.LBI38:
  80:./Hardware/as5047.c **** #ifdef FPU_FPV4
 612              		.loc 1 80 21 view .LVU191
 613              	.LBB39:
  84:./Hardware/as5047.c **** #endif
 614              		.loc 1 84 2 view .LVU192
  84:./Hardware/as5047.c **** #endif
 615              		.loc 1 84 17 is_stmt 0 view .LVU193
 616 01a8 9FED1F9A 		vldr.32	s18, .L35+60
 617 01ac 88EE090A 		vdiv.f32	s0, s16, s18
 618 01b0 FFF7FEFF 		bl	nearbyintf
 619              	.LVL47:
  86:./Hardware/as5047.c **** }
 620              		.loc 1 86 2 is_stmt 1 view .LVU194
  86:./Hardware/as5047.c **** }
 621              		.loc 1 86 20 is_stmt 0 view .LVU195
 622 01b4 20EE090A 		vmul.f32	s0, s0, s18
 623              	.LVL48:
  86:./Hardware/as5047.c **** }
 624              		.loc 1 86 11 view .LVU196
 625 01b8 38EE408A 		vsub.f32	s16, s16, s0
 626              	.LVL49:
  86:./Hardware/as5047.c **** }
 627              		.loc 1 86 11 view .LVU197
 628              	.LBE39:
 629              	.LBE38:
 630              	.LBE40:
 244:./Hardware/as5047.c **** 	encoder_config.phase_vel_ = (2*M_PI) * vel_estimate_ * MOTOR_pole_pairs  * encoder_config.directio
 631              		.loc 1 244 41 view .LVU198
 632 01bc D4ED047A 		vldr.32	s15, [r4, #16]	@ int
 633 01c0 F8EEE77A 		vcvt.f32.s32	s15, s15
 634 01c4 27EE888A 		vmul.f32	s16, s15, s16
 244:./Hardware/as5047.c **** 	encoder_config.phase_vel_ = (2*M_PI) * vel_estimate_ * MOTOR_pole_pairs  * encoder_config.directio
 635              		.loc 1 244 24 view .LVU199
 636 01c8 84ED068A 		vstr.32	s16, [r4, #24]
 245:./Hardware/as5047.c **** 
 637              		.loc 1 245 2 is_stmt 1 view .LVU200
 245:./Hardware/as5047.c **** 
 638              		.loc 1 245 55 is_stmt 0 view .LVU201
 639 01cc 68EE898A 		vmul.f32	s17, s17, s18
 245:./Hardware/as5047.c **** 
 640              		.loc 1 245 75 view .LVU202
 641 01d0 67EEA87A 		vmul.f32	s15, s15, s17
 245:./Hardware/as5047.c **** 
 642              		.loc 1 245 28 view .LVU203
 643 01d4 C4ED077A 		vstr.32	s15, [r4, #28]
 247:./Hardware/as5047.c **** }
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 20


 644              		.loc 1 247 2 is_stmt 1 view .LVU204
 248:./Hardware/as5047.c **** /****************************************************************************/
 645              		.loc 1 248 1 is_stmt 0 view .LVU205
 646 01d8 0120     		movs	r0, #1
 647 01da BDEC0A8B 		vldm	sp!, {d8-d12}
 648              	.LCFI2:
 649              		.cfi_remember_state
 650              		.cfi_restore 88
 651              		.cfi_restore 89
 652              		.cfi_restore 86
 653              		.cfi_restore 87
 654              		.cfi_restore 84
 655              		.cfi_restore 85
 656              		.cfi_restore 82
 657              		.cfi_restore 83
 658              		.cfi_restore 80
 659              		.cfi_restore 81
 660              		.cfi_def_cfa_offset 24
 248:./Hardware/as5047.c **** /****************************************************************************/
 661              		.loc 1 248 1 view .LVU206
 662 01de F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 663              	.LVL50:
 664              	.L23:
 665              	.LCFI3:
 666              		.cfi_restore_state
 221:./Hardware/as5047.c **** 		// reset interpolation if encoder edge comes
 667              		.loc 1 221 18 view .LVU207
 668 01e0 F6EE007A 		vmov.f32	s15, #5.0e-1
 669 01e4 D3E7     		b	.L19
 670              	.L25:
 228:./Hardware/as5047.c **** 	}
 671              		.loc 1 228 18 view .LVU208
 672 01e6 F7EE007A 		vmov.f32	s15, #1.0e+0
 673 01ea D0E7     		b	.L19
 674              	.L36:
 675              		.align	2
 676              	.L35:
 677 01ec 00000000 		.word	.LANCHOR2
 678 01f0 00000000 		.word	.LANCHOR5
 679 01f4 00000000 		.word	.LANCHOR6
 680 01f8 00000000 		.word	.LANCHOR7
 681 01fc 17B7D138 		.word	953267991
 682 0200 00000000 		.word	.LANCHOR8
 683 0204 00008038 		.word	947912704
 684 0208 00008046 		.word	1182793728
 685 020c 00000000 		.word	.LANCHOR3
 686 0210 00000000 		.word	.LANCHOR4
 687 0214 17B75138 		.word	944879383
 688 0218 00000000 		.word	.LANCHOR9
 689 021c 00000000 		.word	.LANCHOR10
 690 0220 00000000 		.word	0
 691 0224 DB0FC939 		.word	969478107
 692 0228 DB0FC940 		.word	1086918619
 693              		.cfi_endproc
 694              	.LFE243:
 696              		.section	.text.SPI_ReadWrite_OneByte,"ax",%progbits
 697              		.align	1
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 21


 698              		.global	SPI_ReadWrite_OneByte
 699              		.syntax unified
 700              		.thumb
 701              		.thumb_func
 703              	SPI_ReadWrite_OneByte:
 704              	.LVL51:
 705              	.LFB245:
 259:./Hardware/as5047.c **** uint16_t SPI_ReadWrite_OneByte(uint16_t _txdata)
 260:./Hardware/as5047.c **** {
 706              		.loc 1 260 1 is_stmt 1 view -0
 707              		.cfi_startproc
 708              		@ args = 0, pretend = 0, frame = 16
 709              		@ frame_needed = 0, uses_anonymous_args = 0
 710              		.loc 1 260 1 is_stmt 0 view .LVU210
 711 0000 10B5     		push	{r4, lr}
 712              	.LCFI4:
 713              		.cfi_def_cfa_offset 8
 714              		.cfi_offset 4, -8
 715              		.cfi_offset 14, -4
 716 0002 86B0     		sub	sp, sp, #24
 717              	.LCFI5:
 718              		.cfi_def_cfa_offset 32
 719 0004 ADF80E00 		strh	r0, [sp, #14]	@ movhi
 261:./Hardware/as5047.c **** 
 262:./Hardware/as5047.c ****     uint16_t pos,rawVal;
 720              		.loc 1 262 5 is_stmt 1 view .LVU211
 263:./Hardware/as5047.c **** 	HAL_GPIO_WritePin(SPI3_SOFTCS_GPIO_Port,SPI3_SOFTCS_Pin,GPIO_PIN_RESET);	//csæ‹‰ä½
 721              		.loc 1 263 2 view .LVU212
 722 0008 114C     		ldr	r4, .L41
 723 000a 0022     		movs	r2, #0
 724 000c 0121     		movs	r1, #1
 725 000e 2046     		mov	r0, r4
 726              	.LVL52:
 727              		.loc 1 263 2 is_stmt 0 view .LVU213
 728 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
 729              	.LVL53:
 264:./Hardware/as5047.c **** 
 265:./Hardware/as5047.c ****     HAL_SPI_TransmitReceive(&hspi3,(uint8_t *)&_txdata,(uint8_t *)&rawVal,1,1000);
 730              		.loc 1 265 5 is_stmt 1 view .LVU214
 731 0014 4FF47A73 		mov	r3, #1000
 732 0018 0093     		str	r3, [sp]
 733 001a 0123     		movs	r3, #1
 734 001c 0DF11602 		add	r2, sp, #22
 735 0020 0DF10E01 		add	r1, sp, #14
 736 0024 0B48     		ldr	r0, .L41+4
 737 0026 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 738              	.LVL54:
 266:./Hardware/as5047.c **** 	HAL_GPIO_WritePin(SPI3_SOFTCS_GPIO_Port,SPI3_SOFTCS_Pin,GPIO_PIN_SET);
 739              		.loc 1 266 2 view .LVU215
 740 002a 0122     		movs	r2, #1
 741 002c 1146     		mov	r1, r2
 742 002e 2046     		mov	r0, r4
 743 0030 FFF7FEFF 		bl	HAL_GPIO_WritePin
 744              	.LVL55:
 267:./Hardware/as5047.c **** 
 268:./Hardware/as5047.c **** 	if(ams_parity(rawVal)) //|| ((rawVal >> 14) & 1)
 745              		.loc 1 268 2 view .LVU216
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 22


 746              		.loc 1 268 5 is_stmt 0 view .LVU217
 747 0034 BDF81640 		ldrh	r4, [sp, #22]
 748 0038 2046     		mov	r0, r4
 749 003a FFF7FEFF 		bl	ams_parity
 750              	.LVL56:
 751              		.loc 1 268 4 view .LVU218
 752 003e 18B9     		cbnz	r0, .L39
 269:./Hardware/as5047.c ****     {
 270:./Hardware/as5047.c ****         return 0xFFFF;
 271:./Hardware/as5047.c ****     }else{
 272:./Hardware/as5047.c ****         return pos = (rawVal & 0x3fff);
 753              		.loc 1 272 9 is_stmt 1 view .LVU219
 754              		.loc 1 272 20 is_stmt 0 view .LVU220
 755 0040 C4F30D00 		ubfx	r0, r4, #0, #14
 756              	.LVL57:
 757              	.L38:
 273:./Hardware/as5047.c ****     }
 274:./Hardware/as5047.c **** 
 275:./Hardware/as5047.c **** }
 758              		.loc 1 275 1 view .LVU221
 759 0044 06B0     		add	sp, sp, #24
 760              	.LCFI6:
 761              		.cfi_remember_state
 762              		.cfi_def_cfa_offset 8
 763              		@ sp needed
 764 0046 10BD     		pop	{r4, pc}
 765              	.L39:
 766              	.LCFI7:
 767              		.cfi_restore_state
 270:./Hardware/as5047.c ****     }else{
 768              		.loc 1 270 16 view .LVU222
 769 0048 4FF6FF70 		movw	r0, #65535
 770 004c FAE7     		b	.L38
 771              	.L42:
 772 004e 00BF     		.align	2
 773              	.L41:
 774 0050 00000240 		.word	1073872896
 775 0054 00000000 		.word	hspi3
 776              		.cfi_endproc
 777              	.LFE245:
 779              		.section	.text.as5047_read,"ax",%progbits
 780              		.align	1
 781              		.global	as5047_read
 782              		.syntax unified
 783              		.thumb
 784              		.thumb_func
 786              	as5047_read:
 787              	.LFB246:
 276:./Hardware/as5047.c **** void* as5047_read(void)
 277:./Hardware/as5047.c **** {
 788              		.loc 1 277 1 is_stmt 1 view -0
 789              		.cfi_startproc
 790              		@ args = 0, pretend = 0, frame = 0
 791              		@ frame_needed = 0, uses_anonymous_args = 0
 792 0000 10B5     		push	{r4, lr}
 793              	.LCFI8:
 794              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 23


 795              		.cfi_offset 4, -8
 796              		.cfi_offset 14, -4
 278:./Hardware/as5047.c ****     uint16_t add = 0;
 797              		.loc 1 278 5 view .LVU224
 798              	.LVL58:
 279:./Hardware/as5047.c **** 	uint16_t data;
 799              		.loc 1 279 2 view .LVU225
 280:./Hardware/as5047.c ****     data=SPI_ReadWrite_OneByte(0xFFFF); //å‘é€ä¸€æ¡ç©ºæŒ‡ä»¤ï¼Œè¯»å–ä¸Šä¸€æ¬¡æŒ‡ä»¤è¿”å›çš„æ•°
 800              		.loc 1 280 5 view .LVU226
 801              		.loc 1 280 10 is_stmt 0 view .LVU227
 802 0002 4FF6FF70 		movw	r0, #65535
 803 0006 FFF7FEFF 		bl	SPI_ReadWrite_OneByte
 804              	.LVL59:
 805 000a 0446     		mov	r4, r0
 806              	.LVL60:
 281:./Hardware/as5047.c ****     encoder_update(data);
 807              		.loc 1 281 5 is_stmt 1 view .LVU228
 808 000c FFF7FEFF 		bl	encoder_update
 809              	.LVL61:
 282:./Hardware/as5047.c **** 
 283:./Hardware/as5047.c ****     rawdata = data;
 810              		.loc 1 283 5 view .LVU229
 811              		.loc 1 283 13 is_stmt 0 view .LVU230
 812 0010 094B     		ldr	r3, .L45
 813 0012 1C60     		str	r4, [r3]
 284:./Hardware/as5047.c ****     // covdata = data * 402;
 285:./Hardware/as5047.c ****     covdata = encoder_config.phase_ * (1<<20);
 814              		.loc 1 285 5 is_stmt 1 view .LVU231
 815              		.loc 1 285 29 is_stmt 0 view .LVU232
 816 0014 094B     		ldr	r3, .L45+4
 817 0016 D3ED067A 		vldr.32	s15, [r3, #24]
 818              		.loc 1 285 13 view .LVU233
 819 001a FEEEC67A 		vcvt.s32.f32	s15, s15, #20
 820 001e 084A     		ldr	r2, .L45+8
 821 0020 C2ED007A 		vstr.32	s15, [r2]	@ int
 286:./Hardware/as5047.c ****     filterdata = encoder_config.phase_vel_ * (1<<15);
 822              		.loc 1 286 5 is_stmt 1 view .LVU234
 823              		.loc 1 286 32 is_stmt 0 view .LVU235
 824 0024 D3ED077A 		vldr.32	s15, [r3, #28]
 825              		.loc 1 286 16 view .LVU236
 826 0028 FEEEE87A 		vcvt.s32.f32	s15, s15, #15
 827 002c 054B     		ldr	r3, .L45+12
 828 002e C3ED007A 		vstr.32	s15, [r3]	@ int
 287:./Hardware/as5047.c **** 	return (void *)&sg_as5047data;
 829              		.loc 1 287 2 is_stmt 1 view .LVU237
 288:./Hardware/as5047.c **** }
 830              		.loc 1 288 1 is_stmt 0 view .LVU238
 831 0032 0548     		ldr	r0, .L45+16
 832 0034 10BD     		pop	{r4, pc}
 833              	.LVL62:
 834              	.L46:
 835              		.loc 1 288 1 view .LVU239
 836 0036 00BF     		.align	2
 837              	.L45:
 838 0038 00000000 		.word	.LANCHOR11
 839 003c 00000000 		.word	.LANCHOR2
 840 0040 00000000 		.word	.LANCHOR12
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 24


 841 0044 00000000 		.word	.LANCHOR13
 842 0048 00000000 		.word	.LANCHOR14
 843              		.cfi_endproc
 844              	.LFE246:
 846              		.section	.text.as5047_init,"ax",%progbits
 847              		.align	1
 848              		.global	as5047_init
 849              		.syntax unified
 850              		.thumb
 851              		.thumb_func
 853              	as5047_init:
 854              	.LFB247:
 289:./Hardware/as5047.c **** 
 290:./Hardware/as5047.c **** void as5047_init(void)
 291:./Hardware/as5047.c **** {
 855              		.loc 1 291 1 is_stmt 1 view -0
 856              		.cfi_startproc
 857              		@ args = 0, pretend = 0, frame = 0
 858              		@ frame_needed = 0, uses_anonymous_args = 0
 859 0000 08B5     		push	{r3, lr}
 860              	.LCFI9:
 861              		.cfi_def_cfa_offset 8
 862              		.cfi_offset 3, -8
 863              		.cfi_offset 14, -4
 292:./Hardware/as5047.c ****     sg_as5047data.raw_buf = &rawdata;
 864              		.loc 1 292 5 view .LVU241
 865              		.loc 1 292 27 is_stmt 0 view .LVU242
 866 0002 054B     		ldr	r3, .L49
 867 0004 054A     		ldr	r2, .L49+4
 868 0006 1A60     		str	r2, [r3]
 293:./Hardware/as5047.c ****     sg_as5047data.covdata_buf = &covdata;
 869              		.loc 1 293 5 is_stmt 1 view .LVU243
 870              		.loc 1 293 31 is_stmt 0 view .LVU244
 871 0008 054A     		ldr	r2, .L49+8
 872 000a 5A60     		str	r2, [r3, #4]
 294:./Hardware/as5047.c ****     sg_as5047data.filterdata_buf = &filterdata;
 873              		.loc 1 294 5 is_stmt 1 view .LVU245
 874              		.loc 1 294 34 is_stmt 0 view .LVU246
 875 000c 054A     		ldr	r2, .L49+12
 876 000e 9A60     		str	r2, [r3, #8]
 295:./Hardware/as5047.c ****     MagneticSensor_Init();
 877              		.loc 1 295 5 is_stmt 1 view .LVU247
 878 0010 FFF7FEFF 		bl	MagneticSensor_Init
 879              	.LVL63:
 296:./Hardware/as5047.c **** }
 880              		.loc 1 296 1 is_stmt 0 view .LVU248
 881 0014 08BD     		pop	{r3, pc}
 882              	.L50:
 883 0016 00BF     		.align	2
 884              	.L49:
 885 0018 00000000 		.word	.LANCHOR14
 886 001c 00000000 		.word	.LANCHOR11
 887 0020 00000000 		.word	.LANCHOR12
 888 0024 00000000 		.word	.LANCHOR13
 889              		.cfi_endproc
 890              	.LFE247:
 892              		.global	vel_estimate_
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 25


 893              		.global	pos_estimate_
 894              		.global	vel_estimate_valid_
 895              		.global	pos_estimate_valid_
 896              		.global	encoder_config
 897              		.global	current_meas_period
 898              		.global	filterdata
 899              		.global	covdata
 900              		.global	rawdata
 901              		.section	.bss.covdata,"aw",%nobits
 902              		.align	2
 903              		.set	.LANCHOR12,. + 0
 906              	covdata:
 907 0000 00000000 		.space	4
 908              		.section	.bss.encoder_config,"aw",%nobits
 909              		.align	2
 910              		.set	.LANCHOR2,. + 0
 913              	encoder_config:
 914 0000 00000000 		.space	32
 914      00000000 
 914      00000000 
 914      00000000 
 914      00000000 
 915              		.section	.bss.filterdata,"aw",%nobits
 916              		.align	2
 917              		.set	.LANCHOR13,. + 0
 920              	filterdata:
 921 0000 00000000 		.space	4
 922              		.section	.bss.pll_ki_,"aw",%nobits
 923              		.align	2
 924              		.set	.LANCHOR4,. + 0
 927              	pll_ki_:
 928 0000 00000000 		.space	4
 929              		.section	.bss.pll_kp_,"aw",%nobits
 930              		.align	2
 931              		.set	.LANCHOR3,. + 0
 934              	pll_kp_:
 935 0000 00000000 		.space	4
 936              		.section	.bss.pos_cpr_counts_.2,"aw",%nobits
 937              		.align	2
 938              		.set	.LANCHOR6,. + 0
 941              	pos_cpr_counts_.2:
 942 0000 00000000 		.space	4
 943              		.section	.bss.pos_estimate_,"aw",%nobits
 944              		.align	2
 945              		.set	.LANCHOR9,. + 0
 948              	pos_estimate_:
 949 0000 00000000 		.space	4
 950              		.section	.bss.pos_estimate_counts_.0,"aw",%nobits
 951              		.align	2
 952              		.set	.LANCHOR8,. + 0
 955              	pos_estimate_counts_.0:
 956 0000 00000000 		.space	4
 957              		.section	.bss.pos_estimate_valid_,"aw",%nobits
 958              		.set	.LANCHOR1,. + 0
 961              	pos_estimate_valid_:
 962 0000 00       		.space	1
 963              		.section	.bss.rawdata,"aw",%nobits
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 26


 964              		.align	2
 965              		.set	.LANCHOR11,. + 0
 968              	rawdata:
 969 0000 00000000 		.space	4
 970              		.section	.bss.sg_as5047data,"aw",%nobits
 971              		.align	2
 972              		.set	.LANCHOR14,. + 0
 975              	sg_as5047data:
 976 0000 00000000 		.space	16
 976      00000000 
 976      00000000 
 976      00000000 
 977              		.section	.bss.shadow_count_.3,"aw",%nobits
 978              		.align	2
 979              		.set	.LANCHOR5,. + 0
 982              	shadow_count_.3:
 983 0000 00000000 		.space	4
 984              		.section	.bss.vel_estimate_,"aw",%nobits
 985              		.align	2
 986              		.set	.LANCHOR10,. + 0
 989              	vel_estimate_:
 990 0000 00000000 		.space	4
 991              		.section	.bss.vel_estimate_counts_.1,"aw",%nobits
 992              		.align	2
 993              		.set	.LANCHOR7,. + 0
 996              	vel_estimate_counts_.1:
 997 0000 00000000 		.space	4
 998              		.section	.bss.vel_estimate_valid_,"aw",%nobits
 999              		.set	.LANCHOR0,. + 0
 1002              	vel_estimate_valid_:
 1003 0000 00       		.space	1
 1004              		.section	.rodata.current_meas_period,"a"
 1005              		.align	2
 1008              	current_meas_period:
 1009 0000 17B7D138 		.word	953267991
 1010              		.text
 1011              	.Letext0:
 1012              		.file 2 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\machine\\_defa
 1013              		.file 3 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\sys\\_stdint.h
 1014              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 1015              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1016              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1017              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1018              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 1019              		.file 9 "Inc/spi.h"
 1020              		.file 10 "d:\\program files\\gcc-arm-none-eabi-10.3-2021.10\\arm-none-eabi\\include\\math.h"
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 27


DEFINED SYMBOLS
                            *ABS*:00000000 as5047.c
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:20     .text.ams_parity:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:25     .text.ams_parity:00000000 ams_parity
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:60     .text.encoder_set_error:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:66     .text.encoder_set_error:00000000 encoder_set_error
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:88     .text.encoder_set_error:0000000c $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:94     .text.update_pll_gains:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:100    .text.update_pll_gains:00000000 update_pll_gains
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:130    .text.update_pll_gains:00000024 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:137    .text.run_offset_calibration:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:143    .text.run_offset_calibration:00000000 run_offset_calibration
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:161    .text.MagneticSensor_Init:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:167    .text.MagneticSensor_Init:00000000 MagneticSensor_Init
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:217    .text.MagneticSensor_Init:0000002c $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:228    .text.encoder_update:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:234    .text.encoder_update:00000000 encoder_update
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:677    .text.encoder_update:000001ec $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:697    .text.SPI_ReadWrite_OneByte:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:703    .text.SPI_ReadWrite_OneByte:00000000 SPI_ReadWrite_OneByte
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:774    .text.SPI_ReadWrite_OneByte:00000050 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:780    .text.as5047_read:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:786    .text.as5047_read:00000000 as5047_read
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:838    .text.as5047_read:00000038 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:847    .text.as5047_init:00000000 $t
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:853    .text.as5047_init:00000000 as5047_init
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:885    .text.as5047_init:00000018 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:989    .bss.vel_estimate_:00000000 vel_estimate_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:948    .bss.pos_estimate_:00000000 pos_estimate_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:1002   .bss.vel_estimate_valid_:00000000 vel_estimate_valid_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:961    .bss.pos_estimate_valid_:00000000 pos_estimate_valid_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:913    .bss.encoder_config:00000000 encoder_config
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:1008   .rodata.current_meas_period:00000000 current_meas_period
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:920    .bss.filterdata:00000000 filterdata
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:906    .bss.covdata:00000000 covdata
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:968    .bss.rawdata:00000000 rawdata
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:902    .bss.covdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:909    .bss.encoder_config:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:916    .bss.filterdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:923    .bss.pll_ki_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:927    .bss.pll_ki_:00000000 pll_ki_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:930    .bss.pll_kp_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:934    .bss.pll_kp_:00000000 pll_kp_
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:937    .bss.pos_cpr_counts_.2:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:941    .bss.pos_cpr_counts_.2:00000000 pos_cpr_counts_.2
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:944    .bss.pos_estimate_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:951    .bss.pos_estimate_counts_.0:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:955    .bss.pos_estimate_counts_.0:00000000 pos_estimate_counts_.0
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:962    .bss.pos_estimate_valid_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:964    .bss.rawdata:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:971    .bss.sg_as5047data:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:975    .bss.sg_as5047data:00000000 sg_as5047data
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:978    .bss.shadow_count_.3:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:982    .bss.shadow_count_.3:00000000 shadow_count_.3
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:985    .bss.vel_estimate_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:992    .bss.vel_estimate_counts_.1:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:996    .bss.vel_estimate_counts_.1:00000000 vel_estimate_counts_.1
ARM GAS  C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s 			page 28


C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:1003   .bss.vel_estimate_valid_:00000000 $d
C:\Users\57308\AppData\Local\Temp\ccpKJvbA.s:1005   .rodata.current_meas_period:00000000 $d

UNDEFINED SYMBOLS
nearbyintf
HAL_GPIO_WritePin
HAL_SPI_TransmitReceive
hspi3
